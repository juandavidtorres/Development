Imports Microsoft.Practices.EnterpriseLibrary.Data
Imports System.Data.Common
Imports System.Runtime.Serialization
Imports POSstation.Fabrica
Public Class SqlServer
    Inherits Disposable


#Region "sicom"
    Public Function RecuperarOperacionesSICOM() As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarOperacionesSICOM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Try
            Using connection As DbConnection = DB.CreateConnection()
                connection.Open()
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            End Using
        Catch : Throw
        End Try
    End Function
    Public Function RecuperarMetodosHTTP() As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarMetodosHTTP"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Try
            Using connection As DbConnection = DB.CreateConnection()
                connection.Open()
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            End Using
        Catch : Throw
        End Try
    End Function

    Public Function RecuperarOperacionSICOMPorNombre(Operacion As String) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarOperacionSICOMPorNombre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "@Operacion", DbType.String, Operacion)

        Try
            Using connection As DbConnection = DB.CreateConnection()
                connection.Open()
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            End Using
        Catch : Throw
        End Try
    End Function



    Public Function RecuperarMetodoHttpPorOperacion(Operacion As String) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarMetodoHttpPorOperacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "@Operacion", DbType.String, Operacion)

        Try
            Using connection As DbConnection = DB.CreateConnection()
                connection.Open()
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            End Using
        Catch : Throw
        End Try
    End Function
#End Region

    Public Enum TipoFidelizacion
        Tarjeta = 1
        Cedula = 2
    End Enum

    Private _recuperarTipoEmpleado As DataTable


    Public Function GenerarArchivoVentasRP(fechaInicio As String, fechaFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "GenerarArchivoVentasRP"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicio", DbType.String, fechaInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFin", DbType.String, fechaFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
    Public Function InsertarRecaudoInfoEmpresa(Movil As String, Periodos As String, Concepto As String, IdTurno As String, ReciboGas As String, Placa As String, Valor As Decimal, RespuestaInfoTaxi As String, MensajeInfoTaxi As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRecaudoInfoEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Movil", DbType.String, Movil)
        DB.AddInParameter(DatabaseCommand, "Periodos", DbType.String, Periodos)
        DB.AddInParameter(DatabaseCommand, "concepto", DbType.String, Concepto)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.String, IdTurno)
        DB.AddInParameter(DatabaseCommand, "ReciboGas", DbType.String, ReciboGas)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Int32, Valor)
        DB.AddOutParameter(DatabaseCommand, "IdRecaudo", DbType.Int64, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ActualizarPagoInfoTaxi(IdRecaudo As String, IdPago As String, RespuestaInfoTaxi As String, MensajeInfoTaxi As String, Anulado As Boolean, Procesado As Boolean, FechaInfoTaxi As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPagoInfoTaxi"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.String, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "IdPago", DbType.String, IdPago)
        DB.AddInParameter(DatabaseCommand, "RespuestaInfoTaxi", DbType.String, RespuestaInfoTaxi)
        DB.AddInParameter(DatabaseCommand, "MensajeInfoTaxi", DbType.String, MensajeInfoTaxi)
        DB.AddInParameter(DatabaseCommand, "Anulado", DbType.String, Anulado)
        DB.AddInParameter(DatabaseCommand, "Procesado", DbType.String, Procesado)
        DB.AddInParameter(DatabaseCommand, "FechaInfoTaxi ", DbType.String, FechaInfoTaxi)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub CerrarTurnoRecaudo(IdTurno As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurnoRecaudo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub AbrirTurnoRecaudo(Usuario As String, Clave As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurnoRecaudos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Usuario)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub AsociarTarjetaAVehiculo(numTarjeta As String, placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AsociarTarjetaAVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumTarjeta", DbType.String, numTarjeta)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarRecaudosInfoTaxiPorTurno(IdTurno As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosInfoTaxiPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
    Public Function RecuperarVehiculosLocales() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculosLocales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarTarjetas() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTarjetas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
    Public Sub PasarVentaEfectivoACredito(Recibo As Long, placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "PasarVentaEfectivoACredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



#Region "IslaPuertoFiscal"

    Public Function RecuperarIslasPuertoFiscal() As DataSet
        Dim Db As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "RecuperarIslasPuertoFiscal"
        Dim DataBaseCommand As DbCommand = Db.GetStoredProcCommand(sqlCommand)

        Using connection As DbConnection = Db.CreateConnection
            connection.Open()
            Try
                Return Db.ExecuteDataSet(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function


    Public Sub EliminarIslaPuertoFiscal(ByVal IdIslaPuerto As Int16)
        Dim Db As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "EliminarIslaPuertoFiscal"
        Dim DataBaseCommand As DbCommand = Db.GetStoredProcCommand(sqlCommand)

        Db.AddInParameter(DataBaseCommand, "IdIslaPuertoFiscal", DbType.Int16, IdIslaPuerto)


        Using connection As DbConnection = Db.CreateConnection
            connection.Open()
            Try
                Db.ExecuteNonQuery(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Sub ActualizarIslaPuertoFiscal(ByVal IdIslaPuerto As Int16, ByVal IdIsla As Int16, ByVal Puerto As String)
        Dim Db As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "ActualizarIslaPuertoFiscal"
        Dim DataBaseCommand As DbCommand = Db.GetStoredProcCommand(sqlCommand)

        Db.AddInParameter(DataBaseCommand, "IdIslaPuertoFiscal", DbType.Int16, IdIslaPuerto)
        Db.AddInParameter(DataBaseCommand, "IdIsla", DbType.Int16, IdIsla)
        Db.AddInParameter(DataBaseCommand, "Puerto", DbType.String, Puerto)


        Using connection As DbConnection = Db.CreateConnection
            connection.Open()
            Try
                Db.ExecuteNonQuery(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub



    Public Sub InsertarIslaPuertoFiscal(ByVal IdIsla As Int16, ByVal Puerto As String)
        Dim Db As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "InsertarIslaPuertoFiscal"
        Dim DataBaseCommand As DbCommand = Db.GetStoredProcCommand(sqlCommand)

        Db.AddInParameter(DataBaseCommand, "IdIsla", DbType.Int16, IdIsla)
        Db.AddInParameter(DataBaseCommand, "Puerto", DbType.String, Puerto)


        Using connection As DbConnection = Db.CreateConnection
            connection.Open()
            Try
                Db.ExecuteNonQuery(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

#End Region

#Region "Logueo Errores SAUCE Personalizado"
    Public Sub InsertarAutorizacionFallidaLogueo(Cara As String, Manguera As String, Placa As String, Producto As String, Autorizacion As String, Rom As String,
                MensajeError As String, AutorizacionManual As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("LogDataBase")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAutorizacionFallida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, IIf(Cara Is Nothing, "", Cara))
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, IIf(Placa Is Nothing, "", Placa))
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.String, IIf(Manguera Is Nothing, "", Manguera))
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.String, IIf(Producto Is Nothing, "", Producto))
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, IIf(Autorizacion Is Nothing, "", Autorizacion))
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, IIf(Rom Is Nothing, "", Rom))
        DB.AddInParameter(DatabaseCommand, "MensajeError", DbType.String, MensajeError)
        DB.AddInParameter(DatabaseCommand, "AutorizacionManual", DbType.String, IIf(AutorizacionManual Is Nothing, "", AutorizacionManual))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarCierreTanquesFallidoLogueo(IdTurno As String, InfoTanques As String, MensajeError As String, Usuario As String, InformacionAdicional As String, Rom As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("LogDataBase")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCierreTanquesFallido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.String, IdTurno)
        DB.AddInParameter(DatabaseCommand, "InfoTanques", DbType.String, InfoTanques)
        DB.AddInParameter(DatabaseCommand, "MensajeError", DbType.String, MensajeError)
        DB.AddInParameter(DatabaseCommand, "Usuario", DbType.String, Usuario)
        DB.AddInParameter(DatabaseCommand, "InformacionAdicional", DbType.String, InformacionAdicional)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTurnoFallidoLogueo(Empleado As String, Clave As String, Surtidores As String, MensajeError As String, Puerto As String, Descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("LogDataBase")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTurnoFallido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, Surtidores)
        DB.AddInParameter(DatabaseCommand, "MensajeError", DbType.String, MensajeError)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, Puerto)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarEventosServicioAutorizador(Evento As String, MensajeError As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("LogDataBase")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEventosServicioAutorizador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Evento", DbType.String, Evento)
        DB.AddInParameter(DatabaseCommand, "MensajeError", DbType.String, MensajeError)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarCambioFormaPagoFallida(FormasPago As String, Recibo As String, Cara As String, MensajeError As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("LogDataBase")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCambioFormaPagoFallida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FormasPago", DbType.String, IIf(FormasPago Is Nothing, "", FormasPago))
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.String, Recibo)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, Cara)
        DB.AddInParameter(DatabaseCommand, "MensajeError", DbType.String, MensajeError)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarLogeo(Tabla As String, FechaInicial As DateTime, FechaFinal As DateTime, Filtros As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("LogDataBase")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLogeo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, Tabla)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Filtros", DbType.String, Filtros)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarColumnas(Tabla As String, Optional Existentes As String = "") As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("LogDataBase")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarColumnas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, Tabla)
        'DB.AddInParameter(DatabaseCommand, "Existentes", DbType.String, Existentes)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Bonos fidelizacion"

    Public Sub LiberarBonoEnreserva(ByVal IdRedencion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "LiberarBonoEnreserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRedencion", DbType.Int32, IdRedencion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ReservarBono(ByVal Recibo As Int64, ByVal IdBono As Integer) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ReservarBono"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.String, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdBono", DbType.String, IdBono)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarFormaPagoVentaBonoFidelizacionSoyLeal(ByVal recibo As Int64, ByVal valor As Decimal, ByVal nroTarjeta As String, ByVal nroAutorizacion As String, ByVal IdRedencion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPagoVentaBonoFidelizacionSoyLeal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "ValorBono", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, nroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "IdRedencion", DbType.Int32, IdRedencion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarBonosLocales() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarBonosLocales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCodEstacion() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub InactivarBono()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InactivarBono"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarBono(ByVal IdBono As Int64, ByVal Nombre As String, ByVal Tipo As String, ByVal Puntos As Decimal, ByVal Valor As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarBono"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdBono", DbType.Int16, IdBono)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.String, Tipo)
        DB.AddInParameter(DatabaseCommand, "Puntos", DbType.Decimal, Puntos)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ValidarPagoConBonoFidelizacionSoyLeal(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPagoConBonoFidelizacionSoyLeal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarBonosLocalesReader() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim sqlCommand As String = "RecuperarBonosLocales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(sqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                Return DB.ExecuteReader(DatabaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

    Public Function RecuperarTipoComunicacionProtocolos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoComunicacionProtocolos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarRedSurtidor(ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal Eco As Boolean, ByVal ip As String, ByVal puertoTcp As String, ByVal IdTipoComunicacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "Eco", DbType.Boolean, Eco)
        DB.AddInParameter(DatabaseCommand, "IdTipoComunicacion", DbType.Int32, IdTipoComunicacion)

        If (idPuerto > 0) Then
            DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        End If
        If (Not String.IsNullOrEmpty(ip)) Then
            DB.AddInParameter(DatabaseCommand, "Ip", DbType.String, ip)
        End If
        If (Not String.IsNullOrEmpty(puertoTcp)) Then
            DB.AddInParameter(DatabaseCommand, "PuertoTcp", DbType.String, puertoTcp)
        End If

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarRedSurtidor(ByVal idRed As Int32, ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal Eco As Boolean, ByVal ip As String, ByVal puertoTcp As String, ByVal IdTipoComunicacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, idRed)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "Eco", DbType.Boolean, Eco)
        DB.AddInParameter(DatabaseCommand, "IdTipoComunicacion", DbType.Int32, IdTipoComunicacion)

        If (idPuerto > 0) Then
            DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        End If

        If (Not String.IsNullOrEmpty(ip)) Then
            DB.AddInParameter(DatabaseCommand, "Ip", DbType.String, ip)
        End If

        If (Not String.IsNullOrEmpty(puertoTcp)) Then
            DB.AddInParameter(DatabaseCommand, "PuertoTcp", DbType.String, puertoTcp)
        End If

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRedSurtidorPorIdRed(ByVal idRed As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRedSurtidorPorIdRed"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, idRed)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidarLectorCara(ByVal idCara As Short)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarLectorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarConductoresPorCliente(ByVal Cliente As String) As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductoresPorCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cliente", DbType.String, Cliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function




    Public Sub InsertarSaldoCreditoConsumo(ByVal IdCreditoConsumo As Long, ByVal Origen As String, ByVal Documento As String, ByVal Resultado As Decimal, ByVal Fecha As DateTime)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSaldoCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCreditoConsumo", DbType.String, IdCreditoConsumo)
        DB.AddInParameter(DatabaseCommand, "Origen", DbType.String, Origen)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "Saldo", DbType.Decimal, Resultado)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub



    Public Function RecuperarSaldoCreditoConsumo(ByVal IdCreditoConsumo As String) As Decimal
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaldoCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCreditoConsumo", DbType.String, IdCreditoConsumo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function ExisteIdentificadorLocal(ByVal Rom As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteIdentificadorLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Sub ValidarCapacidadTanque(ByVal CantidadRecibo As Decimal, ByVal IdTanque As Int16)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCapacidadTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CantidadRecibo", DbType.Decimal, CantidadRecibo)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Function ExisteEstacion(ByVal IdEstacion As Int16) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarListaCaras() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSurtidoresPorEmpleadoEnTurno(ByVal idEmpleado As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresPorEmpleadoEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "idEmpleado", DbType.String, idEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarSurtidoresEnTurnoAbierto() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresEnTurnoAbierto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoFidelizacionManual(ByVal cedula As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoFidelizacionManual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oReader As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If oReader.Read Then
                    Return oReader.Item(0).ToString
                Else
                    Return ""
                End If
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ValidarSiClienteTieneCreditoConsumo(ByVal IdCliente As Long) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiClienteTieneCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int64, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdCreditoConsumo(ByVal IdCliente As Long) As Integer
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int16, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarPromocionesHoraFeliz() As DataSet
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPromocionesHoraFeliz"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Sub GuardarPromocionHoraFeliz(ByVal IdPromocion As Int32, ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime, ByVal HoraInicial As DateTime, ByVal HoraFinal As DateTime, ByVal Valor As Decimal, ByVal EsPorcentaje As Boolean, ByVal Estado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPromocionHoraFeliz"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPromocion", DbType.Int32, IdPromocion)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "HoraInicial", DbType.DateTime, HoraInicial)
        DB.AddInParameter(DatabaseCommand, "HoraFinal", DbType.DateTime, HoraFinal)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "EsPorcentaje", DbType.Boolean, EsPorcentaje)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, Estado)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarPromocionHoraFeliz(ByVal IdPromocion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarPromocionHoraFeliz"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPromocion", DbType.Int32, IdPromocion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function BuscarPromocionesHoraFeliz(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime) As DataSet
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "BuscarPromocionesHoraFeliz"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function


    Function RecuperarCarasConTurnosAbiertosPorIsla(ByVal IdIsla As Int32) As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarasConTurnosAbiertosPorIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, IdIsla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarCarasEnTurnoAbierto() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarasEnTurnoAbierto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarTipoIdentificacion() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoIdentificacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarDatosImpresoraPorNombre(ByVal Nombre As String) As IDataReader
        Dim DBa As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "RecuperarDatosImpresoraPorNombre"
        Dim DataBaseCommand As DbCommand = DBa.GetStoredProcCommand(sqlCommand)

        DBa.AddInParameter(DataBaseCommand, "Nombre", DbType.String, Nombre)
        Using connection As DbConnection = DBa.CreateConnection
            connection.Open()
            Try
                Return DBa.ExecuteReader(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using

    End Function


    Public Function RecuperarDatosBoletaFiscal(ByVal Recibo As Int16) As IDataReader
        Dim DBa As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "RecuperarDatosBoletaFiscal"
        Dim DataBaseCommand As DbCommand = DBa.GetStoredProcCommand(sqlCommand)

        DBa.AddInParameter(DataBaseCommand, "Recibo", DbType.String, Recibo)
        Using connection As DbConnection = DBa.CreateConnection
            connection.Open()
            Try
                Return DBa.ExecuteReader(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using

    End Function

    Public Function RecuperarImpresorasPorTurno(ByVal turno As String) As DataSet
        Dim DBa As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "RecuperarImpresorasPorTurno"
        Dim DataBaseCommand As DbCommand = DBa.GetStoredProcCommand(sqlCommand)

        DBa.AddInParameter(DataBaseCommand, "Turno", DbType.String, turno)
        Using connection As DbConnection = DBa.CreateConnection
            connection.Open()
            Try
                Return DBa.ExecuteDataSet(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using

    End Function

    Public Function RecuperarImpresorasPorPuertoCapturador(ByVal Puerto As String) As DataSet
        Dim DBa As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "RecuperarImpresorasPorPuertoCapturador"
        Dim DataBaseCommand As DbCommand = DBa.GetStoredProcCommand(sqlCommand)

        DBa.AddInParameter(DataBaseCommand, "Puerto", DbType.String, Puerto)
        Using connection As DbConnection = DBa.CreateConnection
            connection.Open()
            Try
                Return DBa.ExecuteDataSet(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using

    End Function

    Public Function RecuperarImpresorasPorCara(ByVal Cara As Byte) As DataSet
        Dim DBa As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "RecuperarImpresorasPorCara"
        Dim DataBaseCommand As DbCommand = DBa.GetStoredProcCommand(sqlCommand)

        DBa.AddInParameter(DataBaseCommand, "IdCara", DbType.Double, Cara)
        Using connection As DbConnection = DBa.CreateConnection
            connection.Open()
            Try
                Return DBa.ExecuteDataSet(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using

    End Function

    Public Function RecuperarImpresorasPorRecibo(ByVal recibo As Long) As DataSet
        Dim DBa As Database = DatabaseFactory.CreateDatabase
        Dim sqlCommand As String = "RecuperarImpresoraPorRecibo"
        Dim DataBaseCommand As DbCommand = DBa.GetStoredProcCommand(sqlCommand)

        DBa.AddInParameter(DataBaseCommand, "Recibo", DbType.Int32, recibo)
        Using connection As DbConnection = DBa.CreateConnection
            connection.Open()
            Try
                Return DBa.ExecuteDataSet(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using

    End Function

    Public Sub InsertarRespuestaImpresoraFiscal(ByVal NroCaja As Int16, ByVal NroBoleta As Int16, ByVal NroRecibo As Int16)

        Dim db As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "InsertarRespuestaImpresoraFiscal"
        Dim DataBaseCommand As DbCommand = db.GetStoredProcCommand(sqlcommand)

        db.AddInParameter(DataBaseCommand, "NroCaja", DbType.Int16, NroCaja)
        db.AddInParameter(DataBaseCommand, "NroBoleta", DbType.Int16, NroBoleta)
        db.AddInParameter(DataBaseCommand, "Recibo", DbType.Int16, NroRecibo)

        Using connection As DbConnection = db.CreateConnection
            connection.Open()

            Try
                db.ExecuteNonQuery(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Function EjecutarConsulta(ByVal Consulta As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EjecutarConsulta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Consulta", DbType.String, Consulta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function ValidarExisteCara(ByVal Cara As Int16) As Boolean
        Dim db As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "ValidarExisteCara"
        Dim DataBaseCommand As DbCommand = db.GetStoredProcCommand(sqlcommand)
        db.AddInParameter(DataBaseCommand, "IdCara", DbType.Int16, Cara)

        Using connection As DbConnection = db.CreateConnection
            connection.Open()

            Try
                Return CBool(db.ExecuteScalar(DataBaseCommand))
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Function RecuperarFomaPagoActivas() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoActivas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#Region "ImpresoraIsla Fullstation"

    Public Function RecuperarUltimoInformeZ(ByVal IdIsla As Int16) As DateTime
        Dim db As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "RecuperarUltimoInformeZ"
        Dim DataBaseCommand As DbCommand = db.GetStoredProcCommand(sqlcommand)
        db.AddInParameter(DataBaseCommand, "IdIsla", DbType.Int16, IdIsla)

        Using connection As DbConnection = db.CreateConnection
            connection.Open()
            Try
                Return CDate(db.ExecuteScalar(DataBaseCommand))
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using



    End Function


    Public Function RecuperarIslasConImpresoraFiscal() As DataSet
        Dim db As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "RecuperarIslasConImpresoraFiscal"
        Dim DataBaseCommand As DbCommand = db.GetStoredProcCommand(sqlcommand)

        Using connection As DbConnection = db.CreateConnection
            connection.Open()
            Try
                Return db.ExecuteDataSet(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using


    End Function

    Public Sub InsertarLogCierreZ(ByVal Respuesta As Int16, ByVal NroCaja As Int16, ByVal Fecha As DateTime, ByVal IdIsla As Int16)
        Dim db As Database = DatabaseFactory.CreateDatabase()
        Dim sqlCommand As String = "InsertarLogCierreZ"
        Dim dataBaseCommand As DbCommand = db.GetStoredProcCommand(sqlCommand)
        db.AddInParameter(dataBaseCommand, "Respuesta", DbType.Int16, Respuesta)
        db.AddInParameter(dataBaseCommand, "NroCaja", DbType.Int16, NroCaja)
        db.AddInParameter(dataBaseCommand, "FechaHora", DbType.DateTime, Fecha)
        db.AddInParameter(dataBaseCommand, "IdIsla", DbType.Int16, IdIsla)

        Using connection As DbConnection = db.CreateConnection
            connection.Open()
            Try
                db.ExecuteReader(dataBaseCommand)

            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using


    End Sub

    Public Function RecuperarDatosImpresora(ByVal IdIsla As Int16) As IDataReader
        Dim db As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "RecuperarDatosImpresora"
        Dim DataBaseCommand As DbCommand = db.GetStoredProcCommand(sqlcommand)

        db.AddInParameter(DataBaseCommand, "IdIsla", DbType.Int16, IdIsla)

        Using connection As DbConnection = db.CreateConnection
            connection.Open()
            Try
                Return db.ExecuteReader(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIslaPorPuerto(ByVal Puerto As String) As Int16
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim sqlCommand As String = "RecuperarIslaPorPuerto"
        Dim DataBaseCommand As DbCommand = DB.GetStoredProcCommand(sqlCommand)

        DB.AddInParameter(DataBaseCommand, "Puerto", DbType.String, Puerto)

        Using connection As DbConnection = DB.CreateConnection

            connection.Open()
            Try
                Return CShort(DB.ExecuteScalar(DataBaseCommand))

            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub EliminarImpresoraIsla(ByVal idImpresoraIsla As Int16)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "eliminarImpresoraIsla"
        Dim DataBaseCommand As DbCommand = DB.GetStoredProcCommand(sqlcommand)

        DB.AddInParameter(DataBaseCommand, "IdImpresoraIsla", DbType.Int16, idImpresoraIsla)
        Using connection As DbConnection = DB.CreateConnection
            connection.Open()
            Try
                DB.ExecuteNonQuery(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using
    End Sub

    Public Sub InsertarImpresoraIsla(ByVal IdIsla As Int16, ByVal IdImpresora As Int16)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "InsertarImpresoraIsla"

        Dim DataBaseCommand As DbCommand = DB.GetStoredProcCommand(sqlcommand)
        DB.AddInParameter(DataBaseCommand, "IdIsla", DbType.Int16, IdIsla)
        DB.AddInParameter(DataBaseCommand, "IdImpresora", DbType.Int16, IdImpresora)

        Using connection As DbConnection = DB.CreateConnection
            connection.Open()
            Try
                DB.ExecuteNonQuery(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Sub ActualizarImpresoraIsla(ByVal IdImpresoraIsla As Int16, ByVal IdIsla As Int16, ByVal IdImpresora As Int32)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "ActualizarImpresoraIsla"

        Dim DataBaseCommand As DbCommand = DB.GetStoredProcCommand(sqlcommand)
        DB.AddInParameter(DataBaseCommand, "IdImpresoraIsla", DbType.Int16, IdImpresoraIsla)
        DB.AddInParameter(DataBaseCommand, "IdIsla", DbType.Int16, IdIsla)
        DB.AddInParameter(DataBaseCommand, "IdImpresora", DbType.Int32, IdImpresora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                DB.ExecuteNonQuery(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    ''***********************
    Public Function RecuperarImpresorasXIslas() As DataSet

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim sqlcommand As String = "RecuperarImpresorasXIslas"

        Dim DataBaseCommand As DbCommand = DB.GetStoredProcCommand(sqlcommand)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Return DB.ExecuteDataSet(DataBaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try

        End Using
    End Function

#End Region
    '***************************************
    Public Sub InsertarComunicacion(ByVal FechaInicial As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarComunicacion"

        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarComunicacion(ByVal FechaFinal As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarComunicacion"

        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    '********************************


#Region "DTI"
    Function RecuperarConfiguracionCara() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguracionCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return (DB.ExecuteReader(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarCaraPorDispositivo(ByVal IdLectorDti As Integer, ByVal PuertoDti As String) As Byte
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaraPorDispositivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLectorDti", DbType.Int32, IdLectorDti)
        DB.AddInParameter(DatabaseCommand, "PuertoDti", DbType.String, PuertoDti)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CByte(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Function RecuperarFechaProximoMantenimientoVehiculoImpresion(ByVal Rom As String, ByVal EsLecturaObligatoria As Boolean) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFechaProximoMantenimientoVehiculoImpresion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "EsLecturaObligatoria", DbType.Boolean, EsLecturaObligatoria)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarPlacaPorIdentificadorVehiculo(ByVal ROM As String, ByVal SolicitaLectura As Boolean) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorIdentificadorVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)
        DB.AddInParameter(DatabaseCommand, "SolicitaLectura", DbType.Boolean, SolicitaLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarFechaProximoMantenimientoVehiculo(ByVal Rom As String, ByVal EsGasolina As Boolean) As Date
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFechaProximoMantenimientoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "EsLecturaObligatoria", DbType.Boolean, EsGasolina)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDate(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarPlacaPorIdentificador(ByVal ROM As String, ByVal SolicitaLectura As Boolean) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)
        DB.AddInParameter(DatabaseCommand, "SolicitaLectura", DbType.Boolean, SolicitaLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarDispositivosDti() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivosDti"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return (DB.ExecuteReader(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarDispositivosDTIGrilla() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivosDTI"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub InsertarDispositivoDTI(ByVal Descripcion As String, ByVal Puerto As Int32, ByVal PuertoIP As String, ByVal TipoComunicacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDispositivoDTI"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.Int32, Puerto)
        DB.AddInParameter(DatabaseCommand, "TipoComunicacion", DbType.String, TipoComunicacion)
        DB.AddInParameter(DatabaseCommand, "PuertoIP", DbType.String, PuertoIP)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarDispositivoDTI(ByVal IdLectorDTI As Int32, ByVal Descripcion As String, ByVal Puerto As Int32, ByVal PuertoIP As String, ByVal TipoComunicacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDispositivoDTI"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, Puerto)
        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int32, IdLectorDTI)
        DB.AddInParameter(DatabaseCommand, "TipoComunicacion", DbType.String, TipoComunicacion)
        DB.AddInParameter(DatabaseCommand, "PuertoIP", DbType.String, PuertoIP)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function RecuperarDispositivosDTICara() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivosDTICara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDescripcionDTI() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDescripcionDTI"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub EliminarDispositivoDTI(ByVal IdDispositivoDTI As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarDispositivoDTI"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDispositivoDTI", DbType.Int32, IdDispositivoDTI)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarConfiguraCaraDTI() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguraCaraDTI"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConfiguraCaraDTI(ByVal IdDTI As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguraCaraDTI"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDTI", DbType.Int32, IdDTI)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarDispositivoDTICara(ByVal IdDispositivoCara As Int32, ByVal IdDTI As Int32, ByVal IdCara As Int32, ByVal Serial As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDispositivoDTICara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDispositivoCara", DbType.Int32, IdDispositivoCara)
        DB.AddInParameter(DatabaseCommand, "IdDTI", DbType.Int32, IdDTI)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, IdCara)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, Serial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarDispositivoDTICara(ByVal IdDTI As Int32, ByVal IdCara As Int32, ByVal Serial As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDispositivoDTICara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDTI", DbType.Int32, IdDTI)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, IdCara)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, Serial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarDispositivoDTICara(ByVal IdDispositivoCara As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarDispositivoDTICara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDispositivoCara", DbType.Int32, IdDispositivoCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


#End Region

#Region "CHIP MADRE"

    Public Function ValidarChipMadre(ByVal ROM As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarChipMadre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNroTanqueosConChipMadre(ByVal Placa As String) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNroTanqueosConChipMadre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region


    Public Function RecuperarSurtidoresSinTurnoAbiertoArm() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresSinTurnoAbiertoArm"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarSurtidoresSinTurnoAbierto() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresSinTurnoAbierto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarSurtidoresConTurnoAbierto() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresConTurnoAbierto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarAutorizaGerenciamiento(ByVal Autorizacion As String, ByVal Estado As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarAutorizaGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int16, Estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub AutorizacionVentaCreditoBolivia(ByVal TipoIdentificacion As Integer, ByVal Nit As String, ByVal Vale As String, ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AutorizacionVentaCreditoBolivia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, Vale)
        DB.AddInParameter(DatabaseCommand, "PlacaCliente", DbType.String, Placa)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Sub ActualizarTipoEnvase(ByVal IdTipoEnvase As Integer, ByVal Descripcion As String, ByVal Abreviatura As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTipoEnvase"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoEnvase", DbType.Int32, IdTipoEnvase)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Abreviatura", DbType.String, Abreviatura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ValidarSolicitudDatosCDCCHile(ByVal Placa As String, ByVal Tipo As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSolicitudDatosCDCCHile"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, Tipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarAhorroEnVentaVehiculo(ByVal Recibo As Integer) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAhorroEnVentaVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarMensajesCapturador()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMensajes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function RecuperarMensajesCapturador() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Dim SqlCommandE As String = "EliminarMensajes"
        Dim DatabaseCommandE As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommandE)
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarTipoEnvases() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoEnvases"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#Region "Historico Impuesto"
    Public Sub InsertarHistoricoImpuesto(ByVal IdImpuesto As Int32, ByVal Porcentaje As Decimal, ByVal FechaHora As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarHistoricoImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpuesto", DbType.Int32, IdImpuesto)
        DB.AddInParameter(DatabaseCommand, "Porcentaje", DbType.Decimal, Porcentaje)
        DB.AddInParameter(DatabaseCommand, "FechaHora", DbType.DateTime, FechaHora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarHistoricoImpuesto(ByVal IdImpuesto As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHistoricoImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpuesto", DbType.Int32, IdImpuesto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarHistoricoTRM(ByVal Fecha As Date, ByVal Valor As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarHistoricoTRM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.Date, Fecha)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarHistoricoTRM() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHistoricoTRM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarLLaveControl(ByVal TipoOperacion As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLLaveControl"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoOperacion", DbType.Int32, TipoOperacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarLLaveControlImpresion(ByVal TipoOperacion As Integer) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLLaveControl"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoOperacion", DbType.Int32, TipoOperacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   Notas Crdito   "

    Public Function RecuperarDetalleNotaCreditoFactura(ByVal IdNotaCredito As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleNotaCreditoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdNotaCredito", DbType.Int64, IdNotaCredito)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTransaccionPorFecha(ByVal FechaInicial As String, ByVal FechaFinal As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTransaccionPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.String, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTransaccionPorRecibo(ByVal Recibo As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTransaccionPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMediosPagoAplicablesNota(ByVal IdFormaPago As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMediosPagoAplicablesNota"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim DatosMediosPago As DataSet

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DatosMediosPago = DB.ExecuteDataSet(DatabaseCommand)

                If DatosMediosPago.Tables.Count > 0 Then
                    Return DatosMediosPago.Tables(0)
                Else
                    Return Nothing
                End If
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMediosPagoAplicablesNotaRecibo(ByVal Recibo As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMediosPagoAplicablesNotaRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim DatosMediosPago As DataSet

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DatosMediosPago = DB.ExecuteDataSet(DatabaseCommand)

                If DatosMediosPago.Tables.Count > 0 Then
                    Return DatosMediosPago.Tables(0)
                Else
                    Return Nothing
                End If
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNotaCreditoFactura(ByVal IdNotaCredito As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNotaCreditoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdNotaCredito", DbType.Int64, IdNotaCredito)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarNotaCreditoFactura(ByVal IdNotaCredito As Int64, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNotaCreditoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdNotaCredito", DbType.Int64, IdNotaCredito)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarNotaCreditoSodexo(ByVal Recibo As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarNotaCreditoSodexo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEncabezadoNotaCreditoSodexo(ByVal IdNotaCreditoSodexo As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoNotaCreditoSodexo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdNotaCreditoSodexo", DbType.Int32, IdNotaCreditoSodexo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarMediosPagoNotaTemp(ByVal Recibo As Double, ByVal IdFormaPago As Int16, ByVal Documento As String, ByVal Valor As Double, ByVal saldo As Decimal, ByVal EsAutorizado As Boolean, ByVal IdTipoLectura As Int32, ByVal NroConfirmacion As String, ByVal MontoReal As Double, ByVal esMedioPagoEspecial As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMediosPagoNotaTemp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdMedioPago As Int64

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago ", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, Valor)
        DB.AddInParameter(DatabaseCommand, "Saldo", DbType.Decimal, saldo)
        DB.AddInParameter(DatabaseCommand, "EsAutorizado", DbType.Boolean, EsAutorizado)
        DB.AddInParameter(DatabaseCommand, "IdTipoLectura", DbType.Int32, IdTipoLectura)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, NroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "EsMedioPagoEspecial", DbType.Boolean, esMedioPagoEspecial)
        DB.AddInParameter(DatabaseCommand, "MontoReal", DbType.Decimal, MontoReal)

        DB.AddOutParameter(DatabaseCommand, "IdMedioPago", DbType.Int64, CInt(IdMedioPago))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "IdMedioPago"))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimaNotaCreditoSodexo() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaNotaCreditoSodexo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   Consulta de Transacciones por Fecha     "
    Public Function RecuperarTransaccionesdeVentaPorFecha(ByVal FechaInicio As String, ByVal FechaFin As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTransaccionesdeVentaPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicio", DbType.String, FechaInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFin", DbType.String, FechaFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Seguridad"

    Public Function RecuperarUsuariosxAplicacion(ByVal NombreAplicacion As String) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUsuariosxAplicacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ApplicationName", DbType.String, NombreAplicacion)

        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oTable As DataTable = DB.ExecuteDataSet(DatabaseCommand).Tables(0)
                Return oTable
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarRolesxAplicacion(ByVal NombreAplicacion As String) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "aspnet_Roles_GetAllRoles"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ApplicationName", DbType.String, NombreAplicacion)

        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarRoles() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "[RecuperarRoles]"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUsuariosporRole(ByVal RoleName As String, ByVal ApplicationName As String) As DataTable
        Try
            'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
            Dim DB As Database = DatabaseFactory.CreateDatabase()

            'Crea un sqlComand a partir del nombre del procedimiento almacenado
            Dim SqlCommand As String = "aspnet_UsersInRoles_GetUsersInRoles"
            Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

            DB.AddInParameter(DatabaseCommand, "RoleName", DbType.String, RoleName)
            DB.AddInParameter(DatabaseCommand, "ApplicationName", DbType.String, ApplicationName)


            Using connection As DbConnection = DB.CreateConnection()
                Try
                    'Ejecuta el Procedimiento Almacenado
                    Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
                Catch Ex As Exception
                    Throw Ex
                Finally
                    connection.Close()
                End Try
            End Using
        Catch ex As Exception
            Throw ex
        End Try
    End Function

    Public Function RecuperarAccionesPorRole(ByVal RoleName As String) As DataTable
        Try
            'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
            Dim DB As Database = DatabaseFactory.CreateDatabase()

            'Crea un sqlComand a partir del nombre del procedimiento almacenado
            Dim SqlCommand As String = "RecuperarAccionesPorRole"
            Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

            DB.AddInParameter(DatabaseCommand, "RoleName", DbType.String, RoleName)

            Using connection As DbConnection = DB.CreateConnection()
                Try
                    'Ejecuta el Procedimiento Almacenado
                    Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
                Catch Ex As Exception
                    Throw Ex
                Finally
                    connection.Close()
                End Try
            End Using
        Catch ex As Exception
            Throw ex
        End Try
    End Function

    Public Sub ActualizarPermisosPorAccion(ByVal IdAccion As Int32, ByVal IdRole As Guid, ByVal EsPermitido As Boolean)
        Try
            'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
            Dim DB As Database = DatabaseFactory.CreateDatabase()

            'Crea un sqlComand a partir del nombre del procedimiento almacenado
            Dim SqlCommand As String = "ActualizarPermisosPorAccion"
            Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

            DB.AddInParameter(DatabaseCommand, "IdAccion", DbType.Int32, IdAccion)
            DB.AddInParameter(DatabaseCommand, "IdRole", DbType.Guid, IdRole)
            DB.AddInParameter(DatabaseCommand, "EsPermitido", DbType.Boolean, EsPermitido)

            Using connection As DbConnection = DB.CreateConnection()
                Try
                    'Ejecuta el Procedimiento Almacenado
                    DB.ExecuteNonQuery(DatabaseCommand)
                Catch Ex As Exception
                    Throw Ex
                Finally
                    connection.Close()
                End Try
            End Using
        Catch ex As Exception
            Throw ex
        End Try
    End Sub

    Public Function ValidarUsuarioASPNet(ByVal Usuario As String) As Guid
        Try
            'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
            Dim DB As Database = DatabaseFactory.CreateDatabase()

            'Crea un sqlComand a partir del nombre del procedimiento almacenado
            Dim SqlCommand As String = "ValidarUsuarioASPNet"
            Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

            DB.AddInParameter(DatabaseCommand, "Usuario", DbType.String, Usuario)

            Using connection As DbConnection = DB.CreateConnection()
                Try
                    'Ejecuta el Procedimiento Almacenado
                    Return CType(DB.ExecuteScalar(DatabaseCommand), Guid)
                Catch Ex As Exception
                    Throw Ex
                Finally
                    connection.Close()
                End Try
            End Using
        Catch ex As Exception
            Throw ex
        End Try
    End Function

    Public Function ValidarPermisosPorAccion(ByVal UserId As Guid, ByVal IdAccion As Int32) As Boolean
        Try
            'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
            Dim DB As Database = DatabaseFactory.CreateDatabase()

            'Crea un sqlComand a partir del nombre del procedimiento almacenado
            Dim SqlCommand As String = "ValidarPermisosPorAccion"
            Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

            DB.AddInParameter(DatabaseCommand, "UserId", DbType.Guid, UserId)
            DB.AddInParameter(DatabaseCommand, "IdAccion", DbType.Int32, IdAccion)

            Using connection As DbConnection = DB.CreateConnection()
                Try
                    'Ejecuta el Procedimiento Almacenado
                    Return CBool(DB.ExecuteScalar(DatabaseCommand))
                Catch Ex As Exception
                    Throw Ex
                Finally
                    connection.Close()
                End Try
            End Using
        Catch ex As Exception
            Throw ex
        End Try
    End Function
#End Region

#Region "Gazel Diana"

    Public Sub InsertarPremioFidelizacionGazel(ByVal Idturno As Integer, ByVal valor As Decimal, ByVal idPremio As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPremioFidelizacionGazel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Idturno", DbType.Int32, Idturno)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, idPremio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarPremioFidelizacionGazel(ByVal Idturno As Integer, ByVal valor As Decimal, ByVal idPremio As Integer, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPremioFidelizacionGazel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Idturno", DbType.Int32, Idturno)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, idPremio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarDensidad() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDensidad"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsPremioRecargaCelular(ByVal IdPremio As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsPremioRecargaCelular"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, IdPremio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function EsCaraGas(ByVal IdCara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsCaraGas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsPremioRecargaCelularTerpel(ByVal IdPremio As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsPremioRecargaCelularTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, IdPremio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



#End Region

#Region "Canastilla"
    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarNotaCreditoPorConsecutivo(ByVal consecutivo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNotaCreditoPorConsecutivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarNotaCreditoPorConsecutivoTerpel(ByVal prefijo As String, ByVal consecutivo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNotaCreditoPorConsecutivoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarFacturaPorNotaCredito(ByVal nota As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaPorNotaCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nota", DbType.Int32, nota)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturaPorNotaCreditoTerpel(ByVal nota As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaPorNotaCreditoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nota", DbType.Int32, nota)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturaPorId(ByVal idFactura As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFactura", DbType.Int32, idFactura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaCanastillaPorId(ByVal Recibo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaCanastillaPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFacturaDetalle(ByVal factura As Int32, ByVal EsTerpel As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddInParameter(DatabaseCommand, "EsTerpel", DbType.Boolean, EsTerpel)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFacturaDetalle(ByVal factura As Int32, ByVal EsTerpel As Boolean, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddInParameter(DatabaseCommand, "EsTerpel", DbType.Boolean, EsTerpel)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboCanastillaDetalle(ByVal IdVenta As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCanastillaDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int32, IdVenta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboCanastillaDetalle(ByVal IdVenta As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCanastillaDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int32, IdVenta)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturaDetalleInvLiquido(ByVal factura As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaDetalleInvLiquido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFacturaDetalleInvLiquido(ByVal factura As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaDetalleInvLiquido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormasPagoFacturaInvLiquido(ByVal factura As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoFacturaInvLiquido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDetalleMediosPago(ByVal recibo As Long, ByVal idFormaPago As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleMediosPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Revisado uso correcto de Pool de Conexiones
    Public Function RecuperarFacturaDetallePrepago(ByVal consecutivo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaDetallePrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet


        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado uso correcto de Pool de Conexiones
    Public Function RecuperarVentaDetalleTarjeta(ByVal recibo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaDetalleTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "recibo", DbType.Int32, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Uso Correcto del Pool de Conexiones
    Public Function RecuperarVentaDetalleNoPrepago(ByVal recibo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaDetalleNoPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "recibo", DbType.Int32, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado uso correcto de Pool de Conexiones
    Public Function RecuperarFacturaDetalleTarjeta(ByVal consecutivo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaDetalleTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Uso Correcto del Pool de Conexiones
    Public Function RecuperarFacturaDetalleNoPrepago(ByVal consecutivo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaDetalleNoPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarIdProducto(ByVal codigo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoProducto", DbType.Int32, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdProductoCombustible(ByVal codigo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdProductoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPrecioProductoPorId(ByVal idProducto As Int32) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioProductoPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDbl(DB.ExecuteScalar(DatabaseCommand))

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarFacturaDetalleTmp(ByVal nomEquipo As String, ByVal idProducto As Int32, ByVal cantidad As Int32, ByVal precio As Double, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaDetalleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, nomEquipo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, cantidad)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarFacturaDetalleTmp(ByVal nomEquipo As String, ByVal idProducto As Int32, ByVal cantidad As Int32, ByVal precio As Double, ByVal porcentajeDescuento As Decimal, ByVal cantAutorizadaDescuento As Int32, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaDetalleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, nomEquipo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, cantidad)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "PorcentajeDescuento", DbType.Decimal, porcentajeDescuento)
        DB.AddInParameter(DatabaseCommand, "CantidadAutorizadaDescuento", DbType.Int32, cantAutorizadaDescuento)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function InsertarTarjetaCupo(ByVal nroTarjeta As String, ByVal Cupo As Double, ByVal identificacion As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTarjetaCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim CupoTotal As Double

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, Cupo)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddOutParameter(DatabaseCommand, "CupoTotal", DbType.Decimal, CInt(CupoTotal))


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CStr(DB.GetParameterValue(DatabaseCommand, "CupoTotal"))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function InsertarTarjetaCupo(ByVal nroTarjeta As String, ByVal Cupo As Double, ByVal identificacion As String, ByVal Activa As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTarjetaCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim CupoTotal As Double

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, Cupo)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddOutParameter(DatabaseCommand, "CupoTotal", DbType.Decimal, CInt(CupoTotal))
        DB.AddInParameter(DatabaseCommand, "Activa", DbType.String, Activa)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CStr(DB.GetParameterValue(DatabaseCommand, "CupoTotal"))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub ActualizarEstadoTarjetaCupo(ByVal IdCliente As String, ByVal Numero As String, ByVal Activa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoTarjetaCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.String, IdCliente)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)
        DB.AddInParameter(DatabaseCommand, "Activa", DbType.String, Activa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function InsertarCupoPrepago(ByVal nroTarjeta As String, ByVal Cupo As Double, ByVal factura As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCupoPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim CupoTotal As Double

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, Cupo)
        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddOutParameter(DatabaseCommand, "CupoTotal", DbType.Decimal, CInt(CupoTotal))


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CStr(DB.GetParameterValue(DatabaseCommand, "CupoTotal"))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarCupoTarjeta(ByVal nroTarjeta As String, ByVal Cupo As Double, ByVal idTurno As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCupoPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdCupo As Int64

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, Cupo)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddOutParameter(DatabaseCommand, "IdCupo", DbType.Int64, CInt(IdCupo))


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCupo"))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub InsertarCupoPrepagoDetalle(ByVal idCupo As Int32, ByVal IdFormaPago As Int16, ByVal Valor As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCupoPrepagoDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdCupo", DbType.Int64, idCupo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarCupoPrepago(ByVal IdCupo As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCupoPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCupo", DbType.Int32, IdCupo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTarjetaPorNumero(ByVal Numero As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTarjetaPorNumero"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarClienteTarjeta(ByVal NroTarjeta As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClienteTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, NroTarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarFactura(ByVal total As Double, ByVal idFormaPago As Int32, ByVal usuario As String, ByVal clave As String, ByVal nomEquipoActual As String, ByVal guidFactura As String) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Total", DbType.Double, total)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddOutParameter(DatabaseCommand, "IdFactura", DbType.Int32, 4)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, usuario)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "NomEquipoActual", DbType.String, nomEquipoActual)
        DB.AddInParameter(DatabaseCommand, "GUIDFactura", DbType.String, guidFactura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdFactura"))

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarFacturaDetallePrepago(ByVal idFactura As Int32, ByVal idProducto As Int32, ByVal valorCarga As Double, ByVal nroCodigoBarraPrepago As String, ByVal nroTarjetaPrepago As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaDetallePrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdFactura", DbType.Int32, idFactura)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "ValorCarga", DbType.Decimal, valorCarga)
        DB.AddInParameter(DatabaseCommand, "NroCodigoBarraPrepago", DbType.String, nroCodigoBarraPrepago)
        DB.AddInParameter(DatabaseCommand, "NroTarjetaPrepago", DbType.String, nroTarjetaPrepago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarFacturaDetallePrepagoTmp(ByVal nomEquipo As String, ByVal idProducto As Int32, ByVal valorCarga As Double, ByVal nroCodigoBarraPrepago As String, ByVal nroTarjetaPrepago As String, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaDetallePrepagoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, nomEquipo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "ValorCarga", DbType.Decimal, valorCarga)
        DB.AddInParameter(DatabaseCommand, "NroCodigoBarraPrepago", DbType.String, nroCodigoBarraPrepago)
        DB.AddInParameter(DatabaseCommand, "NroTarjetaPrepago", DbType.String, nroTarjetaPrepago)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarFacturaDetalleTarjetaTmp(ByVal nomEquipo As String, ByVal idProducto As Int32, ByVal valorCarga As Double, ByVal nroCodigoBarra As String, ByVal nroTarjeta As String, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaDetalleTarjetaTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, nomEquipo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "ValorCarga", DbType.Decimal, valorCarga)
        DB.AddInParameter(DatabaseCommand, "NroCodigoBarraPrepago", DbType.String, nroCodigoBarra)
        DB.AddInParameter(DatabaseCommand, "NroTarjetaPrepago", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarFacturaTarjetaTmp(ByVal nomEquipo As String, ByVal codigoTarjeta As String, ByVal numeroSeguridad As String, ByVal idTipoLecturaTarjeta As Int32, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaTarjetaTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, nomEquipo)
        DB.AddInParameter(DatabaseCommand, "CodigoTarjeta", DbType.String, codigoTarjeta)
        DB.AddInParameter(DatabaseCommand, "NumeroSeguridad", DbType.String, numeroSeguridad)
        DB.AddInParameter(DatabaseCommand, "IdTipoLecturaTarjeta", DbType.String, idTipoLecturaTarjeta)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarFacturaFormaPago(ByVal idFactura As Int32, ByVal idFormaPago As Int32, ByVal valor As Double, ByVal referencia As String, ByVal tipoLectura As Nullable(Of Int32))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdFactura", DbType.Int32, idFactura)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Referencia", DbType.String, referencia)
        DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, tipoLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarFacturaFormaPagoTmp(ByVal nomEquipo As String, ByVal idFormaPago As Int16, ByVal valor As Double, ByVal referencia As String, ByVal tipoLectura As Nullable(Of Int32), ByVal nroConfirmacion As String, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaFormaPagoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, nomEquipo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Referencia", DbType.String, referencia)
        DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, tipoLectura)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, nroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function AnularFactura(ByVal consecutivo As Int32, ByVal usuario As String, ByVal clave As String) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AnularFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, usuario)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function AnularFactura(ByVal consecutivo As Int32, ByVal usuario As String, ByVal clave As String, ByVal idEstacion As Int16) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AnularFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, usuario)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub AnularFactura(ByVal Recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AnularFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteScalar(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarConsecutivoFactura(ByVal idFactura As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsecutivoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFactura", DbType.Int32, idFactura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarIdFactura(ByVal consecutivo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarReciboVentaCanastilla(ByVal idVentaCanastilla As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "IdVentaCanastilla", DbType.Int32, idVentaCanastilla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarFacturaParaImpresion(ByVal factura As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFacturaParaImpresion(ByVal factura As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPredeterminacionDescuentoCredito(ByVal precioActual As Decimal, ByVal valorAutorizado As Decimal, ByVal valorPredeterminado As Decimal, ByVal tipoPredeterminacion As Integer, ByVal tipoManejo As Int32, ByVal porcentajeDescuento As Decimal, ByVal valorFijoDescuento As Decimal) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionDescuentoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "PrecioActual", DbType.Decimal, precioActual)
        DB.AddInParameter(DatabaseCommand, "ValorAutorizado", DbType.Decimal, valorAutorizado)
        DB.AddInParameter(DatabaseCommand, "ValorPredeterminado", DbType.Decimal, valorPredeterminado)
        DB.AddInParameter(DatabaseCommand, "TipoPredeterminacion", DbType.Int32, tipoPredeterminacion)
        DB.AddInParameter(DatabaseCommand, "TipoManejo", DbType.Int32, tipoManejo)
        DB.AddInParameter(DatabaseCommand, "PorcentajeDescuento", DbType.Decimal, porcentajeDescuento)
        DB.AddInParameter(DatabaseCommand, "ValorFijoDescuento", DbType.Decimal, valorFijoDescuento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPredeterminacionDescuentoIsla(ByVal placa As String, ByVal rom As String, ByVal precio As Decimal, ByVal valor As Decimal, ByVal tipo As Integer, ByVal idProducto As Integer, ByVal idcara As Byte) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionDescuentoIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idcara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Creado por: Christian Galvis
    Public Function RecuperarPredeterminacionDescuentoIsla(ByVal placa As String, ByVal rom As String, ByVal precio As Decimal, ByVal valor As Decimal, ByVal tipo As Integer, ByVal idProducto As Integer, ByVal idcara As Byte, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionDescuentoIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idcara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarPredeterminacionClientePaso(ByVal idManguera As Int16, ByVal idProducto As Int32, ByVal valor As Decimal) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionClientePaso"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarPredeterminacionClientePaso(ByVal idManguera As Int16, ByVal idProducto As Int32, ByVal valor As Decimal, ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionClientePaso"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarPredeterminacionClienteIdentificado(ByVal idCara As Int16, ByVal idProducto As Int32, ByVal valor As Decimal, ByVal precio As Decimal) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionClienteIdentificado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarPredeterminacionClienteIdentificado(ByVal idCara As Int16, ByVal idProducto As Int32, ByVal valor As Decimal, ByVal precio As Decimal, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionClienteIdentificado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboCanastilla(ByVal IdVenta As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int32, IdVenta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboCanastilla(ByVal IdVenta As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int32, IdVenta)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturaInvLiquido(ByVal factura As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaInvLiquido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarFacturaAnulacionCanastilla(ByVal factura As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaAnulacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumentoAnulado", DbType.Int32, factura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFacturaInvLiquido(ByVal factura As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaInvLiquido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturaPorConsecutivo(ByVal consecutivo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNotaCredito(ByVal factura As Int32, ByVal EsTerpel As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNotaCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddInParameter(DatabaseCommand, "EsTerpel", DbType.Boolean, EsTerpel)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarNotaCredito(ByVal factura As Int32, ByVal EsTerpel As Boolean, ByVal idestacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNotaCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Factura", DbType.Int32, factura)
        DB.AddInParameter(DatabaseCommand, "EsTerpel", DbType.Boolean, EsTerpel)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRegistroPorMaquina(ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRegistroPorMaquina"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDiscriminacionTerminal(ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDiscriminacionTerminal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesPorFormaPago(ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTipoIvaTarifa() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoIvaTarifa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarPagosPorTarifaIva(ByVal fecha As String, ByVal tipoIva As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPagosPorTarifaIva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "TipoIva", DbType.Int32, tipoIva)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ESFacturaPrepago(ByVal idFactura As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESFacturaPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "IdFactura", DbType.Int32, idFactura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ESFacturaTarjeta(ByVal idFactura As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESFacturaTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "IdFactura", DbType.Int32, idFactura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ESVentaTarjeta(ByVal Recibo As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESVentaTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function EsUltimoTurnoDia(ByVal IdTurno As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsUltimoTurnoDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
    Public Function EsUltimoTurnoDia(ByVal IdTurno As Int32, ByVal IdEstacion As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsUltimoTurnoDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function EsUltimoTurno(ByVal IdTurno As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsUltimoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function EsTurnoHorarioFinalizado(ByVal IdCara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsTurnoHorarioFinalizado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ManejaVeederRoot() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaVeederRoot"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
    Public Function ManejaVeederRoot(ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaVeederRoot"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarMovimientoCanastillaDetalle(ByVal idMovimiento As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMovimientoCanastillaDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMovimiento", DbType.Int32, idMovimiento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMovimientoCanastilla(ByVal idMovimiento As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMovimientoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMovimiento", DbType.Int32, idMovimiento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "Consecutivo"
    Public Sub ActualizarConsecutivo(ByVal tabla As String, ByVal consecutivo As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarConsecutivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)
        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarConsecutivo(ByVal tabla As String, ByVal consecutivo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarConsecutivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)
        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int64, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub VerificarVentaGasoNet(ByVal IdCara As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "VerificarVentaGasoNet"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarConsecutivos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsecutivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsecutivosPorFecha(ByVal Fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsecutivosPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha ", DbType.String, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsecutivo() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsecutivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosMenoCash(ByVal IdCara As Int32, IdProducto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosMenoCash"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, IdCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNumeroGasoNet(ByVal IdCara As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumeroGasoNet"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosTicketGasoNet(ByVal Recibo As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosTicketGasoNet"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.String, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarConsecutivo(ByVal tabla As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsecutivoPorTabla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboPorConsecutivoModificacion(ByVal consecutivo As Int64) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboPorConsecutivoModificacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int64, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Capturador"
    Public Sub ActualizarCapturador(ByVal idCapturador As Int32, ByVal puerto As String, ByVal isla As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, isla)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdCapturador", DbType.Int32, idCapturador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCapturador(ByVal idCapturador As Int32, ByVal puerto As String, ByVal isla As Int32, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, isla)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdCapturador", DbType.Int32, idCapturador)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarCapturador(ByVal puerto As String, ByVal isla As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, isla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarCapturador(ByVal puerto As String, ByVal isla As Int32, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, isla)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarCapturador(ByVal idCapturador As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCapturador", DbType.Int32, idCapturador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "OneWire"
    Public Sub ActualizarOneWire(ByVal idOneWire As Int32, ByVal puerto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarOneWire"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdOneWire", DbType.Int32, idOneWire)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarOneWire(ByVal idOneWire As Int32, ByVal puerto As String, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarOneWire"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdOneWire", DbType.Int32, idOneWire)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarOneWire(ByVal puerto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarOneWire"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarOneWire(ByVal puerto As String, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarOneWire"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRedLector(ByVal idOneWire As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRedLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdOneWire", DbType.Int32, idOneWire)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarPuertoRedOneWire(ByVal idOneWire As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertoRedOneWire"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdOneWire", DbType.Int32, idOneWire)
        DB.AddOutParameter(DatabaseCommand, "Puerto", DbType.String, 16)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CType(DB.ExecuteScalar(DatabaseCommand), String)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRedesOneWire() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedesOneWire"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Cara"
    Function RecuperarImpresoraPorTurnoChile(ByVal turno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorTurnoChile"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarImpresoraPorTurno(ByVal turno As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarImpresoraPorTurno(ByVal turno As Int32, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, turno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEstadoCara(ByVal idCara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado

        Dim SqlCommand As String = "RecuperarEstadoCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEstadoCaraCambioTarjeta(ByVal idCara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado

        Dim SqlCommand As String = "RecuperarEstadoCaraCambioTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEstadoCaraManguera(ByVal idCara As Int16, ByVal idManguera As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado

        Dim SqlCommand As String = "RecuperarEstadoCaraManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEstadoCaraManguera(ByVal idCara As Int16, ByVal idManguera As Int16, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado

        Dim SqlCommand As String = "RecuperarEstadoCaraManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarImpresoraPorCaraChile(ByVal idCara As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresorasPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    'Function RecuperarImpresoraPorCara(ByVal idCara As Int32, ByVal IdEstacion As Int16) As IDataReader
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "RecuperarImpresoraPorCara"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

    '    DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, idCara)
    '    DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()
    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            Return DB.ExecuteReader(DatabaseCommand)
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Function


    Function RecuperarImpresoraPorCaraChile(ByVal idCara As Int32, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarImpresoraPorCara(ByVal idCara As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarImpresoraPorCara(ByVal idCara As Int32, ByVal IdEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarIdImpresoraPorPuertoCapturador(ByVal puerto As String) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdImpresoraPorPuertoCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarImpresoraPorPuertoCapturadorChile(ByVal puerto As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresorasPorPuertoCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarImpresoraPorPuertoCapturador(ByVal puerto As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorPuertoCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpresoraPorPuertoCapturador(ByVal puerto As String, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorPuertoCapturador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPuertoCapturadorPorCara(ByVal idCara As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertoCapturadorPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarReciboPorNumeroCara(ByVal numero As String, ByVal prefijo As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboPorNumeroCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function EsVentaCanastilla(ByVal numero As String, ByVal prefijo As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarReciboPorNumeroCaraCanastilla(ByVal numero As String, ByVal prefijo As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboPorNumeroCaraCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarReciboCanastillaPeru(ByVal numero As String, ByVal prefijo As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCanastillaPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboParaBonoFidelizacion(ByVal numero As String, ByVal prefijo As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboParaBonoFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarAlertaDocumentoAnulado(ByVal numero As String, ByVal prefijo As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarAlertaDocumentoAnulado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboCara(ByVal cara As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboCara(ByVal cara As Byte) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboCaraPeru(ByVal cara As Byte, Optional ByVal EsCredito As Boolean = False) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, cara)
        DB.AddInParameter(DatabaseCommand, "EsCredito", DbType.Boolean, EsCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboCara(ByVal cara As Byte, ByVal idEstacion As Int16) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboCaraAnulado(ByVal cara As Byte) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboCaraAnulado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub RecuperarReciboFactura(ByVal numero As String, ByRef recibo As Int64, ByRef id_documento As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddOutParameter(DatabaseCommand, "IdDocumento", DbType.Int64, 0)
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, 0)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                DB.ExecuteNonQuery(DatabaseCommand)
                recibo = CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
                id_documento = CLng(DB.GetParameterValue(DatabaseCommand, "IdDocumento"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub DisminuirCupoVehiculoRetirado(ByVal Placa As String, ByVal id_documento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "DisminuirCupoVehiculoRetirado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdCreditoConsumo", DbType.Int64, id_documento)
        Using Connection As DbConnection = DB.CreateConnection()
            Connection.Open()
            Try
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                Connection.Close()
            End Try
        End Using
    End Sub



    Public Sub RecuperarReciboFactura(ByRef recibo As Int64, ByRef id_documento As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddOutParameter(DatabaseCommand, "IdDocumento", DbType.Int64, 0)
        Using Connection As DbConnection = DB.CreateConnection()
            Connection.Open()
            Try
                DB.ExecuteNonQuery(DatabaseCommand)
                id_documento = CLng(DB.GetParameterValue(DatabaseCommand, "IdDocumento"))
            Catch
                Throw
            Finally
                Connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarReciboFacturaAnuladoa(ByVal numero As String) As String

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboFacturaAnulado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function ValidarTurnoPorEmpleado(ByVal Cedula As String, ByVal Clave As String) As String

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTurnoPorEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado ", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddOutParameter(DatabaseCommand, "IdTurnoE", DbType.String, 10)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarNuevoDocumento(ByVal recibo As Double) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNuevoDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RECIBO", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarSlogan(ByVal idMensaje As Int32, ByVal texto As String, ByVal desde As Date, ByVal hasta As Date, ByVal tipo As Int32, ByVal idCliente As Nullable(Of Int32), ByVal estado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSlogan"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMensaje", DbType.Int32, idMensaje)
        DB.AddInParameter(DatabaseCommand, "Texto", DbType.String, texto)
        DB.AddInParameter(DatabaseCommand, "Desde", DbType.Date, desde)
        DB.AddInParameter(DatabaseCommand, "Hasta", DbType.Date, hasta)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarSloganCombustible(ByVal idMensaje As Int32, ByVal texto As String, ByVal desde As Date, ByVal hasta As Date, ByVal tipo As Int32, ByVal idCliente As Nullable(Of Int32), ByVal estado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSloganCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMensaje", DbType.Int32, idMensaje)
        DB.AddInParameter(DatabaseCommand, "Texto", DbType.String, texto)
        DB.AddInParameter(DatabaseCommand, "Desde", DbType.Date, desde)
        DB.AddInParameter(DatabaseCommand, "Hasta", DbType.Date, hasta)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarSloganPeru(ByVal dsMensajes As System.Data.DataSet)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSloganPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        'Transaccin
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Iniciamos la transaccin
                Transaccion = connection.BeginTransaction
                'Recorremos el DataSet
                For Each fila As Data.DataRow In dsMensajes.Tables(0).Rows
                    DB.SetParameterValue(DatabaseCommand, "IdMensaje", fila.Item(0))
                    DB.SetParameterValue(DatabaseCommand, "Texto", fila.Item(1))
                    DB.SetParameterValue(DatabaseCommand, "Desde", fila.Item(2))
                    DB.SetParameterValue(DatabaseCommand, "Hasta", fila.Item(3))
                    DB.SetParameterValue(DatabaseCommand, "Tipo", fila.Item(4))
                    DB.SetParameterValue(DatabaseCommand, "IdCliente", fila.Item(5))
                    DB.SetParameterValue(DatabaseCommand, "Estado", fila.Item(6))
                    DB.SetParameterValue(DatabaseCommand, "Orden", fila.Item(7))
                    'Ejecuta el Procedimiento Almacenado
                    DB.ExecuteNonQuery(DatabaseCommand)
                Next
                'Hacemos el Commit
                Transaccion.Commit()
            Catch
                'Si se presenta algn error se hace Rollback
                Transaccion.Rollback()
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Sub EliminarSlogan(ByVal idMensaje As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarSlogan"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMensaje", DbType.Int32, idMensaje)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarSloganCombustible(ByVal idMensaje As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarSloganCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMensaje", DbType.Int32, idMensaje)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarReversion(ByVal recibo As Int64, ByVal cedula As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarReversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.Int64, cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarReversion(ByVal recibo As Int64, ByVal cedula As String, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarReversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.Int64, cedula)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarCara(ByVal descripcion As String, ByVal idSurtidor As Int16, ByVal idLector As Int32, ByVal estado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarCara(ByVal idCara As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub EliminarLLaveValidacion(ByVal IdLLave As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarLLaveValidacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLlave", DbType.Int32, IdLLave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarCara(ByVal idCara As Int16, ByVal idLector As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarCara(ByVal idCara As Int16, ByVal idLector As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCara(ByVal idCara As Int16, ByVal idLector As Int32, ByVal Estado As Boolean, ByVal IdSurtidor As Int32, ByVal AliasCara As Int32, Optional ByVal ManejaCincoDigitos As Boolean = False, Optional ManejaPrecioPorCliente As Boolean = False)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, IdSurtidor)
        DB.AddInParameter(DatabaseCommand, "AliasCara", DbType.Int32, AliasCara)
        DB.AddInParameter(DatabaseCommand, "ManejaCincoDigitos", DbType.Boolean, ManejaCincoDigitos)
        DB.AddInParameter(DatabaseCommand, "ManejaPrecioPorCliente", DbType.Boolean, ManejaPrecioPorCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCara(ByVal idCara As Int16, ByVal idLector As Int32, ByVal Estado As Boolean, ByVal IdSurtidor As Int32, ByVal AliasCara As Int32, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, IdSurtidor)
        DB.AddInParameter(DatabaseCommand, "AliasCara", DbType.Int32, AliasCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMangueraFullStation(ByVal idManguera As Int32, ByVal idCara As Int32, ByVal idProducto As Int16, ByVal Grado As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Grado", DbType.Int32, Grado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMangueraFullStation(ByVal idManguera As Int32, ByVal idCara As Int32, ByVal idProducto As Int16, ByVal Grado As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Grado", DbType.Int32, Grado)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMangueraFullStation(ByVal idManguera As Int32, ByVal idCara As Int32, ByVal idProducto As Int16, ByVal Grado As Int32, ByVal idTanque As Nullable(Of Int32))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Grado", DbType.Int32, Grado)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, idTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMangueraFullStation(ByVal idManguera As Int32, ByVal idCara As Int32, ByVal idProducto As Int16, ByVal Grado As Int32, ByVal idTanque As Nullable(Of Int32), ByVal EsActiva As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Grado", DbType.Int32, Grado)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, idTanque)
        DB.AddInParameter(DatabaseCommand, "EsActiva", DbType.Boolean, EsActiva)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMangueraFullStation(ByVal idManguera As Int32, ByVal idCara As Int32, ByVal idProducto As Int16, ByVal Grado As Int32, ByVal idTanque As Nullable(Of Int32), ByVal EsActiva As Boolean, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Grado", DbType.Int32, Grado)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, idTanque)
        DB.AddInParameter(DatabaseCommand, "EsActiva", DbType.Boolean, EsActiva)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteCara(ByVal idCara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                If DB.ExecuteScalar(DatabaseCommand).ToString = "1" Then
                    Return True
                Else
                    Return False
                End If
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ExisteCara(ByVal idCara As Int16, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                If DB.ExecuteScalar(DatabaseCommand).ToString = "1" Then
                    Return True
                Else
                    Return False
                End If
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsActivaRedFidelizacion(ByVal idRed As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsActivaRedFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, idRed)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteVentaParcial(ByVal idCara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function TieneStocksTurnoHorario(ByVal IdTurno As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "TieneStocksTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function TieneExistenciasProducto(ByVal IdManguera As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "TieneExistenciasProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function TieneExistenciasProducto(ByVal IdManguera As Int16, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "TieneExistenciasProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function FinalizoConsignacionesSobres(ByVal IdTurno As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FinalizoConsignacionesSobres"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarCaraConsumoInterno(ByVal idCara As Int16) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCaraConsumoInterno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCara(ByVal idCara As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCaraPorTiquete(ByVal recibo As Int64) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaraPorTiquete"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpresoraPorTiquete(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorTiquete"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpresoraPorTiqueteChile(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorTiquete"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarImpresoraPorTiquete(ByVal recibo As Int64, ByVal IdEstacion As Integer, Optional ByVal esVentaRegistrada As Boolean = True) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorTiquete"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function






    Public Function RecuperarCantidadCaras() As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CShort(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCantidadCaras(ByVal IdEstacion As Int16) As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CShort(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarCaras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCaras(ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasManguerasPorTurno(ByVal turno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasManguerasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasManguerasPorTurno(ByVal turno As Int32, ByVal idSurtidor As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasManguerasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, turno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarLecturasManguerasPorTurno(ByVal turno As Int32, ByVal idSurtidor As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasManguerasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, turno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasPorMangueraFecha(ByVal idManguera As Int32, ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorMangueraFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasPorMangueraFechaDia(ByVal idManguera As Int32, ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorMangueraFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarLecturasPorMangueraFechaDia(ByVal idManguera As Int32, ByVal fecha As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorMangueraFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesComplementariosPorFecha(ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesComplementariosPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesComplementariosPorFecha(ByVal fecha As String, ByVal EsCombustible As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesComplementariosPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "EsCombustible", DbType.Boolean, EsCombustible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesComplementariosPorFecha(ByVal fecha As String, ByVal EsCombustible As Boolean, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesComplementariosPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "EsCombustible", DbType.Boolean, EsCombustible)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesComplementariosPorFechaDia(ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesComplementariosPorFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesComplementariosPorFechaDia(ByVal fecha As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesComplementariosPorFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesPorFecha(ByVal fecha As String, ByVal producto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecargasPrepagoPorDia(ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecargasPrepagoPorDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesPorFecha(ByVal fecha As String, ByVal producto As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesPorFechaDia(ByVal fecha As String, ByVal producto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesPorFechaDia(ByVal fecha As String, ByVal producto As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesPorFechaFormaPago(ByVal fecha As String, ByVal producto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFechaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesPorFechaFormaPago(ByVal fecha As String, ByVal producto As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFechaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesPorFechaFormaPagoDia(ByVal fecha As String, ByVal producto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFechaFormaPagoDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesPorFechaFormaPagoDia(ByVal fecha As String, ByVal producto As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorFechaFormaPagoDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesVentasFechaFormaPago(ByVal fecha As String, ByVal idFormaPago As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesVentasFechaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "DisplayCara"
    Public Function RecuperarCarasDisplay() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarasDisplay"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub ActualizarEstadoCaraDisplay(ByVal cara As Int32, ByVal estado As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoCaraDisplay"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, cara)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.String, estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarPropiedadesCaraDisplay(ByVal cara As Int32, ByVal estado As String, ByVal valor As Double, ByVal volumen As Double, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPropiedadesCaraDisplay"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, cara)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.String, estado)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Volumen", DbType.Double, volumen)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarEstadoTurnoCaraDisplay(ByVal surtidores As String, ByVal estadoTurno As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoTurnoCaraDisplay"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, 0)
        DB.AddInParameter(DatabaseCommand, "EstadoTurno", DbType.String, estadoTurno)

        Dim surtidoresA() As String
        Dim surtidorActual, caraInferior, caraSuperior As String

        Dim i As Integer
        surtidoresA = surtidores.Split(CChar("|"))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            For i = 0 To surtidoresA.Length() - 1
                surtidorActual = surtidoresA(i)
                If Not String.IsNullOrEmpty(surtidorActual) Then
                    caraInferior = ((2 * Int32.Parse(surtidorActual)) - 1).ToString()
                    caraSuperior = ((2 * Int32.Parse(surtidorActual))).ToString()

                    Try
                        'Ejecuta el Procedimiento Almacenado
                        DB.SetParameterValue(DatabaseCommand, "Cara", Int32.Parse(caraInferior))
                        DB.ExecuteNonQuery(DatabaseCommand)

                        DB.SetParameterValue(DatabaseCommand, "Cara", Int32.Parse(caraSuperior))
                        DB.ExecuteNonQuery(DatabaseCommand)
                    Catch ex As Exception
                        Throw 
                    Finally
                        connection.Close()
                    End Try

                End If
            Next i
        End Using
    End Sub
    Public Sub ActualizarPrecioCaraDisplay(ByVal cara As Int32, ByVal precio As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPrecioCaraDisplay"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, cara)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarEstadoPlacaCaraDisplay(ByVal cara As Int32, ByVal estado As String, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoPlacaCaraDisplay"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, cara)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.String, estado)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Pago Extraordinario"
    Public Sub CargarBackup(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarBackup"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CargarBackupCDIGas(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarBackupCDIGas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CargarBackupCombustible(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarBackupCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    'Public Sub EjecutarScriptActualizacion(ByVal script As String, ByVal usuario As String, ByVal clave As String, ByVal tiempoEsperaSQL As Int32, ByVal BD As String)
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    Dim Transaccion As System.Data.Common.DbTransaction = Nothing

    '    script = script.Replace("GO", "~")

    '    Dim SQL() As String = script.Split(CChar("~"))

    '    Dim SqlCommand As String = "EjecutarScript"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
    '    DB.AddInParameter(DatabaseCommand, "SQL", DbType.String)

    '    DatabaseCommand.CommandTimeout = tiempoEsperaSQL

    '    Using connection As DbConnection = DB.CreateConnection()
    '        Dim factory As New DbConnectionStringBuilder
    '        factory.ConnectionString = connection.ConnectionString
    '        If factory.ContainsKey("user id") Then
    '            factory.Item("user id") = usuario
    '        Else
    '            factory.Add("user id", usuario)
    '        End If

    '        If factory.ContainsKey("password") Then
    '            factory.Item("password") = clave
    '        Else
    '            factory.Add("password", clave)
    '        End If

    '        factory.Item("Integrated security") = False
    '        factory.Item("database") = BD

    '        connection.ConnectionString = factory.ConnectionString
    '        connection.Open()
    '        Try
    '            Using tranScope As New Transactions.TransactionScope()
    '                For I As Integer = 0 To UBound(SQL)
    '                    DB.SetParameterValue(DatabaseCommand, "SQL", SQL(I))
    '                    DB.ExecuteNonQuery(DatabaseCommand)
    '                Next

    '                tranScope.Complete()
    '            End Using
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Sub

    Public Sub EjecutarScriptActualizacion(ByVal script As String, ByVal usuario As String, ByVal clave As String, ByVal tiempoEsperaSQL As Int32, ByVal BD As String)
        'Crea el objeto base de datos, esto representa la czzonexion a la base de datos indicada en el archivo de configuracion
        Dim DBFactory As Database = DatabaseFactory.CreateDatabase()

        Dim factory As New DbConnectionStringBuilder
        factory.ConnectionString = DBFactory.ConnectionStringWithoutCredentials
        If factory.ContainsKey("user id") Then
            factory.Item("user id") = usuario
        Else
            factory.Add("user id", usuario)
        End If

        If factory.ContainsKey("password") Then
            factory.Item("password") = clave
        Else
            factory.Add("password", clave)
        End If

        factory.Item("Integrated security") = False
        factory.Item("database") = BD

        Dim DB As Sql.SqlDatabase = New Sql.SqlDatabase(factory.ConnectionString)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing

        script = script.Replace(Chr(10) & "GO", "~")
        'script = script.Replace(Chr(13), " ")

        Dim SQL() As String = script.Split(CChar("~"))

        Dim SqlCommand As String = ""
        Dim DatabaseCommand As DbCommand

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                Using tranScope As New Transactions.TransactionScope()
                    For I As Integer = 0 To UBound(SQL)
                        If Not String.IsNullOrEmpty(SQL(I)) Then
                            DatabaseCommand = DB.GetSqlStringCommand(SQL(I))
                            DatabaseCommand.CommandTimeout = tiempoEsperaSQL
                            DB.ExecuteNonQuery(DatabaseCommand)
                        End If
                    Next

                    tranScope.Complete()
                End Using
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarLecturasParaArchivo(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Finicio", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "Ffin", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReversionesParaArchivo(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReversionesParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Finicio", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "Ffin", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPagosParaArchivo(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPagosParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Finicio", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "Ffin", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExportarRazonSocial() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExportarRazonSocial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarVentasParaArchivo(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Finicio", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "Ffin", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasFidelizadasParaArchivo(ByVal fInicio As DateTime, ByVal fFin As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasFidelizadasParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasFidelizadasParaArchivo(ByVal fInicio As DateTime, ByVal fFin As DateTime, ByVal TimeOut As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasFidelizadasParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = TimeOut

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarVentasGenexParaArchivo(ByVal fInicio As DateTime, ByVal fFin As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasGenexParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarVentasGenexParaArchivo(ByVal fInicio As DateTime, ByVal fFin As DateTime, ByVal TimeOut As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasGenexParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = TimeOut

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPGNVentasDiarias(ByVal fInicio As DateTime, ByVal fFin As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPGNVentasDiarias"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarPGNVentasDiarias(ByVal fInicio As DateTime, ByVal fFin As DateTime, ByVal TimeOut As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPGNVentasDiarias"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = TimeOut

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function RecuperarVentasFidelizadasBonoParaArchivo(ByVal fInicio As DateTime, ByVal fFin As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasFidelizadasBonoParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarVentasFidelizadasBonoParaArchivo(ByVal fInicio As DateTime, ByVal fFin As DateTime, ByVal TimeOut As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasFidelizadasBonoParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = TimeOut

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionPago(ByVal pago As Int32) As InformacionPago
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                Dim SqlCommand As String = "RecuperarPagoExtraOrdinario"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Pago", DbType.Int32, pago)

                'Ejecuta el Procedimiento Almacenado
                Dim DatosPago As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If DatosPago.Read Then
                    Dim oInfo As New InformacionPago
                    oInfo.FechaTurno = DatosPago("FechaTurno").ToString
                    oInfo.Fecha = DatosPago("Fecha").ToString
                    oInfo.IdTurno = CInt(DatosPago("IdTurno").ToString)
                    oInfo.Codigo = DatosPago("Codigo").ToString
                    oInfo.Placa = DatosPago("Placa").ToString
                    oInfo.Valor = DatosPago("Valor").ToString
                    oInfo.CodEstacion = DatosPago("CodEstacion").ToString
                    oInfo.GUIDPago = DatosPago("GUIDPago").ToString
                    oInfo.CedulaEmpleado = DatosPago("Cedula").ToString
                    oInfo.EsAnulado = Convert.ToBoolean(DatosPago("EsAnulado"))
                    oInfo.EstadoPagoExtraordinario = Convert.ToByte(DatosPago("Estado"))

                    If DatosPago("IdCredito") Is System.DBNull.Value Then
                        oInfo.IdCredito = String.Empty
                    Else
                        oInfo.IdCredito = DatosPago("IdCredito").ToString
                    End If

                    DatosPago.Close()
                    connection.Close()
                    Return oInfo
                End If
                DatosPago.Close()
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                    connection.Dispose
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionPagoSRE(ByVal pago As Int32) As InformacionPago
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Dim SqlCommand As String = "RecuperarInformacionPagoSRE"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Pago", DbType.Int32, pago)

                'Ejecuta el Procedimiento Almacenado
                Dim DatosPago As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If DatosPago.Read Then
                    Dim oInfo As New InformacionPago
                    If Not DatosPago("IdRecaudoCDC") Is System.DBNull.Value Then
                        oInfo.IdRecaudoCDC = CInt(DatosPago("IdRecaudoCDC").ToString)
                    Else
                        oInfo.IdRecaudoCDC = Nothing
                    End If

                    oInfo.Fecha = DatosPago("Fecha").ToString
                    oInfo.IdTurno = CInt(DatosPago("IdTurno").ToString)
                    oInfo.Placa = DatosPago("Placa").ToString
                    oInfo.Valor = DatosPago("Valor").ToString
                    oInfo.CedulaEmpleado = DatosPago("Cedula").ToString
                    oInfo.EstadoPagoExtraordinario = Convert.ToByte(DatosPago("Estado"))

                    If Not DatosPago("Movil") Is System.DBNull.Value Then
                        oInfo.Movil = CInt(DatosPago("Movil").ToString)
                    Else
                        oInfo.Movil = Nothing
                    End If

                    If Not DatosPago("IdConcepto") Is System.DBNull.Value Then
                        oInfo.IdConcepto = CInt(DatosPago("IdConcepto").ToString)
                    Else
                        oInfo.IdConcepto = Nothing
                    End If

                    If Not DatosPago("Concepto") Is System.DBNull.Value Then
                        oInfo.Concepto = DatosPago("Concepto").ToString
                    Else
                        oInfo.Concepto = Nothing
                    End If

                    oInfo.IdEmpresa = CInt(DatosPago("IdEmpresa").ToString)
                    oInfo.Empresa = DatosPago("Empresa").ToString
                    oInfo.NitEmpresa = DatosPago("NitEmpresa").ToString
                    oInfo.IdPagoEmpresa = CInt(DatosPago("IdPagoEmpresa").ToString)

                    oInfo.NroTarjeta = DatosPago("NroTarjeta").ToString
                    oInfo.NroSeguridad = DatosPago("NroSeguridad").ToString
                    oInfo.TipoLectura = CInt(DatosPago("TipoLectura").ToString)

                    oInfo.Recibo = CLng(DatosPago("Recibo").ToString)

                    DatosPago.Close()
                    connection.Close()
                    Return oInfo
                End If
                DatosPago.Close()
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                    connection.Dispose()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarVentasModificadas() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasModificadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasModificadas(ByVal CDC As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasModificadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasCanastillaModificadas(ByVal CDC As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasCanastillaModificadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaModificada(ByVal recibo As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaModificada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarVentaFormaPago(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarVentaCanastillaFormaPago(ByVal recibo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaCanastillaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPago(ByVal pago As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Pago", DbType.Int32, pago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarPago(ByVal pago As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Pago", DbType.Int32, pago)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub AnularPagoExtraordinario(ByVal idPago As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AnularPagoExtraordinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, idPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Sub AnularPagoExtraordinario(ByVal idPago As Int32, ByVal IdEstacion As Short)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AnularPagoExtraordinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, idPago)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function EsPagoExtraordinarioAnulado(ByVal idPago As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsPagoExtraordinarioAnulado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, idPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
    Public Function EsPagoExtraordinarioAnulado(ByVal idPago As Int32, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsPagoExtraordinarioAnulado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, idPago)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function ValidarPagosAFinanciera(ByVal idFinanciera As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPagosAFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function ValidarMinimoTanqueoParaAbonar(ByVal recibo As Int64, ByVal cedula As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarMinimoTanqueoParaAbonar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
    Public Function ValidarMinimoTanqueoParaAbonar(ByVal recibo As Int64, ByVal cedula As String, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarMinimoTanqueoParaAbonar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function



    Public Sub ProcesarPagoExtraOrdinarioPendiente(ByVal idPago As Int32)
        Try
            'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
            Dim DB As Database = DatabaseFactory.CreateDatabase()

            Using connection As DbConnection = DB.CreateConnection()
                connection.Open()

                Try
                    'Crea un sqlComand a partir del nombre del procedimiento almacenado
                    Dim SqlCommand As String = "ProcesarPagoExtraOrdinarioPendiente"
                    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                    DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, idPago)

                    'Ejecuta el Procedimiento Almacenado
                    DB.ExecuteNonQuery(DatabaseCommand)
                Catch
                    Throw
                Finally
                    connection.Close()
                End Try
            End Using
        Catch ex As SqlClient.SqlException
            Throw 
        Catch ex As Exception
            Throw 
        End Try
    End Sub
    Public Sub ProcesarPagoExtraOrdinarioPendiente(ByVal idPago As Int32, ByVal idEstacion As Int16)
        Try
            'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
            Dim DB As Database = DatabaseFactory.CreateDatabase()

            Using connection As DbConnection = DB.CreateConnection()
                connection.Open()

                Try
                    'Crea un sqlComand a partir del nombre del procedimiento almacenado
                    Dim SqlCommand As String = "ProcesarPagoExtraOrdinarioPendiente"
                    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                    DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, idPago)
                    DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
                    'Ejecuta el Procedimiento Almacenado
                    DB.ExecuteNonQuery(DatabaseCommand)
                Catch
                    Throw
                Finally
                    connection.Close()
                End Try
            End Using
        Catch ex As SqlClient.SqlException
            Throw 
        Catch ex As Exception
            Throw 
        End Try
    End Sub
#End Region

#Region "Reversiones"
    Public Function ValidarReversionesAFinanciera(ByVal idFinanciera As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarReversionesAFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
#End Region

#Region "Configuracion"
    Public Sub ActualizarSincronizacion(ByVal tabla As String, ByVal valor As String, ByVal CDC As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "ActualizarSincronizacion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)
                DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)
                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub ActualizarSincronizacionCRM(ByVal tabla As String, ByVal valor As String, ByVal CDC As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "ActualizarSincronizacionCRM"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)
                DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)
                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarSincronizacion(ByVal tabla As String, ByVal valor As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "ActualizarSincronizacion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)
                DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub ActualizarSincronizacionMexico(ByVal tabla As String, ByVal valor As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "ActualizarSincronizacionMexico"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)
                DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarSincronizacion(ByVal CDC As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)


                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function




    Public Function RecuperarSincronizacionCRM(ByVal CDC As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacionCRM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)


                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarSincronizacion(ByVal CDC As Integer, ByVal IdEstacion As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function


    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarSincronizacion() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarSincronizacionMexico() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacionMexico"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSincronizaciones() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSincronizaciones(ByVal CDC As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCDCS() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMensajesNoControlados(ByVal cantidad As Decimal, ByVal operacion As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajesNoControlados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Operacion", DbType.Int64, operacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarMensajesNoControlados(ByVal cantidad As Decimal, ByVal operacion As Int64, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajesNoControlados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Operacion", DbType.Int64, operacion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMensajesNoControladosPorRecibo(ByVal Recibo As Int64, ByVal operacion As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajesNoControladosPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Operacion", DbType.Int64, operacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarMensajesNoControladosPorRecibo(ByVal Recibo As Int64, ByVal operacion As Int64, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajesNoControladosPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Operacion", DbType.Int64, operacion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarResolucionPrepago() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarResolucionPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConfiguracionParametros() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguracionParametros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConfiguracionParametros(ByVal Estacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguracionParametros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, Estacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConfiguracion() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Cargo"
    Public Sub InsertarCargo(ByVal cargo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCargo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cargo", DbType.String, cargo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarCargo(ByVal idCargo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCargo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarCargo(ByVal idCargo As Int32, ByVal cargo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCargo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Cargo", DbType.String, cargo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarCargo(ByVal idCargo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCargo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCargos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCargos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTipoEmpleados() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoEmpleados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCentrosInformacion() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCentrosInformacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Cliente"
    Public Sub InsertarCliente(ByVal nuip As String, ByVal nombre As String, ByVal direccion As String, ByVal telefono As String, ByVal idFormaPago As Int16, ByVal idCiudad As Int32, ByVal precio As Decimal, ByVal descuento As Decimal, ByVal Contacto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, nuip)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Descuento", DbType.Decimal, descuento)
        DB.AddInParameter(DatabaseCommand, "Contacto", DbType.String, Contacto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarClientesBuscar() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClientesBuscar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarClientePorIdentificacion(ByVal Identificacion As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClientePorIdentificacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Identificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarClientePorId(ByVal idCliente As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClientePorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub EliminarCliente(ByVal idCliente As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarCliente(ByVal nuip As String, ByVal nombre As String, ByVal direccion As String, ByVal telefono As String, ByVal idFormaPago As Int16, ByVal idCiudad As Int32, ByVal precio As Decimal, ByVal descuento As Decimal, ByVal Contacto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, nuip)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Descuento", DbType.Decimal, descuento)
        DB.AddInParameter(DatabaseCommand, "Contacto", DbType.String, Contacto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteCliente(ByVal nuip As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, nuip)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function ExisteRomEnVentaParcial(ByVal rom As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteRomEnVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ExisteClienteLocal(ByVal nuip As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, nuip)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarExisteClienteLocal(ByVal DNI As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarExisteClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "DNI", DbType.String, DNI)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCliente(ByVal nuip As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, nuip)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarClientes() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClientes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarPrecioCliente(ByVal placa As String) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioPorCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDbl(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarPrecioProductoMangueraCliente(ByVal IdProducto As Integer, ByVal IdManguera As Integer, ByVal ROM As String) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioProductoMangueraCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)
        DB.AddInParameter(DatabaseCommand, "ROM ", DbType.String, ROM)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDbl(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarPrecioCliente(ByVal placa As String, ByVal Idestacion As Int16) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioPorCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, Idestacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDbl(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdClientePorRecibo(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdClientePorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand).ToString)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIdClientePorRecibo(ByVal recibo As Int64, ByVal idEstacion As Int16, Optional ByVal esVentaRegistrada As Boolean = True) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdClientePorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand).ToString)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Departamento"
    Public Sub InsertarDepartamento(ByVal nombre As String, ByVal codigo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDepartamento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarDepartamento(ByVal idDpto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarDepartamento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarDepartamento(ByVal idDpto As Int32, ByVal nombre As String, ByVal codigo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDepartamento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarDepartamento(ByVal idDpto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDepartamento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDepartamentos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDepartamentos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Empleado"
    Public Sub InsertarEmpleado(ByVal documento As String, ByVal nombre As String, ByVal codigo As String, ByVal direccion As String, ByVal telefono As String, ByVal idCargo As Int32, ByVal estado As Int32, ByVal idCiudad As Int32, ByVal clave As String, ByVal Usuario As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, estado)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Usuario", DbType.String, Usuario)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarEmpleado(ByVal documento As String, ByVal nombre As String, ByVal codigo As String, ByVal direccion As String, ByVal telefono As String, ByVal idCargo As Int32, ByVal estado As Int32, ByVal idCiudad As Int32, ByVal clave As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, estado)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarEmpleadoTipo(ByVal documento As String, ByVal nombre As String, ByVal codigo As String, ByVal direccion As String, ByVal telefono As String, ByVal idCargo As Int32, ByVal estado As Int32, ByVal idCiudad As Int32, ByVal clave As String, ByVal IdTipoEmpleado As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, estado)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        If Not IdTipoEmpleado Is Nothing And IdTipoEmpleado <> "" Then
            DB.AddInParameter(DatabaseCommand, "IdTipoEmpleado", DbType.Int16, CShort(IdTipoEmpleado))
        End If

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarEmpleado(ByVal idEmpleado As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, idEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarEmpleado(ByVal documento As String, ByVal nombre As String, ByVal codigo As String, ByVal direccion As String, ByVal telefono As String, ByVal idCargo As Int32, ByVal estado As Int32, ByVal idCiudad As Int32, ByVal clave As String, ByVal Usuario As String, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, estado)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Usuario", DbType.String, Usuario)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEmpleadoTipo(ByVal documento As String, ByVal nombre As String, ByVal codigo As String, ByVal direccion As String, ByVal telefono As String, ByVal idCargo As Int32, ByVal estado As Int32, ByVal idCiudad As Int32, ByVal clave As String, ByVal IdTipoEmpleado As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, estado)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        If Not IdTipoEmpleado Is Nothing And IdTipoEmpleado <> "" Then
            DB.AddInParameter(DatabaseCommand, "IdTipoEmpleado", DbType.Int16, CShort(IdTipoEmpleado))
        End If


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEmpleado(ByVal documento As String, ByVal nombre As String, ByVal codigo As String, ByVal direccion As String, ByVal telefono As String, ByVal idCargo As Int32, ByVal estado As Int32, ByVal idCiudad As Int32, ByVal clave As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, estado)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEmpleado(ByVal documento As String, ByVal nombre As String, ByVal codigo As String, ByVal direccion As String, ByVal telefono As String, ByVal idCargo As Int32, ByVal estado As Int32, ByVal idCiudad As Int32, ByVal clave As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, estado)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Function ExisteEmpleado(ByVal documento As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteEmpleado(ByVal documento As String, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteEmpleado(ByVal IdEmpleado As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteEmpleadoGazel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    




    Public Function ExisteEmpleado(ByVal IdEmpleado As Integer, ByVal IdEstacion As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteEmpleadoGazel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteEmpleadoDocumento(ByVal documento As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteEmpleadoCedula"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleados(ByVal documento As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorCedula"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleadosCDC(ByVal CDC As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadosCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int16, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleado(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorCedula"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarEmpleado(ByVal documento As String, ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorCedula"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleadoPorReciboVenta(ByVal Recibo As Int64) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorReciboVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleados() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarEmpleados(ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "Estacion"

    Public Sub InsertarEstacion(ByVal codigo As String, ByVal nombre As String, ByVal nit As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32, ByVal IdTipoEds As Int32, ByVal ManejaLeyFrontera As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.Double, nit)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "IdTipoEds", DbType.Int32, IdTipoEds)
        DB.AddInParameter(DatabaseCommand, "ManejaLeyFrontera", DbType.Boolean, ManejaLeyFrontera)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarEstacion(ByVal codigo As String, ByVal nombre As String, ByVal nit As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32, ByVal CodigoEstacionMenoCash As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.Double, nit)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "CodigoEstacionMenoCash", DbType.String, CodigoEstacionMenoCash)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarEstacion(ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstacion(ByVal idEstacion As Int16, ByVal codigo As String, ByVal nombre As String, ByVal nit As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32, ByVal CodigoMenoCash As String, Optional ByVal RazonSocial As String = "")
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, nit)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "CodigoEstacionMenoCash", DbType.String, CodigoMenoCash)
        If Not String.IsNullOrEmpty(RazonSocial) Then
            DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        End If


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstacion(ByVal idEstacion As Int16, ByVal codigo As String, ByVal nombre As String, ByVal nit As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32, NumeroRegistro As String, RepresentanteLegal As String, IdRepresentanteLegal As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, nit)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "NumeroRegistro", DbType.String, NumeroRegistro)
        DB.AddInParameter(DatabaseCommand, "RepresentanteLegal", DbType.String, RepresentanteLegal)
        DB.AddInParameter(DatabaseCommand, "IdRepresentanteLegal", DbType.String, IdRepresentanteLegal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstacionFSPeru(ByVal idEstacion As Int16, ByVal codigo As String, ByVal nombre As String, ByVal nit As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32, ByVal TipoDeCambio As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, nit)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "TipoDeCambio", DbType.Decimal, TipoDeCambio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarFormasPago(ByVal idFormaPago As Int32, ByVal NumeroCopiasLiquido As Integer, ByVal NumeroCopiasCanastilla As Integer, ByVal EsActivo As Boolean, ByVal Descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormasPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Id", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "NumeroCopiasLiquido", DbType.Int32, NumeroCopiasLiquido)
        DB.AddInParameter(DatabaseCommand, "NumeroCopiasCanastilla", DbType.Int32, NumeroCopiasCanastilla)        
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub ActualizarFormasPago(ByVal idFormaPago As Int32, ByVal FirmaMensaje As Boolean, ByVal EsActivo As Boolean, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormasPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Id", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "FirmaMensaje", DbType.Boolean, FirmaMensaje)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarFormasPago(ByVal idFormaPago As Int32, ByVal FirmaMensaje As Boolean, ByVal EsActivo As Boolean, ByVal AplicaPagoExtraordinario As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormasPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Id", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "FirmaMensaje", DbType.Boolean, FirmaMensaje)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "AplicaPagoExtraordinario", DbType.Boolean, AplicaPagoExtraordinario)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstacionMexico(ByVal idEstacion As Int16, ByVal codigo As String, ByVal nombre As String, ByVal nit As String, ByVal direccion As String, ByVal direccionFiscal As String, ByVal telefono As String, ByVal idCiudad As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, nit)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "DireccionFiscal", DbType.String, direccionFiscal)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarEstacion(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Corregido Para Uso Eficiente del Pool de Conexiones
    Public Function RecuperarEstaciones() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstaciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarEstacionesPorId(ByVal IdEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstacionesPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarEstacionConfigurador() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstacionConfigurador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
#End Region

#Region "EnvioVentaReporte"
    Public Function RecuperarVentaDetalladaReporte(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime, ByVal Filtro As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaDetalladaEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Filtro", DbType.Int16, Filtro)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaDiariaReporte(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime, ByVal Filtro As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaDiariaEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Filtro", DbType.Int16, Filtro)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaDiariaPorMangueraReporte(ByVal Fecha As DateTime, ByVal Filtro As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasTurnoPorDiaEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)
        DB.AddInParameter(DatabaseCommand, "Filtro", DbType.Int16, Filtro)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaDiariaPorManguerayTurnoReporte(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime, ByVal Filtro As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasTurnoHorarioPorDiaEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Filtro", DbType.Int16, Filtro)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaFidelizadaReporte(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime, ByVal NumeroTarjeta As String, ByVal Filtro As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaFidelizadaEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "NumTarjeta", DbType.String, NumeroTarjeta)
        DB.AddInParameter(DatabaseCommand, "Filtro", DbType.Int16, Filtro)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaMensualesReporte(ByVal MesInicial As DateTime, ByVal MesFinal As DateTime, ByVal Filtro As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasMensualesEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "MesInicial", DbType.DateTime, MesInicial)
        DB.AddInParameter(DatabaseCommand, "MesFinal", DbType.DateTime, MesFinal)
        DB.AddInParameter(DatabaseCommand, "Filtro", DbType.Int16, Filtro)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaClienteReporte(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime, ByVal Cedula As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorClienteEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaVehiculoReporte(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime, ByVal Placa As String, ByVal Filtro As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorVehiculoEnvioReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Filtro", DbType.Int16, Filtro)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarVentaReporteFullStation(ByVal Recibo As Int64) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasReporteFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarLecturasReporteFullStation(ByVal IdLectura As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasReporteFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "IdLectura", DbType.Int32, IdLectura)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
#End Region

#Region "FormaPago"
    Public Sub InsertarFormaPago(ByVal descripcion As String, ByVal numeroCopiasRecibo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "NumeroCopiasRecibo", DbType.Int32, numeroCopiasRecibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarFormaPago(ByVal idFormaPago As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarFormaPago(ByVal idFormaPago As Int16, ByVal descripcion As String, ByVal numeroCopiasRecibo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "NumeroCopiasRecibo", DbType.Int32, numeroCopiasRecibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarFormaPago(ByVal idFormaPago As Int16, ByVal Incremento As Decimal, ByVal IdTipoIncremento As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPagoIncremento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Incremento", DbType.Decimal, Incremento)
        DB.AddInParameter(DatabaseCommand, "IdTipoIncremento", DbType.Int32, IdTipoIncremento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarFormaPago(ByVal idFormaPago As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Revisado para uso eficiente del Pool de Conexiones
    Public Function RecuperarFormasPago() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function


    Public Function RecuperarFormasPago(ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int64, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function



    Public Function RecuperarCaraPorReciboVenta(ByVal Recibo As Integer) As Byte
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaraPorReciboVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Byte

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CByte(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function




    'Revisado para uso eficiente del Pool de Conexiones
    Public Function RecuperarFormassPago() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormassPagos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function





    Public Sub ActualizarFormasPago(ByVal EsActivo As Boolean, ByVal EsMedioPago As Boolean, ByVal idFormaPago As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormasPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Id", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "EsMedioPago", DbType.Boolean, EsMedioPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarFormassPago(ByVal IdEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormassPagos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarFormasPagoVenta(ByVal recibo As Int64, ByVal esVentaRegistrada As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFormasPagoVenta(ByVal recibo As Int64, ByVal esVentaRegistrada As Boolean, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMediosPagoAbono(ByVal pago As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMediosPagoAbono"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Pago", DbType.Int32, pago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDescuentosVenta(ByVal recibo As Int64, ByVal esVentaRegistrada As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDescuentosVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarDescuentosEnVenta(ByVal recibo As Int64, ByVal esVentaRegistrada As Boolean) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDescuentosVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormasPagoVentaModificada(ByVal recibo As Int64, ByVal esVentaRegistrada As Boolean) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFormasPagoVentaModificada(ByVal recibo As Int64, ByVal esVentaRegistrada As Boolean, ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormasPagoFactura(ByVal consecutivo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFormasPagoFactura(ByVal consecutivo As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormasPagoReciboCanastilla(ByVal IdVenta As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoReciboCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int32, IdVenta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFormasPagoReciboCanastilla(ByVal IdVenta As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoReciboCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int32, IdVenta)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Revisada Uso de Pool de Conexiones
    Public Function RecuperarFormasPagoFacturaCDC(ByVal consecutivo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoFacturaCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisada Uso de Pool de Conexiones
    Public Function RecuperarFormasPagoVentaCanastillaCDC(ByVal recibo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoVentaCanastillaCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
#End Region
#Region "Identificador"
    Public Sub InsertarIdentificador(ByVal rom As Int32, ByVal idTipo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.Int32, rom)
        DB.AddInParameter(DatabaseCommand, "IdTipo", DbType.Int32, idTipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarIdentificador(ByVal idIdentificador As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarIdentificador(ByVal idIdentificador As Int32, ByVal rom As Int32, ByVal idTipo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.Int32, rom)
        DB.AddInParameter(DatabaseCommand, "IdTipo", DbType.Int32, idTipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarIdentificador(ByVal idIdentificador As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIdentificadores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "IdentificadorVehiculo"
    Public Sub InsertarIdentificadorVehiculo(ByVal activado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarIdentificadorVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Activado", DbType.Boolean, activado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarIdentificadorVehiculo(ByVal idVehiculo As Int32, ByVal idIdentificador As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarIdentificadorVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarIdentificadorVehiculo(ByVal idVehiculo As Int32, ByVal idIdentificador As Int32, ByVal activado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIdentificadorVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)
        DB.AddInParameter(DatabaseCommand, "Activado", DbType.Boolean, activado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarIdentificadorVehiculo(ByVal idVehiculo As Int32, ByVal idIdentificador As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIdentificadoresVehiculo() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorVehiculos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Impresora"
    Public Sub InsertarImpresora(ByVal descripcion As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarImpresora(ByVal descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub EliminarImpresora(ByVal idImpresora As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarConsecutivoImpresora(ByVal IdImpresoraConsecutivo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarConsecutivoImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresoraConsecutivo", DbType.Int32, IdImpresoraConsecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVentaImpresa(ByVal Recibo As Long)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVentaImpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarVentaImpresaReimpresion(ByVal Recibo As Long)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVentaImpresaReimpresion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVentaImpresa(ByVal Recibo As Long, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVentaImpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarImpresora(ByVal idImpresora As Int32, ByVal descripcion As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarImpresora(ByVal idImpresora As Int32, ByVal descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Function RecuperarImpresora(ByVal idImpresora As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpresorasParametrizacion() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresorasParametrizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpresoras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLeyendasNombreEmpleadoCanastilla() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLeyendasNombreEmpleadoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpresoras(ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





#End Region

#Region "Impresora Peru"
    Public Sub InsertarImpresoraPeru(ByVal descripcion As String, ByVal serial As String, ByVal prefijo As String, ByVal consecutivoDesde As Int32, ByVal consecutivoHasta As Int32, ByVal consecutivoActual As Int32, ByVal autorizacion As String, ByVal ConsecutivoBoleta As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoDesde", DbType.Int32, consecutivoDesde)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoHasta", DbType.Int32, consecutivoHasta)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoActual", DbType.Int32, consecutivoActual)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoBoleta", DbType.Int32, ConsecutivoBoleta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarImpresoraPeru(ByVal descripcion As String, ByVal serial As String, ByVal autorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarImpresoraChile(ByVal descripcion As String, ByVal serial As String, ByVal autorizacion As String, ByVal codigo As String, _
                                        ByVal TipoImpresora As Int32, ByVal NroCaja As String, Puerto As Nullable(Of Integer))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "TipoImpresora", DbType.Int32, TipoImpresora)
        DB.AddInParameter(DatabaseCommand, "NroCaja", DbType.String, NroCaja)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.Int32, Puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarImpresoraPeru(ByVal idImpresora As Int32, ByVal descripcion As String, ByVal serial As String, ByVal prefijo As String, ByVal consecutivoDesde As Int32, ByVal consecutivoHasta As Int32, ByVal consecutivoActual As Int32, ByVal autorizacion As String, ByVal ConsecutivoBoleta As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoDesde", DbType.Int32, consecutivoDesde)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoHasta", DbType.Int32, consecutivoHasta)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoActual", DbType.Int32, consecutivoActual)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoBoleta", DbType.Int32, ConsecutivoBoleta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarImpresoraPeru(ByVal idImpresora As Int32, ByVal descripcion As String, ByVal serial As String, ByVal autorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarImpresoraChile(ByVal idImpresora As Int32, ByVal descripcion As String, ByVal serial As String, ByVal autorizacion As String, ByVal codigo As String, _
                                         ByVal TipoImpresora As Int32, ByVal NroCaja As String, ByVal Puerto As Nullable(Of Integer))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "TipoImpresora", DbType.Int32, TipoImpresora)
        DB.AddInParameter(DatabaseCommand, "NroCaja", DbType.String, NroCaja)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.Int32, Puerto)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function CerrarDiaImpresora(ByVal serial As String, ByVal fechaActual As DateTime) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarDiaImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdImpresoraCierre As Int32

        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "FechaActual", DbType.DateTime, fechaActual)
        DB.AddOutParameter(DatabaseCommand, "IdImpresoraCierre", DbType.Int32, IdImpresoraCierre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdImpresoraCierre"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSerialImpresoraPorPuerto(ByVal puerto As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSerialImpresoraPorPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdCierreImpresoraPorFecha(ByVal serial As String, ByVal fecha As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdCierreImpresoraPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarHoraFinTurnoHorarioActual() As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHoraFinTurnoHorarioActual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarHoraFinTurnoHorarioActual(ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHoraFinTurnoHorarioActual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCierreImpresora(ByVal idImpresoraCierre As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCierreImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresoraCierre", DbType.Int32, idImpresoraCierre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCierreParcialImpresora(ByVal serial As String, ByVal fechaActual As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCierreParcialImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "FechaActual", DbType.DateTime, fechaActual)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesFormaPagoImpresora(ByVal idImpresoraCierre As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesFormaPagoImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresoraCierre", DbType.Int32, idImpresoraCierre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesProductosImpresora(ByVal idImpresoraCierre As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesProductosImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresoraCierre", DbType.Int32, idImpresoraCierre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesParcialesFormaPagoImpresora(ByVal serial As String, ByVal fechaActual As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesParcialesFormaPagoImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "FechaActual", DbType.DateTime, fechaActual)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesParcialesProductosImpresora(ByVal serial As String, ByVal fechaActual As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesParcialesProductosImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serial)
        DB.AddInParameter(DatabaseCommand, "FechaActual", DbType.DateTime, fechaActual)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPuertosImpresoras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertosImpresoras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Impuesto Peru"
    Public Sub InsertarImpuestoPeru(ByVal nombre As String, ByVal porcentaje As Double, ByVal formaAplicacion As String, ByVal activo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Porcentaje", DbType.Double, porcentaje)
        DB.AddInParameter(DatabaseCommand, "FormaAplicacion", DbType.String, formaAplicacion)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, activo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarImpuestoPeru(ByVal idImpuesto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpuesto", DbType.Int32, idImpuesto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarImpuestoPeru(ByVal idImpuesto As Int32, ByVal nombre As String, ByVal porcentaje As Double, ByVal formaAplicacion As String, ByVal activo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpuesto", DbType.Int32, idImpuesto)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Porcentaje", DbType.Double, porcentaje)
        DB.AddInParameter(DatabaseCommand, "FormaAplicacion", DbType.String, formaAplicacion)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, activo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarImpuestoChile(ByVal idImpuesto As Int32, ByVal valor As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpuesto", DbType.Int32, idImpuesto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarImpuestoPeru(ByVal idImpuesto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpuesto", DbType.Int32, idImpuesto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarImpuestosPeru() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpuestos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpuestosChile() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpuestos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub SincronizarImpuestosChileTerpel(ByVal IdImpuesto As Integer, ByVal Valor As Decimal, ByVal FechaHora As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarImpuestoChileTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpuesto", DbType.Int32, IdImpuesto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "FechaHora", DbType.DateTime, FechaHora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ValidarVentaContadoChilePorCara(ByVal Cara As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarUltimaVentaCaraChile"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, Cara)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function AplicaSolicitarMediosPago(ByVal Recibo As Long) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AplicaSolicitarMediosPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ValidarVentaContadoChilePorRecibo(ByVal Recibo As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarUltimaVentaPorReciboChile"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarFormaAplicacionPeru() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaAplicacionPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Isla"
    Public Sub InsertarIsla(ByVal cantidad As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.String, cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarIsla(ByVal cantidad As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.String, cantidad)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarIsla(ByVal idIsla As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, idIsla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarIsla(ByVal idIsla As Int16, ByVal idImpresora As Int32, ByVal surtidores As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, idIsla)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.Int32, surtidores)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarIsla(ByVal idIsla As Int16, ByVal idImpresora As Int32, ByVal surtidores As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, idIsla)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.Int32, surtidores)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarIsla(ByVal idIsla As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, idIsla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RegistrarInventarioPorTurno(ByVal Turno As Int32, isla As Int32, EsCierre As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarInventarioPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, isla)
        DB.AddInParameter(DatabaseCommand, "EsCierre", DbType.Boolean, EsCierre)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIslaPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslaPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIslas() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIslas(ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCantidadIslas() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadIslas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCantidadIslas(ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadIslas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Lector"
    Function RecuperarLectoresPorPuerto(ByVal idPuerto As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLectoresPorPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, idPuerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarLectoresPorPuerto(ByVal idPuerto As Int32, ByVal IdEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLectoresPorPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, idPuerto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarLector(ByVal rom As String, ByVal idOneWire As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdOneWire", DbType.Int32, idOneWire)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarLector(ByVal rom As String, ByVal idOneWire As Int32, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdOneWire", DbType.Int32, idOneWire)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarLector(ByVal idLector As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarLector(ByVal idLector As Int32, ByVal rom As String, ByVal idOneWire As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdOneWire", DbType.Int32, idOneWire)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarLector(ByVal idLector As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLector", DbType.Int32, idLector)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRedLector(ByVal rom As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CType(DB.ExecuteScalar(DatabaseCommand), Byte)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRedLector(ByVal rom As String, ByVal IdEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CType(DB.ExecuteScalar(DatabaseCommand), Byte)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarLectorPorCara(ByVal cara As Byte) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLectorPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarLectorPorCara(ByVal cara As Byte, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLectorPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarLectores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLectores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarLectores(ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLectores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Lectura"
    Public Function ValidarCredenciales(ByVal empleado As String, ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredenciales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarCredencialesTurnoAbierto(ByVal empleado As String, ByVal clave As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesTurnoAbierto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ValidarCredenciales(ByVal empleado As String, ByVal clave As String, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredenciales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarCredencialesConfigurador(ByVal empleado As String, ByVal clave As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesConfigurador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarEmpleadoAutoservicio(ByVal empleado As String, ByVal clave As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarEmpleadoAutoservicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function ValidarCredencialesporEstado(ByVal empleado As String, ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesporEstado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function InsertarLecturaFinal(ByVal cara As Byte, ByVal valor As Double) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaFinal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        Dim Turno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarLecturaFinal(ByVal idManguera As Integer, ByVal lectura As Decimal) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaFinal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, lectura)
        Dim Turno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function InsertarLecturaFinal(ByVal idManguera As Integer, ByVal lectura As Decimal, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaFinal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, lectura)
        Dim Turno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExistenCambiosPreciosEnTurno(ByVal IdTurno As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExistenCambiosPreciosEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ExistenCambiosPreciosEnTurno(ByVal IdTurno As Int32, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExistenCambiosPreciosEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExistenBloqueosMangueraEnTurno(ByVal IdTurno As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExistenBloqueosMangueraEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarLecturaInicial(ByVal idManguera As Integer, ByVal lectura As Decimal, ByVal precio As Decimal) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaInicial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, lectura)
        Dim Turno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function InsertarLecturaInicial(ByVal idManguera As Integer, ByVal lectura As Decimal, ByVal precio As Decimal, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaInicial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, lectura)
        Dim Turno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarLecturaInicial(ByVal cara As Byte, ByVal valor As Double) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaInicial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        Dim Turno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarLecturaInicial(ByVal idManguera As Integer, ByVal lectura As Decimal) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaInicial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, lectura)
        Dim Turno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarLectura(ByVal idLectura As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarLectura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLectura", DbType.Int32, idLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarLectura(ByVal idLectura As Int32, ByVal idTurno As Int32, ByVal idManguera As Int16, ByVal valorInicial As Double, ByVal valorFinal As Double, ByVal mecanicaInicial As Double, ByVal mecanicaFinal As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarLectura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLectura", DbType.Int32, idLectura)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "ValorInicial", DbType.Double, valorInicial)
        DB.AddInParameter(DatabaseCommand, "ValorFinal", DbType.Double, valorFinal)
        DB.AddInParameter(DatabaseCommand, "MecanicaInicial", DbType.Double, mecanicaInicial)
        DB.AddInParameter(DatabaseCommand, "MecanicaFinal", DbType.Double, mecanicaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Function RecuperarPuertoOneWirePorLector(ByVal lector As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertoOneWirePorLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Lector", DbType.String, lector)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRedSurtidores(ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedesSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarRedSurtidores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedesSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTipoSurtidores() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedesSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRedLectores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedLectores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarRedLectores(ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedLectores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarRedCapturadores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCapturadores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCaraLector() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCaraLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRedCapturadores(ByVal idEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCapturadores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEsatcion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCapturadores(ByVal IdTipoCapturador As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCapturadores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdTipoCapturador ", DbType.Int32, IdTipoCapturador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCapturadores() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCapturadores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarLectura(ByVal idLectura As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLectura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLectura", DbType.Int32, idLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarLecturas() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    ' Corregido para correcto uso del Pool de Conexiones
    Function RecuperarInformacionReversion(ByVal recibo As Int64) As InformacionReversion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarReversion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

                Dim DatosReversion As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If DatosReversion.Read Then
                    Dim oInfo As New InformacionReversion
                    oInfo.CodEstacion = DatosReversion("CodEstacion").ToString
                    oInfo.FechaTurno = DatosReversion("FechaTurno").ToString()
                    oInfo.FechaAbono = DatosReversion("FechaAbono").ToString()
                    oInfo.Recibo = CInt(DatosReversion("Recibo"))
                    oInfo.IdTurno = CInt(DatosReversion("IdTurno"))
                    oInfo.Codigo = DatosReversion("Codigo").ToString
                    oInfo.Valor = DatosReversion("Valor").ToString
                    oInfo.GuidVenta = DatosReversion("GuidVenta").ToString
                    oInfo.CedulaEmpleado = DatosReversion("Cedula").ToString
                    DatosReversion.Close()
                    connection.Close()
                    Return oInfo
                End If
                DatosReversion.Close()
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Function RecuperarReversion(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Function RecuperarReversion(ByVal recibo As Int64, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarReversionesPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReversionesPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarReversionesPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReversionesPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecaudosPorTurno(ByVal idTurno As Int32, ByVal idFinanciera As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecaudosPorTurno(ByVal idTurno As Int32, ByVal idFinanciera As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPagosPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPagosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarPagosPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPagosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTotalesProductosPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesProductosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarVentasPrepagoPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPrepagoPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTotalesPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesPorTurnoTrabajo(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesPorTurnoTrabajo(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCantidadCombustiblePorTurno(ByVal idTurno As Int32) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadVentasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasEnTurno(ByVal Cedula As String, ByVal Clave As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.Int32, Cedula)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.Int32, Clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarVentasEnTurno(ByVal Cedula As String, ByVal Clave As String, ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.Int32, Cedula)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.Int32, Clave)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarM3VendidosHoy() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarM3VendidosHoy"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarM3VendidosHoy(ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarM3VendidosHoy"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarTotalesPorTurnoFormaPago(ByVal idTurno As Int32, ByVal idFormaPago As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesPorTurnoFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesMediosPagoTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesMediosPagoPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesMediosPagoTurnoGazel(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesMediosPagosTurnosGAZEL"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesMediosPagoTurnoTerpel(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesMediosPagoPorTurnoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesMediosPagoTurnoTrabajoTerpel(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesMediosPagoTurnoTrabajoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesDescuentosPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesDescuentosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesTurnoFormaPagoProducto(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesTurnoFormaPagoProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesTurnoFormaPagoProductoCanastilla(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesTurnoFormaPagoProductoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesTurnoTrabajoFormaPagoProducto(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesTurnoTrabajoFormaPagoProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesComplementariosPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesComplementariosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCambiosChequeEnTurno(ByVal idTurno As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCambiosChequeEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasPorMangueraTurno(ByVal idTurno As Int32, ByVal idManguera As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorMangueraTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    'Corregido Para Correcto uso del Pool de Conexiones
    Public Function RecuperarIdreversion(ByVal recibo As Int64) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarIdreversion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
                Dim Resultado As Integer

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarIdreversion(ByVal recibo As Int64, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarIdreversion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
                Dim Resultado As Integer

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarInformacionLecturasPorTurno(ByVal turno As Int32) As InformacionLectura()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarLecturasPorTurno"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, turno)

                Dim DatosTurno As IDataReader = DB.ExecuteReader(DatabaseCommand)
                Dim oLecturas() As InformacionLectura
                Dim I As Integer = 0
                While DatosTurno.Read
                    Dim oLectura As New InformacionLectura
                    oLectura.CodEstacion = DatosTurno("CodEstacion").ToString
                    oLectura.Fecha = DatosTurno("Fecha").ToString()
                    oLectura.NumeroTurno = CShort(DatosTurno("NumeroTurno"))
                    oLectura.IdManguera = CShort(DatosTurno("IdManguera"))
                    oLectura.CedulaEmpleado = DatosTurno("Cedula").ToString
                    oLectura.ValorInicial = DatosTurno("ValorInicial").ToString
                    oLectura.ValorFinal = DatosTurno("ValorFinal").ToString()
                    oLectura.MecanicaInicial = DatosTurno("MecanicaInicial").ToString()
                    oLectura.MecanicaFinal = DatosTurno("MecanicaFinal").ToString()
                    oLectura.Precio = DatosTurno("Precio").ToString()
                    oLectura.IdTurno = CInt(DatosTurno("IdTurno").ToString())
                    ReDim Preserve oLecturas(I + 1)
                    I = I + 1
                    oLecturas(I) = oLectura
                End While
                DatosTurno.Close()
                connection.Close()
                Return oLecturas
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasPorTurno(ByVal turno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionMediosPagoAbono(ByVal Pago As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionMediosPagoAbono"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Pago", DbType.Int32, Pago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarUltimaLecturaGasStation() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaLecturaGasStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub InsertarLecturaGasStation(ByVal IdLectura As Int32, ByVal IdTurno As Int32, ByVal IdManguera As Int16, ByVal ValorInicial As Decimal, ByVal ValorFinal As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturaGasStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdLectura", DbType.Int32, IdLectura)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "ValorInicial", DbType.Decimal, ValorInicial)
        DB.AddInParameter(DatabaseCommand, "ValorFinal", DbType.Decimal, ValorFinal)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Manguera"
    Public Sub InsertarManguera(ByVal descripcion As String, ByVal idCara As Int16, ByVal idProducto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarMangueraFullStation(ByVal CantidadMangueras As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMangueraFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, CantidadMangueras)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarMangueraFullStation(ByVal CantidadMangueras As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMangueraFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, CantidadMangueras)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarManguera(ByVal idManguera As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarManguera(ByVal idManguera As Int16, ByVal descripcion As String, ByVal idCara As Int16, ByVal idProducto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarManguera(ByVal idManguera As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMangueras() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMangueras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarMangueras(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMangueras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarManguerasPorIsla(ByVal IdIsla As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90




        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, IdIsla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado				  
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManguerasPorTanque(ByVal codTanque As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarManguerasPorTanque(ByVal codTanque As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codTanque)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarManguerasConfigurador(ByVal idProducto As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasConfigurador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManguerasConfigurador(ByVal idProducto As Int32, ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasConfigurador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarCantidadMangueras() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadMangueras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCantidadMangueras(ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadMangueras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "Motivo"
    Public Sub InsertarMotivo(ByVal codigo As String, ByVal descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMotivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarMotivo(ByVal idCausal As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMotivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCausal", DbType.Int16, idCausal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarMotivo(ByVal idCausal As Int16, ByVal codigo As String, ByVal descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarMotivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCausal", DbType.Int16, idCausal)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarMotivo(ByVal idCausal As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMotivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCausal", DbType.Int16, idCausal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarMotivos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMotivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Municipio"
    Public Sub InsertarMunicipio(ByVal nombre As String, ByVal codigo As String, ByVal idDpto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMunicipio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarMunicipio(ByVal idCiudad As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMunicipio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarMunicipio(ByVal idCiudad As Int32, ByVal nombre As String, ByVal codigo As String, ByVal idDpto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarMunicipio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarMunicipio(ByVal idCiudad As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMunicipio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarMunicipios() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMunicipios"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMunicipiosPorDepartamento(ByVal idDpto As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMunicipiosPorDepartamento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "PrestadorServicio"
    Public Function RecuperarDatosPrestadorServicio() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosPrestadorServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDatosPrestadorServicio(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosPrestadorServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarPrestadorServicioActual() As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrestadorServicioActual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "Mensajes Canastilla"
    Public Function RecuperarMensajes() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMensajes(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "Producto"
    Public Sub InsertarProducto(ByVal nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarProducto(ByVal IdProducto As Int16, ByVal Nombre As String, ByVal SolicitarLectura As Boolean, ByVal Unidad As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "SolicitarLectura", DbType.Boolean, SolicitarLectura)
        DB.AddInParameter(DatabaseCommand, "Unidad", DbType.Int16, Unidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarProductoFullStationBolivia(ByVal IdProducto As Int16, ByVal Nombre As String, ByVal SolicitarLectura As Boolean, ByVal Unidad As Int16, ByVal Abreviatura As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "SolicitarLectura", DbType.Boolean, SolicitarLectura)
        DB.AddInParameter(DatabaseCommand, "Unidad", DbType.Int16, Unidad)
        DB.AddInParameter(DatabaseCommand, "Abreviatura", DbType.String, Abreviatura)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarProducto(ByVal IdProducto As Int16, ByVal Nombre As String, ByVal SolicitarLectura As Boolean, ByVal Unidad As Int16,
                                ByVal codigoContable As String, ByVal codigoTerpel As Nullable(Of Int64), ByVal CodigoMenoCash As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "SolicitarLectura", DbType.Boolean, SolicitarLectura)
        DB.AddInParameter(DatabaseCommand, "Unidad", DbType.Int16, Unidad)
        DB.AddInParameter(DatabaseCommand, "CodigoContable", DbType.String, codigoContable)
        DB.AddInParameter(DatabaseCommand, "CodigoTerpel", DbType.Int64, codigoTerpel)
        DB.AddInParameter(DatabaseCommand, "CodigoMenoCash", DbType.String, CodigoMenoCash)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarProducto(ByVal idProducto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarPrecioProducto(ByVal idProducto As Int32, ByVal precioNivel1 As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPrecioProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "PrecioNivel1", DbType.Double, precioNivel1)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarProducto(ByVal idProducto As Int32, ByVal nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarProducto(ByVal idProducto As Int32, ByVal solicitaLectura As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "SolicitaLectura", DbType.Boolean, solicitaLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarProducto(ByVal idProducto As Int32, ByVal solicitaLectura As Boolean, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "SolicitaLectura", DbType.Boolean, solicitaLectura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarProductoPorCodigo(ByVal codigo As Int32, ByVal Existencias As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductoPorCodigo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoProducto", DbType.Int32, codigo)
        DB.AddInParameter(DatabaseCommand, "Existencias", DbType.Boolean, Existencias)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductoPorCodigoCanastilla(ByVal codigo As Int32, ByVal Existencias As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductoPorCodigoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoProducto", DbType.Int32, codigo)
        DB.AddInParameter(DatabaseCommand, "Existencias", DbType.Boolean, Existencias)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductoConsumoCanastilla(ByVal codigo As Int32, ByVal Existencias As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductoConsumoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoProducto", DbType.Int32, codigo)
        DB.AddInParameter(DatabaseCommand, "Existencias", DbType.Boolean, Existencias)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProducto(ByVal idProducto As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosEnCara(ByVal Cara As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosEnCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarProductoCombustibleCodigo(ByVal Codigo As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductoCombustibleCodigo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarProductos() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductos(ByVal IdEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosPorTipo(ByVal SolicitanLectura As Boolean) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorTipo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "SolicitanLectura", DbType.Boolean, SolicitanLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosPorTipo(ByVal SolicitanLectura As Boolean, ByVal IdEstacion As Integer) As DataSet    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorTipo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "SolicitanLectura", DbType.Boolean, SolicitanLectura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarProductosAConfigurar(ByVal SolicitanLectura As Boolean) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosAConfigurar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "SolicitanLectura", DbType.Boolean, SolicitanLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosAConfigurar(ByVal SolicitanLectura As Boolean, ByVal IdEstacion As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosAConfigurar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "SolicitanLectura", DbType.Boolean, SolicitanLectura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarProductosDataset() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosPorTurno(ByVal idTurno As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosPorCara(ByVal cara As Short) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarHistoricoPrecio(ByVal idProducto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHistoricoPrecio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarHistoricoSobreTasa() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHistoricoSobreTasa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarHistoricoPrecio(ByVal idProducto As Int32, ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHistoricoPrecio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarHistoricoPrecio(ByVal idProducto As Int32, ByVal fecha As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarHistoricoPrecio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarHorarioAtencion(ByVal horaInicial As DateTime, ByVal horaFinal As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarHorarioAtencion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "HoraInicial", DbType.DateTime, horaInicial)
        DB.AddInParameter(DatabaseCommand, "HoraFinal", DbType.DateTime, horaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarHorarioAtencion() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHorarioAtencion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarHistoricoPrecio(ByVal idProducto As Int32, ByVal fechaOld As Nullable(Of DateTime), ByVal fecha As DateTime, ByVal precio As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarHistoricoPrecio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "FechaOld", DbType.DateTime, fechaOld)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarHistoricoPrecio(ByVal idHistoricoPrecio As Nullable(Of Int32), ByVal idProducto As Int32, ByVal fechaOld As Nullable(Of DateTime), ByVal fecha As DateTime, ByVal precio As Double, ByVal PrecioAuxiliar As Double, ByVal idManguera As Nullable(Of Int16), ByVal cedulaAdmin As String, ByVal claveAutorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarHistoricoPrecioFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdHistoricoPrecio", DbType.Int32, idHistoricoPrecio)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "FechaOld", DbType.DateTime, fechaOld)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "PrecioAuxiliar", DbType.Double, precioAuxiliar)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "CedulaAdmin", DbType.String, cedulaAdmin)
        DB.AddInParameter(DatabaseCommand, "ClaveAutorizacion", DbType.String, claveAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarHistoricoPrecio(ByVal idProducto As Int32, ByVal fechaOld As Nullable(Of DateTime), ByVal fecha As DateTime, ByVal precio As Double, ByVal precioAuxiliar As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarHistoricoPrecioFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "FechaOld", DbType.DateTime, fechaOld)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "PrecioAuxiliar", DbType.Double, precioAuxiliar)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    'Revisado Para uso eficiente del Pool de Conexiones
    Function RecuperarPrecioVigenteProducto(ByVal IdProducto As Integer) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioVigenteProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Result As Double = 0

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Result = CDbl(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Result
    End Function


    'Revisado Para uso eficiente del Pool de Conexiones
    Function RecuperarPrecioProducto(ByVal producto As Int32) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioPorProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Double


        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CDbl(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Function RecuperarPrecioPorVehiculoBolivia(ByVal cara As Int16, ByVal Placa As String, ByVal IdProducto As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioPorVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function


    'Revisado Para uso eficiente del Pool de Conexiones
    Function RecuperarPrecioProductoPorTurno(ByVal idProducto As Int32, ByVal idTurno As Int32) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioProductoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Double

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CDbl(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso eficiente del Pool de Conexiones
    Public Function RecuperarPreciosProductosPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPreciosProductosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As IDataReader

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso eficiente del Pool de Conexiones
    Function RecuperarPrecioProductoPorTurno2(ByVal idProducto As Int32, ByVal idTurno As Int32) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioProductoTurno2"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Double

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CDbl(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso eficiente del Pool de Conexiones
    Public Function RecuperarPrecioProductoPorManguera(ByVal idProducto As Int32, ByVal idManguera As Int32) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioProductoPorManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Decimal

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CDec(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
    Public Function RecuperarPrecioProductoPorManguera(ByVal idProducto As Int32, ByVal idManguera As Int32, ByVal idEstacion As Int16) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioProductoPorManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Decimal

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CDec(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
#End Region
    Public Sub GuardarResolucionPrepago(ByVal numero As Integer, ByVal fecha As String, ByVal consecutivo As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "GuardarResolucionPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroResolucion", DbType.Int32, numero)
        DB.AddInParameter(DatabaseCommand, "FechaResolucion", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#Region "Protocolo"
    Public Sub InsertarProtocolo(ByVal nombre As String, ByVal pathLibreria As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "PathLibreria", DbType.String, pathLibreria)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarProtocolo(ByVal nombre As String, ByVal pathLibreria As String, ByVal AplicaBloqueo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "PathLibreria", DbType.String, pathLibreria)
        DB.AddInParameter(DatabaseCommand, "AplicaBloqueo", DbType.Boolean, AplicaBloqueo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarProtocolo(ByVal idProtocolo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarProtocolo(ByVal idProtocolo As Int32, ByVal nombre As String, ByVal pathLibreria As String, ByVal AplicaBloqueo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "PathLibreria", DbType.String, pathLibreria)
        DB.AddInParameter(DatabaseCommand, "AplicaBloqueo", DbType.Boolean, AplicaBloqueo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarProtocolo(ByVal idProtocolo As Int32, ByVal nombre As String, ByVal pathLibreria As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "PathLibreria", DbType.String, pathLibreria)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarProtocolo(ByVal idProtocolo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarProtocolos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProtocolos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMultiplicadoresProtocolo() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMultiplicadoresProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarMultiplicadoresProtocolo(ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMultiplicadoresProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Puerto"
    Public Sub InsertarPuerto(ByVal puerto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarPuerto(ByVal puerto As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub EliminarPuerto(ByVal idPuerto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarPuerto(ByVal idPuerto As Int32, ByVal puerto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarPuerto(ByVal idPuerto As Int32, ByVal puerto As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function RecuperarPuerto(ByVal idPuerto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuerto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPuertoPorProtocolo(ByVal protocolo As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertoPorProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Protocolo", DbType.String, protocolo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPuertosAsignados(ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertosAsignados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPuertosAsignados() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertosAsignados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarPuertos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarPuertos(ByVal IdEstacion As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



#End Region

#Region "RedSurtidor"
    Public Sub EliminarCaraLector(ByVal idCaraLector As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCaraLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCaraLector", DbType.Int32, idCaraLector)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarCaraLector(ByVal idPuerto As Int32, ByVal IdCara As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCaraLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Idcara", DbType.Int32, IdCara)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarRedSurtidor(ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal caraInicial As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "CaraInicial", DbType.Int32, caraInicial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarRedSurtidor(ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal Eco As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "Eco", DbType.Boolean, Eco)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarRedSurtidor(ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal Eco As Boolean, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "Eco", DbType.Boolean, Eco)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRedSurtidor(ByVal idProtocolo As Int32, ByVal idPuerto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarMultiplicadorProtocolo(ByVal idFactor As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMultiplicadorProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFactor", DbType.Int32, idFactor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarCaraLector(ByVal idCaraLector As Int32, ByVal idCara As Int32, ByVal idPuerto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCaraLector"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCaraLector", DbType.Int32, idCaraLector)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, idCara)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub ActualizarRedSurtidor(ByVal idRed As Int32, ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal caraInicial As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, idRed)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "CaraInicial", DbType.Int32, caraInicial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarRedSurtidor(ByVal idRed As Int32, ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal Eco As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, idRed)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "Eco", DbType.Boolean, Eco)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarRedSurtidor(ByVal idRed As Int32, ByVal idProtocolo As Int32, ByVal idPuerto As Int32, ByVal Eco As Boolean, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, idRed)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)
        DB.AddInParameter(DatabaseCommand, "Eco", DbType.Boolean, Eco)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRedSurtidor(ByVal idProtocolo As Int32, ByVal idPuerto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, idPuerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRedesSurtidor() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedSurtidors"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarMultiplicadorProtocolo(ByVal idFactor As Int32, ByVal idProtocolo As Int32, ByVal idProducto As Int32, ByVal factorPrecio As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarMultiplicadorProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFactor", DbType.Int32, idFactor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "FactorPrecio", DbType.Int32, factorPrecio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMultiplicadorProtocolo(ByVal idFactor As Int32, ByVal idProtocolo As Int32, ByVal idProducto As Int32, ByVal factorPrecio As Int32, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarMultiplicadorProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFactor", DbType.Int32, idFactor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "FactorPrecio", DbType.Int32, factorPrecio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarMultiplicadorProtocolo(ByVal idProtocolo As Int32, ByVal idProducto As Int32, ByVal factorPrecio As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMultiplicadorProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "FactorPrecio", DbType.Int32, factorPrecio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarMultiplicadorProtocolo(ByVal idProtocolo As Int32, ByVal idProducto As Int32, ByVal factorPrecio As Int32, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMultiplicadorProtocolo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "FactorPrecio", DbType.Int32, factorPrecio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Surtidor"
    Public Sub InsertarSurtidor()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarSurtidorFullStation(ByVal CantidadSurtidores As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, CantidadSurtidores)
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarSurtidorFullStation(ByVal CantidadSurtidores As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, CantidadSurtidores)
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarSurtidor(ByVal idSurtidor As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ActualizarDocumentoCanastilla(ByVal Prefijo As String, ByVal Numero As String, ByVal Documento As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDocumentoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo ", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, Documento)

        DB.AddOutParameter(DatabaseCommand, "DocumentoNuevo", DbType.Int64, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Dim oAnulacion As Int32

                oAnulacion = CInt(DB.GetParameterValue(DatabaseCommand, "DocumentoNuevo"))
                Return oAnulacion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ActualizarDocumento(ByVal recibo As Int64, ByVal idFormaPago As Short, ByVal tipoDocumento As Integer, ByVal numero As String, ByVal Franquicia As Integer) As InformacionAnulacion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.String, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Franquicia", DbType.Int32, Franquicia)


        DB.AddOutParameter(DatabaseCommand, "DocumentoAnulacion", DbType.Int64, 0)
        DB.AddOutParameter(DatabaseCommand, "DocumentoNuevo", DbType.Int64, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Dim oAnulacion As New InformacionAnulacion
                oAnulacion.DocumentoAnulado = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoAnulacion"))
                oAnulacion.DocumentoNuevo = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoNuevo"))
                Return oAnulacion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ActualizarDocumento(ByVal recibo As Int64, ByVal idFormaPago As Short, ByVal tipoDocumento As Integer, ByVal numero As String, ByVal Franquicia As Integer, ByVal NroConfirmacion As String) As InformacionAnulacion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.String, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Franquicia", DbType.Int32, Franquicia)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.Int32, CInt(NroConfirmacion))


        DB.AddOutParameter(DatabaseCommand, "DocumentoAnulacion", DbType.Int64, 0)
        DB.AddOutParameter(DatabaseCommand, "DocumentoNuevo", DbType.Int64, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Dim oAnulacion As New InformacionAnulacion
                oAnulacion.DocumentoAnulado = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoAnulacion"))
                oAnulacion.DocumentoNuevo = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoNuevo"))
                Return oAnulacion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ActualizarDocumento(ByVal recibo As Int64, ByVal idFormaPago As Short, ByVal tipoDocumento As Integer, ByVal numero As String, ByVal Franquicia As Integer, ByVal NroConfirmacion As String, ByVal tipoDocumentoEmitir As Int32) As InformacionAnulacion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.String, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Franquicia", DbType.Int32, Franquicia)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.Int32, CInt(NroConfirmacion))
        DB.AddInParameter(DatabaseCommand, "TipoDocumentoEmitir", DbType.Int32, tipoDocumentoEmitir)

        DB.AddOutParameter(DatabaseCommand, "DocumentoAnulacion", DbType.Int64, 0)
        DB.AddOutParameter(DatabaseCommand, "DocumentoNuevo", DbType.Int64, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Dim oAnulacion As New InformacionAnulacion
                oAnulacion.DocumentoAnulado = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoAnulacion"))
                oAnulacion.DocumentoNuevo = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoNuevo"))
                Return oAnulacion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ActualizarDocumentoCanastillaPeru(ByVal recibo As Int64, ByVal idFormaPago As Short, ByVal tipoDocumento As Integer, ByVal numero As String, ByVal Franquicia As Integer, ByVal NroConfirmacion As String, ByVal tipoDocumentoEmitir As Int32) As InformacionAnulacion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDocumentoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim olector As IDataReader = Nothing

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.String, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Franquicia", DbType.Int32, Franquicia)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.Int32, CInt(NroConfirmacion))
        DB.AddInParameter(DatabaseCommand, "TipoDocumentoEmitir", DbType.Int32, tipoDocumentoEmitir)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                olector = DB.ExecuteReader(DatabaseCommand)
                Dim oAnulacion As New InformacionAnulacion
                While olector.Read
                    oAnulacion.DocumentoAnulado = CLng(olector.Item(0).ToString)
                    oAnulacion.DocumentoNuevo = CLng(olector.Item(1).ToString)
                End While

                olector.Close()
                olector.Dispose()
                olector = Nothing

                Return oAnulacion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ActualizarDocumento(ByVal recibo As Int64, ByVal idFormaPago As Short, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal nroVale As String) As InformacionAnulacion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.String, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, nroVale)

        DB.AddOutParameter(DatabaseCommand, "DocumentoAnulacion", DbType.Int64, 0)
        DB.AddOutParameter(DatabaseCommand, "DocumentoNuevo", DbType.Int64, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Dim oAnulacion As New InformacionAnulacion
                oAnulacion.DocumentoAnulado = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoAnulacion"))
                oAnulacion.DocumentoNuevo = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoNuevo"))
                Return oAnulacion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarSurtidor(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarSurtidor(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32, ByVal TopeSurtidor As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidorColombia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "ValorTope", DbType.Decimal, TopeSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteManejoCarroTanque(ByVal IdCara As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteManejoCarroTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim result As Boolean = False

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                result = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return result
    End Function


    Public Function RecuperarProductoPorManguera(ByVal IdManguera As Integer) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductoPorManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim result As Integer = 0

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, IdManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                result = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return result
    End Function


    Public Sub ActualizarSurtidor(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32, ByVal idIsla As Int32,
                                  ByVal ValorTope As Decimal, ByVal IdRed As Int32,
                                  ByVal ManejaCarroTanque As Boolean, ByVal CodigoPCC As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, idIsla)
        DB.AddInParameter(DatabaseCommand, "ValorTope", DbType.Decimal, ValorTope)
        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, IdRed)
        DB.AddInParameter(DatabaseCommand, "ManejaCarroTanque", DbType.Boolean, ManejaCarroTanque)
        DB.AddInParameter(DatabaseCommand, "CodigoPCC", DbType.String, CodigoPCC)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarSurtidorFullStation(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32, ByVal idIsla As Int32, ByVal ValorTope As Decimal, ByVal IdRed As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, idIsla)
        DB.AddInParameter(DatabaseCommand, "ValorTope", DbType.Decimal, ValorTope)
        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, IdRed)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarSurtidorFullStation(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32, ByVal idIsla As Int32, ByVal ValorTope As Decimal, ByVal IdRed As Int32, ByVal ManejaPresionLlenado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, idIsla)
        DB.AddInParameter(DatabaseCommand, "ValorTope", DbType.Decimal, ValorTope)
        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, IdRed)
        DB.AddInParameter(DatabaseCommand, "ManejaPresionLlenado", DbType.Boolean, ManejaPresionLlenado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarSurtidorFullStation(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32, ByVal idIsla As Int32, ByVal ValorTope As Decimal, ByVal IdRed As Int32, ByVal idestacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, idIsla)
        DB.AddInParameter(DatabaseCommand, "ValorTope", DbType.Decimal, ValorTope)
        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, IdRed)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idestacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarSurtidorFullStation(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32, ByVal idIsla As Int32, ByVal ValorTope As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, idIsla)
        DB.AddInParameter(DatabaseCommand, "ValorTope", DbType.Decimal, ValorTope)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarSurtidorFullStationBolivia(ByVal idSurtidor As Int16, ByVal idProtocolo As Int32, ByVal idIsla As Int32, ByVal ValorTope As Decimal, ByVal IdRed As Int32, ByVal AplicaControlPresionLlenado As Boolean, ByVal Aplicaliquido As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdProtocolo", DbType.Int32, idProtocolo)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, idIsla)
        DB.AddInParameter(DatabaseCommand, "ValorTope", DbType.Decimal, ValorTope)
        DB.AddInParameter(DatabaseCommand, "IdRed", DbType.Int32, IdRed)
        DB.AddInParameter(DatabaseCommand, "AplicaControlPresionLlenado", DbType.Boolean, AplicaControlPresionLlenado)
        DB.AddInParameter(DatabaseCommand, "AplicaLiquido", DbType.Boolean, Aplicaliquido)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarSurtidor(ByVal idSurtidor As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSurtidores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSurtidores(ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSurtidoresColombia() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresColombia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCantidadSurtidores() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadSurtidores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCantidadSurtidores(ByVal IdEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadSurtidores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "Turno"
    Public Function AbrirTurno(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String, ByVal delta As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)
        DB.AddInParameter(DatabaseCommand, "Delta", DbType.Int32, delta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
                connection.Dispose()
            End Try
        End Using
    End Function

    Public Sub ValidarCierreTurnoParcialSurtidor(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreTurnoParcialSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
                connection.Dispose()
            End Try
        End Using
    End Sub




    Public Sub IniciarSesion(ByVal empleado As String, ByVal clave As String, ByVal puerto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "IniciarSesion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CedulaEmpleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub IniciarSesion(ByVal empleado As String, ByVal clave As String, ByVal puerto As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "IniciarSesion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CedulaEmpleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function EsPrimerTurnoAbierto() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsPrimerTurnoAbierto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function AbrirTurnoValidacion(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String, ByVal delta As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)
        DB.AddInParameter(DatabaseCommand, "Delta", DbType.Int32, delta)
        Dim IdTurnoA As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurnoA", DbType.Int32, IdTurnoA)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurnoA"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function AbrirTurnoValidacionTerpel(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String, ByVal delta As Int32, ByVal esAutoServicio As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)
        DB.AddInParameter(DatabaseCommand, "Delta", DbType.Int32, delta)
        DB.AddInParameter(DatabaseCommand, "EsAutoServicio", DbType.Boolean, esAutoServicio)
        Dim IdTurnoA As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurnoA", DbType.Int32, IdTurnoA)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurnoA"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function AbrirTurnoValidacionTerpel(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String, ByVal delta As Int32, ByVal esAutoServicio As Boolean, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)
        DB.AddInParameter(DatabaseCommand, "Delta", DbType.Int32, delta)
        DB.AddInParameter(DatabaseCommand, "EsAutoServicio", DbType.Boolean, esAutoServicio)
        Dim IdTurnoA As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurnoA", DbType.Int32, IdTurnoA)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurnoA"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function AbrirTurnoTrabajoValidacion(ByVal empleado As String, ByVal clave As String, ByVal delta As Int32, ByVal tipoTurno As Byte) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Delta", DbType.Int32, delta)
        DB.AddInParameter(DatabaseCommand, "tipoTurno", DbType.Byte, tipoTurno)
        Dim IdTurno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function AbrirTurnoTrabajoValidacion(ByVal empleado As String, ByVal clave As String, ByVal delta As Int32, ByVal tipoTurno As Byte, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Delta", DbType.Int32, delta)
        DB.AddInParameter(DatabaseCommand, "tipoTurno", DbType.Byte, tipoTurno)
        Dim IdTurno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function AbrirTurnoApoyo(ByVal empleado As String, ByVal clave As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurnoApoyo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Dim IdTurno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsEmpleadoTurnoApoyo(ByVal empleado As String, ByVal clave As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsEmpleadoTurnoApoyo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Dim IdTurno As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function AbrirTurnoValidacionGazel(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String, ByVal delta As Int32, ByVal lecturaTeleCorrector As Nullable(Of Decimal)) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AbrirTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)
        DB.AddInParameter(DatabaseCommand, "Delta", DbType.Int32, delta)
        DB.AddInParameter(DatabaseCommand, "LecturaTeleCorrector", DbType.Decimal, lecturaTeleCorrector)
        Dim IdTurnoA As Int32
        DB.AddOutParameter(DatabaseCommand, "IdTurnoA", DbType.Int32, IdTurnoA)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTurnoA"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarTurno(ByVal idTurno As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ConsultarCredencialesEmpleado(ByVal Cedula As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ConsultarCredencialesEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteScalar(DatabaseCommand)
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function CerrarTurno(ByVal empleado As String, ByVal clave As String, ByRef surtidores As String, ByVal SurtidoresACerrar As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdTurno As Int32

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddOutParameter(DatabaseCommand, "Surtidores", DbType.String, 300)
        DB.AddInParameter(DatabaseCommand, "SurtidoresACerrar", DbType.String, SurtidoresACerrar)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                IdTurno = CInt(DB.ExecuteScalar(DatabaseCommand))
                surtidores = DB.GetParameterValue(DatabaseCommand, "Surtidores").ToString()

                Return IdTurno
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub CerrarTurnoAutomatico(ByVal idTurno As Int32, ByRef surtidores As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Nothing)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Nothing)
        DB.AddOutParameter(DatabaseCommand, "Surtidores", DbType.String, 300)
        DB.AddInParameter(DatabaseCommand, "IdTurnoAutomatico", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                surtidores = DB.GetParameterValue(DatabaseCommand, "Surtidores").ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CerrarTurnoValidacion(ByVal empleado As String, ByVal clave As String, ByRef surtidores As String, ByRef idTurno As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddOutParameter(DatabaseCommand, "Surtidores", DbType.String, 300)
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                surtidores = DB.GetParameterValue(DatabaseCommand, "Surtidores").ToString()
                idTurno = CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub CerrarTurnoValidacion(ByVal empleado As String, ByVal clave As String, ByRef surtidores As String, ByRef idTurno As Int32, ByRef idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddOutParameter(DatabaseCommand, "Surtidores", DbType.String, 300)
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                surtidores = DB.GetParameterValue(DatabaseCommand, "Surtidores").ToString()
                idTurno = CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CerrarTurnoValidacion(ByRef surtidores As String, ByRef idTurno As Int32, ByRef idTurnoAutomatico As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Nothing)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Nothing)
        DB.AddOutParameter(DatabaseCommand, "Surtidores", DbType.String, 300)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdTurnoAutomatico", DbType.Int32, idTurnoAutomatico)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                surtidores = DB.GetParameterValue(DatabaseCommand, "Surtidores").ToString()
                'idTurno = CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub CerrarTurnoValidacion(ByRef surtidores As String, ByRef idTurno As Int32, ByRef idTurnoAutomatico As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Nothing)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Nothing)
        DB.AddOutParameter(DatabaseCommand, "Surtidores", DbType.String, 300)
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdTurnoAutomatico", DbType.Int32, idTurnoAutomatico)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                surtidores = DB.GetParameterValue(DatabaseCommand, "Surtidores").ToString()
                idTurno = CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function CerrarTurnoTrabajoValidacion(ByVal empleado As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdTurno As Int32 = 0

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                IdTurno = CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
                Return IdTurno
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function CerrarTurnoTrabajoValidacion(ByVal empleado As String, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CerrarTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdTurno As Int32 = 0

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddOutParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                IdTurno = CInt(DB.GetParameterValue(DatabaseCommand, "IdTurno"))
                Return IdTurno
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub CancelarProcesoTurno(ByVal idCara As Int16, ByVal estado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CancelarProcesoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CancelarProcesoTurno(ByVal idCara As Int16, ByVal estado As Boolean, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CancelarProcesoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, estado)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTurnoTrabajo(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoJSON(ByVal idTurno As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoJSON"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarDatosTarjetaPrepago(ByVal Tarjeta As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosTarjetaPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tarjeta", DbType.String, Tarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMovimientoTarjetaPrepagoCanastilla(ByVal Tarjeta As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMovimientoTarjetaPrepagoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tarjeta", DbType.String, Tarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarMovimientoTarjetaPrepago(ByVal Tarjeta As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMovimientoTarjetaPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tarjeta", DbType.String, Tarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function






    Public Function RecuperarAbonosPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAbonosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoApoyo(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoApoyo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoTrabajo(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDescuentosPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDescuentosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDescuentosPorTurno(ByVal idTurno As Int32, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDescuentosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEstadoTurno(ByVal cara As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado

        Dim SqlCommand As String = "RecuperarEstadoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEstadoTurno(ByVal cara As String, ByVal IdEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado

        Dim SqlCommand As String = "RecuperarEstadoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoAbiertoPorEmpleado(ByVal cedula As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoAbiertoPorEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oReader As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If oReader.Read Then
                    Return oReader.Item(0).ToString
                Else
                    Return ""
                End If
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnoAbiertoPorEmpleado(ByVal cedula As String, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoAbiertoPorEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oReader As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If oReader.Read Then
                    Return oReader.Item(0).ToString
                Else
                    Return ""
                End If
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoTrabajoAbiertoPorEmpleado(ByVal cedula As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoTrabajoAbiertoPorEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oReader As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If oReader.Read Then
                    Return oReader.Item(0).ToString
                Else
                    Return ""
                End If
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnoTrabajoAbiertoPorEmpleado(ByVal cedula As String, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoTrabajoAbiertoPorEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oReader As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If oReader.Read Then
                    Return oReader.Item(0).ToString
                Else
                    Return ""
                End If
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoPorEmpleadoFecha(ByVal cedula As String, ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorEmpleadoFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoFrecuenciaPorEmpleadoFecha(ByVal cedula As String, ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoFrecuenciaPorEmpleadoFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoPorEmpleadoFecha(ByVal cedula As String, ByVal fecha As String, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorEmpleadoFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoTrabajoPorEmpleadoFecha(ByVal cedula As String, ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoTrabajoPorEmpleadoFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnoTrabajoPorEmpleadoFecha(ByVal cedula As String, ByVal fecha As String, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoTrabajoPorEmpleadoFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoTurnoPorEmpleado(ByVal cedula As String, ByVal clave As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoTurnoPorEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoTurnoCerrado() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoTurnoCerrado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarUltimoTurnoCerrado(ByVal idestacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoTurnoCerrado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idestacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTanquesPorTurno(ByVal cedula As String, ByVal clave As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTanquesCierreAutomatico(ByVal cedula As String, ByVal clave As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesCierreAutomatico"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarTanquesCierreDiaManual(ByVal cedula As String, ByVal clave As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesAjustesCierreDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Sub RealizarAjustesPorOperacionTurno(ByVal newId As String, ByVal IdTurno As Int32, ByVal Cedula As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RealizarAjustesPorOperacionTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdStockTurnoHorario", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub RealizarAjustesPorOperacionTurno(ByVal newId As String, ByVal IdTurno As Int32, ByVal Cedula As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RealizarAjustesPorOperacionTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdStockTurnoHorario", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub RealizarAjustesPorOperacionDia(ByVal newId As String, ByVal Dia As Nullable(Of DateTime), ByVal Cedula As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RealizarAjustesPorOperacionDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdStockTurnoHorario", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.Date, Dia)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarStockTurnoHorarioTmp(ByVal newId As String, ByVal CodTanque As String, ByVal idTurno As Int32, ByVal AlturaAgua As Nullable(Of Decimal), ByVal AlturaTanque As Nullable(Of Decimal), ByVal CantidadTanque As Nullable(Of Decimal), ByVal CantidadAgua As Nullable(Of Decimal), ByVal BorrarTemporal As Boolean, ByVal EsAjustePorAlturas As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarStockTurnoHorarioTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdStockTurnoHorario", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "AlturaAgua", DbType.Decimal, AlturaAgua)
        DB.AddInParameter(DatabaseCommand, "AlturaTanque", DbType.Decimal, AlturaTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadTanque", DbType.Decimal, CantidadTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadAgua", DbType.Decimal, CantidadAgua)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, BorrarTemporal)
        DB.AddInParameter(DatabaseCommand, "EsAjustePorAlturas", DbType.Boolean, EsAjustePorAlturas)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarStockTurnoHorarioTmp(ByVal newId As String, ByVal CodTanque As String, ByVal idTurno As Int32, ByVal AlturaAgua As Nullable(Of Decimal), ByVal AlturaTanque As Nullable(Of Decimal), ByVal CantidadTanque As Nullable(Of Decimal), ByVal CantidadAgua As Nullable(Of Decimal), ByVal BorrarTemporal As Boolean, ByVal EsAjustePorAlturas As Boolean, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarStockTurnoHorarioTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdStockTurnoHorario", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "AlturaAgua", DbType.Decimal, AlturaAgua)
        DB.AddInParameter(DatabaseCommand, "AlturaTanque", DbType.Decimal, AlturaTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadTanque", DbType.Decimal, CantidadTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadAgua", DbType.Decimal, CantidadAgua)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, BorrarTemporal)
        DB.AddInParameter(DatabaseCommand, "EsAjustePorAlturas", DbType.Boolean, EsAjustePorAlturas)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarStockCierreDiaTmp(ByVal newId As String, ByVal CodTanque As String, ByVal AlturaAgua As Nullable(Of Decimal), ByVal AlturaTanque As Nullable(Of Decimal), ByVal CantidadTanque As Nullable(Of Decimal), ByVal CantidadAgua As Nullable(Of Decimal), ByVal BorrarTemporal As Boolean, ByVal EsAjustePorAlturas As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarStockCierreDiaTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdStockTurnoHorario", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "AlturaAgua", DbType.Decimal, AlturaAgua)
        DB.AddInParameter(DatabaseCommand, "AlturaTanque", DbType.Decimal, AlturaTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadTanque", DbType.Decimal, CantidadTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadAgua", DbType.Decimal, CantidadAgua)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, BorrarTemporal)
        DB.AddInParameter(DatabaseCommand, "EsAjustePorAlturas", DbType.Boolean, EsAjustePorAlturas)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarStockCierreDiaTmp(ByVal newId As String, ByVal CodTanque As String, ByVal AlturaAgua As Nullable(Of Decimal), ByVal AlturaTanque As Nullable(Of Decimal), ByVal CantidadTanque As Nullable(Of Decimal), ByVal CantidadAgua As Nullable(Of Decimal), ByVal BorrarTemporal As Boolean, ByVal EsAjustePorAlturas As Boolean, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarStockCierreDiaTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdStockTurnoHorario", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "AlturaAgua", DbType.Decimal, AlturaAgua)
        DB.AddInParameter(DatabaseCommand, "AlturaTanque", DbType.Decimal, AlturaTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadTanque", DbType.Decimal, CantidadTanque)
        DB.AddInParameter(DatabaseCommand, "CantidadAgua", DbType.Decimal, CantidadAgua)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, BorrarTemporal)
        DB.AddInParameter(DatabaseCommand, "EsAjustePorAlturas", DbType.Boolean, EsAjustePorAlturas)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarTurnoPorSurtidor(ByVal turno As Byte, ByVal surtidor As Byte, ByVal fecha As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, turno)
        DB.AddInParameter(DatabaseCommand, "Surtidor", DbType.Int32, surtidor)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnoPorSurtidor(ByVal turno As Byte, ByVal surtidor As Byte, ByVal fecha As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, turno)
        DB.AddInParameter(DatabaseCommand, "Surtidor", DbType.Int32, surtidor)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Revisado Uso eficiente del Pool de Conexiones
    Public Function ValidarCierreDia(ByVal fecha As String, ByVal esMRCombustible As Boolean) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "EsMRCombustible", DbType.Boolean, esMRCombustible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function ValidarCierreDia(ByVal fecha As String, ByVal esMRCombustible As Boolean, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "EsMRCombustible", DbType.Boolean, esMRCombustible)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
    Public Function ValidarCierreDia(ByVal fecha As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function


    Public Function ValidarCierreDiaGAZEL(ByVal fecha As DateTime) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreDiaGAZEL"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Uso eficiente del Pool de Conexiones
    Public Function ValidarCierreDiaCombustible(ByVal fecha As DateTime) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
    Public Function ValidarCierreDiaCombustible(ByVal fecha As DateTime, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "IdEstacion ", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Uso eficiente del Pool de Conexiones
    Public Function ValidarCierreDiaDia(ByVal fecha As String, ByVal esMRCombsutible As Boolean) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreDiaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "EsMRCombustible", DbType.Boolean, esMRCombsutible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
    Public Function ValidarCierreDiaDia(ByVal fecha As String, ByVal esMRCombsutible As Boolean, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreDiaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "EsMRCombustible", DbType.Boolean, esMRCombsutible)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Uso eficiente del Pool de Conexiones
    Public Function ValidarCierreDiaDia(ByVal fecha As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreDiaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarTurnosPorFecha(ByVal fecha As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarTurnosPorFechaTerpel(ByVal fecha As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosPorFechaTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
    Public Function RecuperarTurnosPorFechaTerpel(ByVal fecha As String, ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosPorFechaTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdEstacion ", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarTurnosPorFechaFuelStation(ByVal fecha As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosPorFechaCRMStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarTurnosAbiertosTerpel() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosAbiertosTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
    Public Function RecuperarTurnosAbiertosTerpel(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosAbiertosTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarTurnosAbiertosPendientesTerpel() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosAbiertosPendientesTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
    Public Function RecuperarTurnosAbiertosPendientesTerpel(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosAbiertosPendientesTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarTurnosAbiertos() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosAbiertos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarTurnosAbiertosPendientes() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosAbiertosPendientes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function ValidarVentaParcialPorTurno(ByVal IdTurno As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentaParcialPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.String, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNumeroTurnoHorarioPorIdTurno(ByVal IdTurno As Int32) As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado

        Dim SqlCommand As String = "RecuperarNumeroTurnoHorarioPorIdTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CShort(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "TurnoHorario"
    Public Sub InsertarTurnoHorario(ByVal horaInicio As Date, ByVal horaFin As Date, ByVal numeroTurno As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.Date, horaInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.Date, horaFin)
        DB.AddInParameter(DatabaseCommand, "NumeroTurno", DbType.Int16, numeroTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTurnoHorario(ByVal idTurnoHorario As Int32, ByVal horaInicio As Date, ByVal horaFin As Date, ByVal numeroTurno As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnoHorario", DbType.Int32, idTurnoHorario)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.Date, horaInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.Date, horaFin)
        DB.AddInParameter(DatabaseCommand, "NumeroTurno", DbType.Int16, numeroTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTurnoHorario(ByVal idTurnoHorario As Int32, ByVal horaInicio As Date, ByVal horaFin As Date, ByVal numeroTurno As Int16, ByVal Ajustes As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnoHorario", DbType.Int32, idTurnoHorario)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.Date, horaInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.Date, horaFin)
        DB.AddInParameter(DatabaseCommand, "NumeroTurno", DbType.Int16, numeroTurno)
        DB.AddInParameter(DatabaseCommand, "Ajustes", DbType.Boolean, Ajustes)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTurnoHorario(ByVal idTurnoHorario As Int32, ByVal horaInicio As Date, ByVal horaFin As Date, ByVal numeroTurno As Int16, ByVal Ajustes As Boolean, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnoHorario", DbType.Int32, idTurnoHorario)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.Date, horaInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.Date, horaFin)
        DB.AddInParameter(DatabaseCommand, "NumeroTurno", DbType.Int16, numeroTurno)
        DB.AddInParameter(DatabaseCommand, "Ajustes", DbType.Boolean, Ajustes)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarTurnoHorario(ByVal idTurnoHorario As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnoHorario", DbType.Int32, idTurnoHorario)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarTurnoHorario(ByVal idTurnoHorario As Int32, ByVal horaInicio As Date, ByVal horaFin As Date, ByVal numeroTurno As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnoHorario", DbType.Int32, idTurnoHorario)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.Date, horaInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.Date, horaFin)
        DB.AddInParameter(DatabaseCommand, "NumeroTurno", DbType.Int16, numeroTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarTurnoHorario(ByVal idTurnoHorario As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnoHorario", DbType.Int32, idTurnoHorario)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnosHorario() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoshorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnosHorario(ByVal IdEstacion As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoshorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarListaTurnosHorario() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "[RecuperarListaTurnosHorario]"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



#End Region

#Region "TurnoSurtidor"
    Public Sub VincularSurtidorTurno(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "VincularSurtidorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub VincularSurtidorTurno(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "VincularSurtidorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarRomPorRecibo(ByVal rom As Int64) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de  configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRomPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarPlacaPorRecibo(ByVal recibo As Int64) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de  configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarIdGerenciamientoPorIdAprobacion(ByVal IdAprobacion As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de  configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdGerenciamientoPorIdAprobacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAprobacion", DbType.String, IdAprobacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function RecuperarPlacaPorRecibo(ByVal recibo As Int64, ByVal IdEstacion As Integer) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de  configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPagoExtraOrdinario(ByVal empleado As String, ByVal clave As String, ByVal placa As String, ByVal credito As Integer, ByVal valor As String, ByVal idFinanciera As Int32, ByVal recibo As Int64) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Credito", DbType.Int32, credito)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddOutParameter(DatabaseCommand, "Id", DbType.Int32, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "Id"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPagoExtraOrdinario(ByVal empleado As String, ByVal clave As String, ByVal placa As String, ByVal credito As Integer, ByVal valor As String, ByVal idFinanciera As Int32, ByVal recibo As Int64, ByVal ListaDatosMediosPago As List(Of MedioPago)) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim ReciboPago As Int32

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Credito", DbType.Int32, credito)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddOutParameter(DatabaseCommand, "Id", DbType.Int32, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Transaccion = connection.BeginTransaction
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                ReciboPago = CInt(DB.GetParameterValue(DatabaseCommand, "Id"))

                DatabaseCommand.CommandText = "InsertarPagoExtraordinarioMedioPago"
                DatabaseCommand.Parameters.Clear()

                DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, ReciboPago)
                DB.AddInParameter(DatabaseCommand, "IdMedioPago", DbType.Int16)
                DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                DB.AddInParameter(DatabaseCommand, "Documento", DbType.String)
                DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32)
                DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String)

                For Each OMedioPago As MedioPago In ListaDatosMediosPago
                    DB.SetParameterValue(DatabaseCommand, "IdMedioPago", OMedioPago.IdMedioPago)
                    DB.SetParameterValue(DatabaseCommand, "Valor", OMedioPago.Valor)
                    DB.SetParameterValue(DatabaseCommand, "Documento", OMedioPago.Documento)
                    DB.SetParameterValue(DatabaseCommand, "TipoLectura", OMedioPago.TipoLectura)
                    DB.SetParameterValue(DatabaseCommand, "NroConfirmacion", OMedioPago.NroConfirmacion)

                    'Ejecuta el procedimiento Almacenado InsertarPagoExtraordinarioMedioPago
                    DB.ExecuteNonQuery(DatabaseCommand)
                Next

                Transaccion.Commit()

                Return ReciboPago
            Catch
                If Not Transaccion Is Nothing Then
                    Transaccion.Rollback()
                End If

                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarPagoExtraOrdinario(ByVal empleado As String, ByVal clave As String, ByVal placa As String, ByVal credito As Integer, ByVal valor As String, ByVal idFinanciera As Int32, ByVal recibo As Int64, ByVal ListaDatosMediosPago As List(Of MedioPago), ByVal IdEstacion As Integer) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim ReciboPago As Int32

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Credito", DbType.Int32, credito)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)
        DB.AddOutParameter(DatabaseCommand, "Id", DbType.Int32, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Transaccion = connection.BeginTransaction
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                ReciboPago = CInt(DB.GetParameterValue(DatabaseCommand, "Id"))

                DatabaseCommand.CommandText = "InsertarPagoExtraordinarioMedioPago"
                DatabaseCommand.Parameters.Clear()

                DB.AddInParameter(DatabaseCommand, "IdPago", DbType.Int32, ReciboPago)
                DB.AddInParameter(DatabaseCommand, "IdMedioPago", DbType.Int16)
                DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                DB.AddInParameter(DatabaseCommand, "Documento", DbType.String)
                DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32)
                DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String)

                For Each OMedioPago As MedioPago In ListaDatosMediosPago
                    DB.SetParameterValue(DatabaseCommand, "IdMedioPago", OMedioPago.IdMedioPago)
                    DB.SetParameterValue(DatabaseCommand, "Valor", OMedioPago.Valor)
                    DB.SetParameterValue(DatabaseCommand, "Documento", OMedioPago.Documento)
                    DB.SetParameterValue(DatabaseCommand, "TipoLectura", OMedioPago.TipoLectura)
                    DB.SetParameterValue(DatabaseCommand, "NroConfirmacion", OMedioPago.NroConfirmacion)

                    'Ejecuta el procedimiento Almacenado InsertarPagoExtraordinarioMedioPago
                    DB.ExecuteNonQuery(DatabaseCommand)
                Next

                Transaccion.Commit()

                Return ReciboPago
            Catch
                If Not Transaccion Is Nothing Then
                    Transaccion.Rollback()
                End If

                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function InsertarPagoExtraOrdinario(ByVal empleado As String, ByVal clave As String, ByVal placa As String, ByVal credito As Integer, ByVal valor As String, ByVal idFinanciera As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Credito", DbType.Int32, credito)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddOutParameter(DatabaseCommand, "Id", DbType.Int32, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "Id"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPagoExtraOrdinario(ByVal empleado As String, ByVal clave As String, ByVal placa As String, ByVal credito As Integer, ByVal valor As String, ByVal idFinanciera As Int32, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Credito", DbType.Int32, credito)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddOutParameter(DatabaseCommand, "Id", DbType.Int32, 0)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "Id"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPagoExtraOrdinario(ByVal empleado As String, ByVal clave As String, ByVal placa As String, ByVal valor As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddOutParameter(DatabaseCommand, "Id", DbType.Int32, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "Id"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPagoExtraOrdinario(ByVal empleado As String, ByVal clave As String, ByVal placa As String, ByVal valor As String, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddOutParameter(DatabaseCommand, "Id", DbType.Int32, 0)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "Id"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub DesvincularSurtidorTurno(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "DesvincularSurtidorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub DesvincularSurtidorTurno(ByVal empleado As String, ByVal clave As String, ByVal surtidores As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "DesvincularSurtidorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Surtidores", DbType.String, surtidores)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTurnoSurtidor(ByVal idSurtidor As Int16, ByVal idTurno As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarTurnoSurtidor(ByVal idTurnSurtidor As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnSurtidor", DbType.Int32, idTurnSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarTurnoSurtidor(ByVal idTurnSurtidor As Int32, ByVal idSurtidor As Int16, ByVal idTurno As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnSurtidor", DbType.Int32, idTurnSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarTurnoSurtidor(ByVal idTurnSurtidor As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurnSurtidor", DbType.Int32, idTurnSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnosSurtidor() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoSurtidors"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "Vehiculo"
    Public Sub InsertarVehiculoPeru(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal precio As Decimal, ByVal identificador As String, ByVal tipoIdentificador As Int32, ByVal ruc As String, ByVal NombreConductor As String, ByVal CodigoGerencia As String, ByVal SolicitarKilometraje As Boolean, ByVal Codigo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificador", DbType.Int32, tipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "ruc", DbType.String, ruc)
        DB.AddInParameter(DatabaseCommand, "NombreConductor", DbType.String, NombreConductor)
        DB.AddInParameter(DatabaseCommand, "CodigoGerencia", DbType.String, CodigoGerencia)
        DB.AddInParameter(DatabaseCommand, "AplicaKilometraje", DbType.Boolean, SolicitarKilometraje)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal IdCausalBloqueo As Integer, ByVal Nuip As String, ByVal precio As Decimal, ByVal rom As String, ByVal ControlKM As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int32, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVehiculoANH(ByVal placa As String, ByVal Imagen As String, ByVal Tag As String, ByVal Estado As Boolean, ByVal IdCategoria As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculoANH"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, Tag)
        DB.AddInParameter(DatabaseCommand, "Imagen", DbType.String, Imagen)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "IdCategoria", DbType.Int32, IdCategoria)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As String, ByVal IdCausalBloqueo As Integer, ByVal Nuip As String, ByVal precio As Decimal, ByVal rom As String, ByVal ControlKM As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.String, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int32, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal IdCausalBloqueo As Integer, ByVal Nuip As String, ByVal precio As Decimal, ByVal identificador As String, ByVal idTipoIdentificador As Int32, ByVal ControlKM As Boolean, ByVal NroTanque As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int32, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)
        DB.AddInParameter(DatabaseCommand, "NroTanque", DbType.Int16, NroTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal IdCausalBloqueo As Integer, ByVal Nuip As String, ByVal precio As Decimal, ByVal identificador As String, ByVal idTipoIdentificador As Int32, ByVal ControlKM As Boolean, ByVal NroTanque As Int16, ByVal NuipPropietario As String, ByVal AplicaDataTrack As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int32, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)
        DB.AddInParameter(DatabaseCommand, "NroTanque", DbType.Int16, NroTanque)
        DB.AddInParameter(DatabaseCommand, "NuipPropietario", DbType.String, NuipPropietario)
        DB.AddInParameter(DatabaseCommand, "AplicaDataTrack", DbType.Boolean, AplicaDataTrack)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal IdCausalBloqueo As Integer, ByVal Nuip As String, ByVal precio As Decimal, ByVal rom As String, ByVal ControlKM As Boolean, ByVal NroTanque As Int16, ByVal Tarjetas As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int32, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)
        DB.AddInParameter(DatabaseCommand, "NroTanque", DbType.Int16, NroTanque)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub EliminarVehiculo(ByVal idVehiculo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVehiculoPeru(ByVal idvehiculo As Integer, ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal precio As Decimal, ByVal identificador As String, ByVal tipoIdentificador As Int32, ByVal ruc As String, ByVal NombreConductor As String, ByVal CodigoGerencia As String, ByVal SolicitarKilometraje As Boolean, ByVal Codigo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idvehiculo", DbType.Int32, idvehiculo)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificador", DbType.Int32, tipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "ruc", DbType.String, ruc)
        DB.AddInParameter(DatabaseCommand, "NombreConductor", DbType.String, NombreConductor)
        DB.AddInParameter(DatabaseCommand, "CodigoGerencia", DbType.String, CodigoGerencia)
        DB.AddInParameter(DatabaseCommand, "AplicaKilometraje", DbType.Boolean, SolicitarKilometraje)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal IdCausalBloqueo As Long, ByVal Nuip As String, ByVal precio As Decimal, ByVal rom As String, ByVal ControlKM As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int64, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal IdCausalBloqueo As Long, ByVal Nuip As String, ByVal precio As Decimal, ByVal identificador As String, ByVal idTipoIdentificador As Int32, ByVal ControlKM As Boolean, ByVal NroTanque As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int64, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)
        DB.AddInParameter(DatabaseCommand, "NroTanque", DbType.Int16, NroTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As Integer, ByVal IdCausalBloqueo As Long, ByVal Nuip As String, ByVal precio As Decimal, ByVal identificador As String, ByVal idTipoIdentificador As Int32, ByVal ControlKM As Boolean, ByVal NroTanque As Int16, ByVal NuipPropietario As String, ByVal AplicaDataTrack As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int64, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)
        DB.AddInParameter(DatabaseCommand, "NroTanque", DbType.Int16, NroTanque)
        DB.AddInParameter(DatabaseCommand, "NuipPropietario", DbType.String, NuipPropietario)
        DB.AddInParameter(DatabaseCommand, "AplicaDataTrack", DbType.Boolean, AplicaDataTrack)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarVehiculo(ByVal placa As String, ByVal modelo As String, ByVal IdTipoVehiculo As String, ByVal IdCausalBloqueo As Long, ByVal Nuip As String, ByVal precio As Decimal, ByVal rom As String, ByVal ControlKM As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.String, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int64, IdCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKM)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarCopiasPorForma(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCopiasPorForma"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Function RecuperarCopiasPorForma(ByVal recibo As Int64, ByVal IdEstacion As Integer, Optional ByVal esVentaRegistrada As Boolean = True) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCopiasPorForma"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarTipoDocumentoVenta(ByVal recibo As Int64) As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoDocumentoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CShort(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    ''' <summary>
    ''' 
    ''' </summary>
    ''' <param name="Rom"></param>
    ''' <param name="Placa"></param>
    ''' <remarks>Si no lanza una exception es porque el vehiculo esta bien</remarks>
    Sub RecuperarEstadoVehiculo(ByVal rom As String, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstadoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub


    Sub RecuperarEstadoVehiculo(ByVal rom As String, ByVal placa As String, ByVal EsGasolina As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstadoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "EsGasolina", DbType.Boolean, EsGasolina)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Function ExistePlaca(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteVehiculo(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteVehiculo(ByVal placa As String, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function EsMonitoreoChip(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsMonitoreoChip"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    ' Realizado por: Christian Gavis
    Public Function EsMonitoreoChip(ByVal placa As String, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsMonitoreoChip"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarPlacaObligatoria(ByVal rom As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPlacaObligatoria"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "rom", DbType.String, rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ValidarPlacaObligatoria(ByVal rom As String, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPlacaObligatoria"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarChipEmpleado(ByVal rom As String, Cara As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarChipEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ValidarTopeConsignacion(ByVal recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTopeConsignacionsobre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function EsVehiculoConCreditoSuspendido(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsVehiculoConCreditoSuspendido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteTarjetaConsumo(ByVal Numero As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteTarjetaConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteVehiculoLocal(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteVehiculoLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Valor As String = DB.ExecuteScalar(DatabaseCommand).ToString()

                Return CBool(Valor)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculo(ByVal idVehiculo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVehiculos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ValidarVehiculoGerenciamiento(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ActualizarInformacionCredito(ByVal placa As String, ByVal porcentajeCredito As Double, ByVal idFinanciera As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarInformacionCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "PorcentajeCredito", DbType.Double, porcentajeCredito)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarInformacionCreditoCombustible(ByVal placa As String, ByVal porcentajeCredito As Double, ByVal idFinanciera As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarInformacionCreditoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "PorcentajeCredito", DbType.Double, porcentajeCredito)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCausalBloqueo(ByVal placa As String, ByVal idCausalBloqueo As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCausalBloqueo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int16, idCausalBloqueo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCausalBloqueoCombustible(ByVal placa As String, ByVal idCausalBloqueo As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCausalBloqueoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int16, idCausalBloqueo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

 #Region "Venta"

    Public Function ESVehiculoConGerenciamiento(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarUltimoRecibo() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboFlotaTerpel() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboFlotaTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboGasStation() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboGasStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarUltimaAnulacionPgn() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaAnulacionPgn"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosVehiculoConGerenciamiento(ByVal placa As String, ByVal cara As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosVehiculoConGerenciamiento(ByVal placa As String, ByVal cara As Int16, ByVal RUC As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosVehiculoConGerenciamiento(ByVal identificacion As String, ByVal idProducto As Int32, ByVal tipoIdentificacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, tipoIdentificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDatosVehiculoConGerenciamiento(ByVal identificacion As String, ByVal idProducto As Int32, ByVal tipoIdentificacion As Int32, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, tipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosVehiculoConGerenciamientoFullstation(ByVal cara As Int16, ByVal idProducto As Int32, ByVal identificacion As String, ByVal tipoIdentificacion As Int32, ByVal RUC As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificacion", DbType.Int32, tipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarDatosVehiculoConGerenciamientoFullstation(ByVal cara As Int16, ByVal idProducto As Int32, ByVal identificacion As String, ByVal tipoIdentificacion As Int32, ByVal RUC As String, EsPrepago As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificacion", DbType.Int32, tipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarDatosVehiculoConGerenciamientoFullstation(ByVal cara As Int16, ByVal idProducto As Int32, ByVal identificacion As String, ByVal tipoIdentificacion As Int32,EsPrepago As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificacion", DbType.Int32, tipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Esprepago", DbType.Boolean, EsPrepago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarDatosVehiculoConGerenciamientoFullstation(ByVal cara As Int16, ByVal idProducto As Int32, ByVal identificacion As String, ByVal tipoIdentificacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoConGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificacion", DbType.Int32, tipoIdentificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function







    Public Function RecuperarVentaGerenciamiento(ByVal idGerencia As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdGerencia", DbType.Int32, idGerencia)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFechaRevisionVenta(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFechaRevisionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarFechaRevisionVenta(ByVal recibo As Int64, ByVal IdEstacion As Integer, Optional ByVal esVentaRegistrada As Boolean = True) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFechaRevisionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarPlacaParcialVenta(ByVal cara As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int64, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarVentaParcialGT(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal idManguera As Int16, ByVal saldoCredito As Decimal, ByVal valorPredeterminado As Decimal, ByVal IdFormaPago As Nullable(Of Short), ByVal kilometraje As String, ByVal autorizacion As String, ByVal esAutorizadoLocal As Boolean, ByVal nroAutorizacionManual As String, ByVal autorizacionCheque As String, ByVal descuentoValor As Decimal, ByVal descuentoPorcentaje As Decimal, ByVal PrecioGerenciadoCliente As Decimal, ByVal IdTipoVehiculo As Int32, ByVal TipoManejo As TipoManejo, ByVal ImprimirDescuento As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "EsAutorizadoLocal", DbType.Boolean, esAutorizadoLocal)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacionManual", DbType.String, nroAutorizacionManual)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, autorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "DescuentoValor", DbType.Decimal, descuentoValor)
        DB.AddInParameter(DatabaseCommand, "DescuentoPorcentaje", DbType.Decimal, descuentoPorcentaje)
        DB.AddInParameter(DatabaseCommand, "PrecioClienteGerenciado", DbType.Decimal, PrecioGerenciadoCliente)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "SaldoCredito", DbType.Decimal, saldoCredito)
        DB.AddInParameter(DatabaseCommand, "ValorPredeterminado", DbType.Decimal, valorPredeterminado)
        DB.AddInParameter(DatabaseCommand, "TipoManejo", DbType.Int32, TipoManejo)
        DB.AddInParameter(DatabaseCommand, "ImprimirDescuento", DbType.Boolean, ImprimirDescuento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarVentaParcialGT(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal idManguera As Int16, ByVal saldoCredito As Decimal, ByVal valorPredeterminado As Decimal, ByVal IdFormaPago As Nullable(Of Short), ByVal kilometraje As String, ByVal autorizacion As String, ByVal esAutorizadoLocal As Boolean, ByVal nroAutorizacionManual As String, ByVal autorizacionCheque As String, ByVal descuentoValor As Decimal, ByVal descuentoPorcentaje As Decimal, ByVal PrecioGerenciadoCliente As Decimal, ByVal IdTipoVehiculo As Int32, ByVal TipoManejo As TipoManejo, ByVal ImprimirDescuento As Boolean, ByVal Contrato As String, ByVal CentroCosto As String, ByVal NombreCentroCosto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "EsAutorizadoLocal", DbType.Boolean, esAutorizadoLocal)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacionManual", DbType.String, nroAutorizacionManual)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, autorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "DescuentoValor", DbType.Decimal, descuentoValor)
        DB.AddInParameter(DatabaseCommand, "DescuentoPorcentaje", DbType.Decimal, descuentoPorcentaje)
        DB.AddInParameter(DatabaseCommand, "PrecioClienteGerenciado", DbType.Decimal, PrecioGerenciadoCliente)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "SaldoCredito", DbType.Decimal, saldoCredito)
        DB.AddInParameter(DatabaseCommand, "ValorPredeterminado", DbType.Decimal, valorPredeterminado)
        DB.AddInParameter(DatabaseCommand, "TipoManejo", DbType.Int32, TipoManejo)
        DB.AddInParameter(DatabaseCommand, "ImprimirDescuento", DbType.Boolean, ImprimirDescuento)
        DB.AddInParameter(DatabaseCommand, "Contrato", DbType.String, Contrato)
        DB.AddInParameter(DatabaseCommand, "CentroCosto", DbType.String, CentroCosto)
        DB.AddInParameter(DatabaseCommand, "NombreCentroCosto", DbType.String, NombreCentroCosto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarVentaParcialGT(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal idManguera As Int16, ByVal saldoCredito As Decimal, ByVal valorPredeterminado As Decimal, ByVal IdEstacion As Integer, ByVal IdFormaPago As Nullable(Of Short), ByVal kilometraje As String, ByVal autorizacion As String, ByVal esAutorizadoLocal As Boolean, ByVal nroAutorizacionManual As String, ByVal autorizacionCheque As String, ByVal descuentoValor As Decimal, ByVal descuentoPorcentaje As Decimal, ByVal PrecioGerenciadoCliente As Decimal, ByVal IdTipoVehiculo As Int32, ByVal TipoManejo As TipoManejo, ByVal ImprimirDescuento As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "EsAutorizadoLocal", DbType.Boolean, esAutorizadoLocal)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacionManual", DbType.String, nroAutorizacionManual)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, autorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "DescuentoValor", DbType.Decimal, descuentoValor)
        DB.AddInParameter(DatabaseCommand, "DescuentoPorcentaje", DbType.Decimal, descuentoPorcentaje)
        DB.AddInParameter(DatabaseCommand, "PrecioClienteGerenciado", DbType.Decimal, PrecioGerenciadoCliente)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "SaldoCredito", DbType.Decimal, saldoCredito)
        DB.AddInParameter(DatabaseCommand, "ValorPredeterminado", DbType.Decimal, valorPredeterminado)
        DB.AddInParameter(DatabaseCommand, "TipoManejo", DbType.Int32, TipoManejo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarVentaParcialGTChile(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal idManguera As Int16, ByVal saldoCredito As Decimal, ByVal valorPredeterminado As Decimal, ByVal IdFormaPago As Nullable(Of Short), ByVal kilometraje As String, ByVal autorizacion As String, ByVal esAutorizadoLocal As Boolean, ByVal nroAutorizacionManual As String, ByVal autorizacionCheque As String, ByVal descuentoValor As Decimal, ByVal descuentoPorcentaje As Decimal, ByVal PrecioGerenciadoCliente As Decimal, ByVal IdTipoVehiculo As Int32, ByVal IdTipoDocumento As Int32, ByVal IdTipoCombustible As Int32, ByVal RUC As String, ByVal DocumentoPago As String, ByVal RazonSocial As String, ByVal Direccion As String, ByVal Giro As String, ByVal TipoIdentificacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "EsAutorizadoLocal", DbType.Boolean, esAutorizadoLocal)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacionManual", DbType.String, nroAutorizacionManual)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, autorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "DescuentoValor", DbType.Decimal, descuentoValor)
        DB.AddInParameter(DatabaseCommand, "DescuentoPorcentaje", DbType.Decimal, descuentoPorcentaje)
        DB.AddInParameter(DatabaseCommand, "PrecioClienteGerenciado", DbType.Decimal, PrecioGerenciadoCliente)
        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, IdTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "SaldoCredito", DbType.Decimal, saldoCredito)
        DB.AddInParameter(DatabaseCommand, "ValorPredeterminado", DbType.Decimal, valorPredeterminado)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumentoImpresora", DbType.Int32, IdTipoDocumento)
        DB.AddInParameter(DatabaseCommand, "IdTipoCombustible", DbType.Int32, IdTipoCombustible)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "DocumentoPago", DbType.String, DocumentoPago)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, Direccion)
        DB.AddInParameter(DatabaseCommand, "Giro", DbType.String, Giro)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificacion", DbType.Int32, TipoIdentificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarVentaCreditoManual(ByVal Recibo As Int64, ByVal Placa As String, ByVal AutorizacionCRM As String, ByVal Cara As Int16, ByVal SaldoDisponible As Decimal, ByVal IdFormaPAgo As Int16, ByVal Rom As String, ByVal NroGuiaDespacho As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaCreditoManual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCRM", DbType.String, AutorizacionCRM)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)
        DB.AddInParameter(DatabaseCommand, "SaldoDisponible", DbType.Decimal, SaldoDisponible)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPAgo)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "NroGuiaDespacho", DbType.String, NroGuiaDespacho)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarVentaParcial(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaParcialFullstation(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal IdFormaPago As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarVentaParcialFullstation(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal IdFormaPago As Int16, ByVal IdManguera As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, IdManguera)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaParcialFullstation(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal IdFormaPago As Int16, ByVal IdManguera As Integer, ByVal NumeroAutorizacionCheque As String, ByVal AutorizacionCRM As String, ByVal SaldoDisponible As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, IdManguera)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, NumeroAutorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCRM", DbType.String, AutorizacionCRM)
        DB.AddInParameter(DatabaseCommand, "SaldoDisponible", DbType.Decimal, SaldoDisponible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarVentaParcialFullstation(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String,
                                               ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal IdFormaPago As Int16, ByVal IdManguera As Integer,
                                               ByVal NumeroAutorizacionCheque As String, ByVal AutorizacionCRM As String, ByVal SaldoDisponible As Decimal,
                                               ByVal NroTarjeta As String, ByVal ValorPrepago As Double, ByVal Iva As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, IdManguera)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, NumeroAutorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCRM", DbType.String, AutorizacionCRM)
        DB.AddInParameter(DatabaseCommand, "SaldoDisponible", DbType.Decimal, SaldoDisponible)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, NroTarjeta)
        DB.AddInParameter(DatabaseCommand, "ValorPrepago", DbType.Decimal, ValorPrepago)
        DB.AddInParameter(DatabaseCommand, "Iva", DbType.Decimal, Iva)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaParcialFullstation(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal IdFormaPago As Int16, ByVal IdManguera As Integer, ByVal NumeroAutorizacionCheque As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, IdManguera)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, NumeroAutorizacionCheque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaParcialFullstation(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal IdFormaPago As Int16, ByVal IdManguera As Integer, ByVal NumeroAutorizacionCheque As String, ByVal NroTarjeta As String, ByVal ValorPrepago As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, IdManguera)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCheque", DbType.String, NumeroAutorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, NroTarjeta)
        DB.AddInParameter(DatabaseCommand, "ValorPrepago", DbType.Decimal, ValorPrepago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarVentaParcialGazel(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal Autorizacion As String, ByVal IdFormaPagoP As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, IdFormaPagoP)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaParcialPeruInd(ByVal cara As Int16, ByVal lecturaInicial As Nullable(Of Decimal), ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal Rom As String, ByVal Autorizacion As String, ByVal SaldoDisponible As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "SaldoDisponible", DbType.Decimal, SaldoDisponible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarFactoresCaras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFactoresCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarVentaParcialMexico(ByVal cara As Int16, ByVal lecturaInicial As Double, ByVal placa As String, ByVal fechaProximoMantenimiento As String, ByVal rom As String, ByVal contrato As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, lecturaInicial)
        If String.IsNullOrEmpty(fechaProximoMantenimiento) Then
            fechaProximoMantenimiento = "01/01/1900"
        End If
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.Date, CDate(fechaProximoMantenimiento))
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "Contrato", DbType.String, contrato)
        'DB.AddInParameter(DatabaseCommand, "Ecopeso", DbType.Decimal, ecopeso)

        'DB.AddInParameter(DatabaseCommand, "NumeroTarjeta", DbType.String, numeroTarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarVentaPeru(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal producto As Int32, ByVal idFormaPago As Short) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaPeru(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal nroVale As String, ByVal montoValePromocional As Decimal, ByVal nombrePromocion As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, nroVale)
        DB.AddInParameter(DatabaseCommand, "MontoVale", DbType.Decimal, montoValePromocional)
        DB.AddInParameter(DatabaseCommand, "NombrePromocion", DbType.String, nombrePromocion)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaPeru(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal EsPagoConBono As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)


        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Public Function InsertarVentaPeruFullStation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer) As Int64
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "InsertarVenta"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

    '    DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
    '    DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
    '    DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
    '    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
    '    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
    '    DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
    '    DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
    '    DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
    '    DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
    '    DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
    '    DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
    '    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
    '    DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
    '    DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
    '    DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)


    '    Dim Recibo As Int64
    '    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()

    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            DB.ExecuteNonQuery(DatabaseCommand)
    '            Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Function


    'Public Function InsertarVentaPeruFullStation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer) As Int64
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "InsertarVenta"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

    '    DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
    '    DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
    '    DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
    '    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
    '    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
    '    DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
    '    DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
    '    DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
    '    DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
    '    DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
    '    DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
    '    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
    '    DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
    '    DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
    '    DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
    '    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)

    '    Dim Recibo As Int64
    '    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()

    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            DB.ExecuteNonQuery(DatabaseCommand)
    '            Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Function


    'Public Function InsertarVentaPeruFullStation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As String, ByVal CodigoAutorizacion As Nullable(Of Integer)) As Int64
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "InsertarVenta"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

    '    DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
    '    DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
    '    DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
    '    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
    '    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
    '    DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
    '    DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
    '    DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
    '    DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
    '    DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
    '    DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
    '    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
    '    DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
    '    DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
    '    DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
    '    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
    '    DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)

    '    Dim Recibo As Int64
    '    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()

    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            DB.ExecuteNonQuery(DatabaseCommand)
    '            Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Function
    Public Function InsertarVentaChileFullStation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As String, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal RUTConductor As String, ByVal ConsumoMes As Double, NumeroContrato As String, TarjetaPrepago As String, FechaContratoPrepago As DateTime, KilometrajeCDC As String, EsPrepago As Boolean, Saldo As Decimal) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        If EsPrepago = False Then
            FechaContratoPrepago = Now
        End If


        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        DB.AddInParameter(DatabaseCommand, "RUTConductor", DbType.String, RUTConductor)
        DB.AddInParameter(DatabaseCommand, "ConsumoMes", DbType.Double, ConsumoMes)
        DB.AddInParameter(DatabaseCommand, "KilometrajeCDC", DbType.String, KilometrajeCDC)
        DB.AddInParameter(DatabaseCommand, "FechaContratoPrepago", DbType.DateTime, FechaContratoPrepago)
        DB.AddInParameter(DatabaseCommand, "TarjetaPrepago", DbType.String, TarjetaPrepago)
        DB.AddInParameter(DatabaseCommand, "NumeroContratoPrepago", DbType.String, NumeroContrato)
        DB.AddInParameter(DatabaseCommand, "EsPrepago", DbType.Boolean, EsPrepago)
        DB.AddInParameter(DatabaseCommand, "SaldoDisponiblePrepago", DbType.Decimal, Saldo)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaPeruFullStation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As String, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NroConfirmacion As String, ByVal RucDescuento As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, NroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "RucDescuento", DbType.String, RucDescuento)
        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintentoFullStation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NroConfirmacion As String, ByVal RucDescuento As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, NroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "RucDescuento", DbType.String, RucDescuento)
        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarVentaPeruFullstationBolivia(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NombreCliente As String, ByVal Pais As String, ByVal Autorizacion As String, ByVal NumeroPlaca As String, ByVal TipoEnvase As Integer, ByVal NumeroVale As String, ByVal numeroFactura As String, ByVal DUI As String, TAG As String, ByVal idempleado As String, ByVal tagRFID As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, TAG)
        DB.AddInParameter(DatabaseCommand, "IdEmpleadoAdministrador", DbType.String, idempleado)

        If CodigoAutorizacion.HasValue Then
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        Else
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, System.DBNull.Value)
        End If

        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPlaca", DbType.String, NumeroPlaca)
        DB.AddInParameter(DatabaseCommand, "IdTipoEnvase", DbType.Int32, TipoEnvase)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NumeroVale)
        DB.AddInParameter(DatabaseCommand, "NumeroFactura", DbType.String, numeroFactura)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))
        DB.AddInParameter(DatabaseCommand, "DUI", DbType.String, DUI)
        DB.AddInParameter(DatabaseCommand, "TagRFID", DbType.String, tagRFID)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarVentaPeruFullstationBolivia(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NombreCliente As String, ByVal Pais As String, ByVal Autorizacion As String, ByVal NumeroPlaca As String, ByVal TipoEnvase As Integer, ByVal NumeroVale As String, ByVal numeroFactura As String, ByVal DUI As String, TAG As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, TAG)

        If CodigoAutorizacion.HasValue Then
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        Else
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, System.DBNull.Value)
        End If

        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPlaca", DbType.String, NumeroPlaca)
        DB.AddInParameter(DatabaseCommand, "IdTipoEnvase", DbType.Int32, TipoEnvase)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NumeroVale)
        DB.AddInParameter(DatabaseCommand, "NumeroFactura", DbType.String, numeroFactura)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))
        DB.AddInParameter(DatabaseCommand, "DUI", DbType.String, DUI)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaPeruFullstationBolivia(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NombreCliente As String, ByVal Pais As String, ByVal Autorizacion As String, ByVal NumeroPlaca As String, ByVal TipoEnvase As Integer, ByVal NumeroVale As String, ByVal numeroFactura As String, ByVal DUI As String, TAG As String, ByVal idempleado As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, TAG)
        DB.AddInParameter(DatabaseCommand, "IdEmpleadoAdministrador", DbType.String, idempleado)

        If CodigoAutorizacion.HasValue Then
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        Else
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, System.DBNull.Value)
        End If

        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPlaca", DbType.String, NumeroPlaca)
        DB.AddInParameter(DatabaseCommand, "IdTipoEnvase", DbType.Int32, TipoEnvase)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NumeroVale)
        DB.AddInParameter(DatabaseCommand, "NumeroFactura", DbType.String, numeroFactura)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))
        DB.AddInParameter(DatabaseCommand, "DUI", DbType.String, DUI)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintentoFSBolivia(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NombreCliente As String, ByVal Pais As String, ByVal Autorizacion As String, ByVal NumeroPlaca As String, ByVal TipoEnvase As Integer, ByVal NumeroVale As String, ByVal numeroFactura As String, Tag As String, ByVal IdEmpleado As String, ByVal tagRFID As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, Tag)
        DB.AddInParameter(DatabaseCommand, "IdEmpleadoAdministrador", DbType.String, IdEmpleado)
        DB.AddInParameter(DatabaseCommand, "TagRFID", DbType.String, tagRFID)

        If CodigoAutorizacion.HasValue Then
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        Else
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, System.DBNull.Value)
        End If

        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPlaca", DbType.String, NumeroPlaca)
        DB.AddInParameter(DatabaseCommand, "IdTipoEnvase", DbType.Int32, TipoEnvase)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NumeroVale)
        DB.AddInParameter(DatabaseCommand, "NumeroFactura", DbType.String, numeroFactura)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarVentaReintentoFSBolivia(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NombreCliente As String, ByVal Pais As String, ByVal Autorizacion As String, ByVal NumeroPlaca As String, ByVal TipoEnvase As Integer, ByVal NumeroVale As String, ByVal numeroFactura As String, Tag As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, Tag)

        If CodigoAutorizacion.HasValue Then
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        Else
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, System.DBNull.Value)
        End If

        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPlaca", DbType.String, NumeroPlaca)
        DB.AddInParameter(DatabaseCommand, "IdTipoEnvase", DbType.Int32, TipoEnvase)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NumeroVale)
        DB.AddInParameter(DatabaseCommand, "NumeroFactura", DbType.String, numeroFactura)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintentoFSBolivia(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal documentoAux As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer, ByVal LecturaInicial As Decimal, ByVal EsPagoConBono As Boolean, ByVal IdFranquicia As Integer, ByVal Kilometraje As Integer, ByVal CodigoAutorizacion As Nullable(Of Integer), ByVal NombreCliente As String, ByVal Pais As String, ByVal Autorizacion As String, ByVal NumeroPlaca As String, ByVal TipoEnvase As Integer, ByVal NumeroVale As String, ByVal numeroFactura As String, Tag As String, ByVal IdEmpleado As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialVenta", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, Tag)
        DB.AddInParameter(DatabaseCommand, "IdEmpleadoAdministrador", DbType.String, IdEmpleado)

        If CodigoAutorizacion.HasValue Then
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, CodigoAutorizacion)
        Else
            DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionCredito", DbType.Int32, System.DBNull.Value)
        End If

        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPlaca", DbType.String, NumeroPlaca)
        DB.AddInParameter(DatabaseCommand, "IdTipoEnvase", DbType.Int32, TipoEnvase)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NumeroVale)
        DB.AddInParameter(DatabaseCommand, "NumeroFactura", DbType.String, numeroFactura)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarVentaReintentoPeru(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal producto As Int32, ByVal idFormaPago As Short) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)


        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintentoPeru(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal nroVale As String, ByVal montoValePromocional As Decimal, ByVal nombrePromocion As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, nroVale)
        DB.AddInParameter(DatabaseCommand, "MontoVale", DbType.Decimal, montoValePromocional)
        DB.AddInParameter(DatabaseCommand, "NombrePromocion", DbType.String, nombrePromocion)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintentoPeru(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal EsPagoConBono As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)


        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintentoPeruFullStation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal tipoDocumento As Integer, ByVal documento As String, ByVal producto As Int32, ByVal idFormaPago As Short, ByVal TipoIdentificacion As Integer, ByVal manguera As Integer) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, tipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)


        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaMexico(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal numeroTarjeta As String, ByVal ecopeso As Decimal) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "NumeroTarjeta", DbType.String, numeroTarjeta)
        DB.AddInParameter(DatabaseCommand, "Ecopeso", DbType.Decimal, ecopeso)
        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub FidelizarVentaPeru(ByVal recibo As Int64, ByVal idRedFidelizacion As Short, ByVal numero As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FidelizarVentaPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "RedFidelizacion", DbType.Int32, idRedFidelizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub FidelizarVentaCanastilla(ByVal recibo As Int64, ByVal idRedFidelizacion As Short, ByVal numero As String, ByVal IdTipoIdentificacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FidelizarVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "RedFidelizacion", DbType.Int32, idRedFidelizacion)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, IdTipoIdentificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub FidelizarVenta(ByVal recibo As Int64, ByVal idRedFidelizacion As Short, ByVal numero As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FidelizarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "RedFidelizacion", DbType.Int32, idRedFidelizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarVentaGazel(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal presionLLenado As Decimal, ByVal descuentoPromocionalCliente As Decimal, ByVal esPorcentualPromocionCliente As Boolean, ByVal idDescuentoPromocionalCliente As Nullable(Of Int32), ByVal EsVentaFidelizada As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "PresionLLenado", DbType.Decimal, presionLLenado)
        DB.AddInParameter(DatabaseCommand, "DescuentoPromocionalC", DbType.Decimal, descuentoPromocionalCliente)
        DB.AddInParameter(DatabaseCommand, "EsPorcentualPromocionC", DbType.Boolean, esPorcentualPromocionCliente)
        DB.AddInParameter(DatabaseCommand, "IdDescuentoPromocionalC", DbType.Int32, idDescuentoPromocionalCliente)
        DB.AddInParameter(DatabaseCommand, "EsVentaFidelizada", DbType.Boolean, EsVentaFidelizada)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub InsertarVentaGasStation(ByVal Recibo As Int64, ByVal Fecha As DateTime, ByVal HoraInicio As DateTime, ByVal HoraFin As DateTime, ByVal Placa As String, ByVal Precio As Int32, ByVal Cantidad As Decimal, ByVal Valor As Decimal, ByVal AbonoCredito As Decimal, ByVal Descuento As Decimal, ByVal ProximoMantimiento As DateTime, ByVal Apertura As DateTime, ByVal NumeroTurno As Int16, ByVal NombreEmpleado As String, ByVal NombreProducto As String, ByVal Cara As String, ByVal Surtidor As String, ByVal DocumentoCliente As String, ByVal NombreCliente As String, ByVal NumeroTarjetaFidelizada As String, ByVal IdTurno As Int32, ByVal IdManguera As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGasStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.DateTime, HoraInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.DateTime, HoraFin)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Int32, Precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "AbonoCredito", DbType.Decimal, AbonoCredito)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "Descuento", DbType.Decimal, Descuento)
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.DateTime, ProximoMantimiento)
        DB.AddInParameter(DatabaseCommand, "Apertura", DbType.DateTime, Apertura)
        DB.AddInParameter(DatabaseCommand, "NumeroTurno", DbType.Int16, NumeroTurno)
        DB.AddInParameter(DatabaseCommand, "NombreEmpleado", DbType.String, NombreEmpleado)
        DB.AddInParameter(DatabaseCommand, "NombreProducto", DbType.String, NombreProducto)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, Cara)
        DB.AddInParameter(DatabaseCommand, "Surtidor", DbType.String, Surtidor)
        DB.AddInParameter(DatabaseCommand, "DocumentoCliente", DbType.String, DocumentoCliente)
        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "TarjetaFidelizada", DbType.String, NumeroTarjetaFidelizada)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaGasStation(ByVal Recibo As Int64, ByVal Fecha As DateTime, ByVal HoraInicio As DateTime, ByVal HoraFin As DateTime, ByVal Placa As String, ByVal Precio As Int32, ByVal Cantidad As Decimal, ByVal Valor As Decimal, ByVal AbonoCredito As Decimal, ByVal Descuento As Decimal, ByVal ProximoMantimiento As DateTime, ByVal Apertura As DateTime, ByVal NumeroTurno As Int16, ByVal NombreEmpleado As String, ByVal NombreProducto As String, ByVal Cara As String, ByVal Surtidor As String, ByVal DocumentoCliente As String, ByVal NombreCliente As String, ByVal NumeroTarjetaFidelizada As String, ByVal IdTurno As Int32, ByVal IdManguera As Int16, ByVal LecturaInicial As Decimal, ByVal LecturaFinal As Decimal, ByVal RUC As String, ByVal NumeroDocumento As String, ByVal Numero As String, ByVal SerialImpresora As String, ByVal Serie As String, ByVal Igv As Decimal, ByVal BaseImponible As Decimal, ByVal Estado As String, ByVal IdDocumento As Int64, ByVal Impresora As String, ByVal RazonSocial As String, ByVal TipoDocumento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracionB
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGasStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.DateTime, HoraInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.DateTime, HoraFin)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Int32, Precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "AbonoCredito", DbType.Decimal, AbonoCredito)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "Descuento", DbType.Decimal, Descuento)
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.DateTime, ProximoMantimiento)
        DB.AddInParameter(DatabaseCommand, "Apertura", DbType.DateTime, Apertura)
        DB.AddInParameter(DatabaseCommand, "NumeroTurno", DbType.Int16, NumeroTurno)
        DB.AddInParameter(DatabaseCommand, "NombreEmpleado", DbType.String, NombreEmpleado)
        DB.AddInParameter(DatabaseCommand, "NombreProducto", DbType.String, NombreProducto)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.String, Cara)
        DB.AddInParameter(DatabaseCommand, "Surtidor", DbType.String, Surtidor)
        DB.AddInParameter(DatabaseCommand, "DocumentoCliente", DbType.String, DocumentoCliente)
        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "TarjetaFidelizada", DbType.String, NumeroTarjetaFidelizada)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)

        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, LecturaFinal)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroDocumento", DbType.String, NumeroDocumento)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        DB.AddInParameter(DatabaseCommand, "SerialImpresora", DbType.String, SerialImpresora)
        DB.AddInParameter(DatabaseCommand, "Serie", DbType.String, Serie)
        DB.AddInParameter(DatabaseCommand, "Igv", DbType.Decimal, Igv)
        DB.AddInParameter(DatabaseCommand, "BaseImponible", DbType.Decimal, BaseImponible)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.String, Estado)
        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int64, IdDocumento)
        DB.AddInParameter(DatabaseCommand, "Impresora", DbType.String, Impresora)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.String, TipoDocumento)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function InsertarVentaGasoNet(ByVal cara As Int16, ByVal CodigoPreautorizacion As String, ByVal CodigoConfirmacion As String, ByVal MensajePreautorizacion As String, ByVal MensajeConfirmacion As String,
                                  ByVal FechaAprobacion As String, ByVal FechaConfirmacion As String, ByVal NumeroPreautorizacion As String, ByVal NumeroConfirmacion As String, ByVal ValorConfirmacion As Decimal,
                                  ByVal ValorAutorizado As String, ByVal Recibo As String, ByVal Estado As Int32, ByVal PlacaGasoNet As String, ByVal NombreCliente As String, ByVal Tarjeta As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGasoNet"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "CodigoPreautorizacion", DbType.String, CodigoPreautorizacion)
        DB.AddInParameter(DatabaseCommand, "CodigoConfirmacion", DbType.String, CodigoConfirmacion)
        DB.AddInParameter(DatabaseCommand, "MensajePreautorizacion", DbType.String, MensajePreautorizacion)
        DB.AddInParameter(DatabaseCommand, "MensajeConfirmacion", DbType.String, MensajeConfirmacion)
        DB.AddInParameter(DatabaseCommand, "FechaAprobacion", DbType.DateTime, FechaAprobacion)
        DB.AddInParameter(DatabaseCommand, "FechaConfirmacion", DbType.DateTime, FechaConfirmacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPreautorizacion", DbType.String, NumeroPreautorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroConfirmacion", DbType.String, NumeroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "ValorConfirmacion", DbType.Decimal, ValorConfirmacion)
        DB.AddInParameter(DatabaseCommand, "ValorAutorizado", DbType.Decimal, ValorAutorizado)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.String, Recibo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, Estado)
        DB.AddInParameter(DatabaseCommand, "PlacaGasoNet", DbType.String, PlacaGasoNet)
        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Tarjeta", DbType.String, Tarjeta)
        Dim IdVentaGasoNet As Int32
        DB.AddOutParameter(DatabaseCommand, "IdVentaGasoNet", DbType.Int32, CInt(IdVentaGasoNet))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdVentaGasoNet"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarActualizarVentaGasoNet(ByVal cara As Int32, ByVal CodigoPreautorizacion As String, ByVal CodigoConfirmacion As String, ByVal MensajePreautorizacion As String, ByVal MensajeConfirmacion As String,
                                  ByVal FechaAprobacion As String, ByVal FechaConfirmacion As String, ByVal NumeroPreautorizacion As String, ByVal NumeroConfirmacion As String, ByVal ValorConfirmacion As Decimal,
                                  ByVal ValorAutorizado As Decimal, ByVal Recibo As String, ByVal Estado As Int32, ByVal PlacaGasoNet As String, ByVal NombreCliente As String, ByVal Tarjeta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarActualizarVentaGasoNet"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int32, cara)
        DB.AddInParameter(DatabaseCommand, "CodigoPreautorizacion", DbType.String, CodigoPreautorizacion)
        DB.AddInParameter(DatabaseCommand, "CodigoConfirmacion", DbType.String, CodigoConfirmacion)
        DB.AddInParameter(DatabaseCommand, "MensajePreautorizacion", DbType.String, MensajePreautorizacion)
        DB.AddInParameter(DatabaseCommand, "MensajeConfirmacion", DbType.String, MensajeConfirmacion)
        DB.AddInParameter(DatabaseCommand, "FechaAprobacion", DbType.DateTime, FechaAprobacion)
        DB.AddInParameter(DatabaseCommand, "FechaConfirmacion", DbType.DateTime, FechaConfirmacion)
        DB.AddInParameter(DatabaseCommand, "NumeroPreautorizacion", DbType.String, NumeroPreautorizacion)
        DB.AddInParameter(DatabaseCommand, "NumeroConfirmacion", DbType.String, NumeroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "ValorConfirmacion", DbType.Decimal, ValorConfirmacion)
        DB.AddInParameter(DatabaseCommand, "ValorAutorizado", DbType.Decimal, ValorAutorizado)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.String, Recibo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, Estado)
        DB.AddInParameter(DatabaseCommand, "PlacaGasoNet", DbType.String, PlacaGasoNet)
        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, NombreCliente)
        DB.AddInParameter(DatabaseCommand, "Tarjeta", DbType.String, Tarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarVenta(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal cantidad As Decimal, ByVal valor As Decimal, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal manguera As Integer, ByVal kilometraje As String, ByVal documento As String, ByVal documentoAux As String, ByVal TipoIdentificacion As Integer, ByVal idFormaPago As Short, ByVal Nivel As String, ByVal placaSegundaria As String, Optional ByVal EsPagoConBono As Boolean = False) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Nivel", DbType.String, Nivel)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)

        DB.AddInParameter(DatabaseCommand, "PlacaAuxiliar", DbType.String, placaSegundaria)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function InsertarVentaReintentoSauce(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal cantidad As Decimal, ByVal valor As Decimal, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal manguera As Integer, ByVal kilometraje As String, ByVal documento As String, ByVal documentoAux As String, ByVal TipoIdentificacion As Integer, ByVal idFormaPago As Short, Optional ByVal EsPagoConBono As Boolean = False) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, documentoAux)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "EsPagoConBono", DbType.Boolean, EsPagoConBono)
        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaFullstation(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal cantidad As Decimal, ByVal valor As Decimal, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal manguera As Integer, ByVal kilometraje As String, ByVal idFormaPagoP As Int16, ByVal autorizacion As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPagoP)
        DB.AddInParameter(DatabaseCommand, "AutorizacionCDC", DbType.String, autorizacion)
        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'INSERTAR VENTA UTILIZADO EN HADIGT
    Public Function InsertarVentaGT(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal cantidad As Decimal, ByVal valor As Decimal, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal presionLLenado As Decimal, ByVal manguera As Integer, ByVal lecturaInicialSurtidor As Decimal) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DatabaseCommand.CommandTimeout = 600
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "PresionLLenado", DbType.Decimal, presionLLenado)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialSurtidor", DbType.Decimal, lecturaInicialSurtidor)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function InsertarVentaGT(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal cantidad As Decimal, ByVal valor As Decimal, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal presionLLenado As Decimal, ByVal manguera As Integer, ByVal lecturaInicialSurtidor As Decimal, ByVal IdEstacion As Integer) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "PresionLLenado", DbType.Decimal, presionLLenado)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialSurtidor", DbType.Decimal, lecturaInicialSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaGTRecuperada(ByVal manguera As Int16, ByVal cantidad As Decimal, ByVal formasPago As Dictionary(Of Integer, Decimal), ByVal placa As String, ByVal kilometraje As String, ByVal GUID As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGTRecuperada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim Recibo As Int64


        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
                    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
                    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
                    DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUID)
                    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
                    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

                    'Ejecuta el Procedimiento Almacenado InsertarVentaGTRecuperada
                    DB.ExecuteNonQuery(DatabaseCommand)
                    Recibo = CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))

                    DatabaseCommand.CommandText = "InsertarVentaFormaPago"
                    DatabaseCommand.Parameters.Clear()

                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
                    DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16)
                    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                    DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Nothing)
                    DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, Nothing)
                    DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, Nothing)

                    For Each idFormaPago As Int16 In formasPago.Keys
                        DB.SetParameterValue(DatabaseCommand, "IdFormaPago", idFormaPago)
                        DB.SetParameterValue(DatabaseCommand, "Valor", formasPago(idFormaPago))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                    Next

                    DatabaseCommand.CommandText = "ActualizarVentaRecuperada"
                    DatabaseCommand.Parameters.Clear()
                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

                    'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                    DB.ExecuteNonQuery(DatabaseCommand)

                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

                Return Recibo
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaGTRecuperadaFullStation(ByVal manguera As Int16, ByVal cantidad As Decimal, ByVal formasPago As Dictionary(Of Integer, Decimal), ByVal placa As String, ByVal kilometraje As String, ByVal GUID As String, ByVal IdTurno As Int32, IdBloqueo As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGTRecuperadaFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim Recibo As Int64


        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
                    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
                    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
                    DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUID)
                    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
                    DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, IdTurno)
                    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))
                    DB.AddInParameter(DatabaseCommand, "IdBloqueo", DbType.String, IdBloqueo)

                    'Ejecuta el Procedimiento Almacenado InsertarVentaGTRecuperada
                    DB.ExecuteNonQuery(DatabaseCommand)
                    Recibo = CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))


                    If CBool(RecuperarParametro("BloquearManguerasVentasFueraSistema")) Then
                        DatabaseCommand.CommandText = "InsertarVentaFormaPago"
                        DatabaseCommand.Parameters.Clear()
                    Else
                        DatabaseCommand.CommandText = "InsertarVentaRecuperadaFormaPago"
                        DatabaseCommand.Parameters.Clear()
                    End If

                    'DatabaseCommand.CommandText = "InsertarVentaRecuperadaFormaPago"
                    'DatabaseCommand.Parameters.Clear()

                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
                    DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16)
                    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                    DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Nothing)
                    DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, Nothing)
                    DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, Nothing)

                    For Each idFormaPago As Int16 In formasPago.Keys
                        DB.SetParameterValue(DatabaseCommand, "IdFormaPago", idFormaPago)
                        DB.SetParameterValue(DatabaseCommand, "Valor", formasPago(idFormaPago))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                    Next

                    DatabaseCommand.CommandText = "ActualizarVentaRecuperada"
                    DatabaseCommand.Parameters.Clear()
                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

                    'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                    DB.ExecuteNonQuery(DatabaseCommand)

                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

                Return Recibo
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function InsertarVentaGTRecuperadaFullStation(ByVal manguera As Int16, ByVal cantidad As Decimal, ByVal formasPago As Dictionary(Of Integer, Decimal), ByVal placa As String, ByVal kilometraje As String, ByVal GUID As String, ByVal IdTurno As Integer, ByVal Ruc As String, ByVal EsVentaCredito As Boolean, ByVal Credito As String, ByVal TipoDocumento As Int32) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGTRecuperadaFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim Recibo As Int64


        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
                    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
                    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
                    DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUID)
                    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
                    DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
                    DB.AddInParameter(DatabaseCommand, "EsVentaCredito", DbType.Boolean, EsVentaCredito)
                    DB.AddInParameter(DatabaseCommand, "Rut", DbType.String, Ruc)
                    DB.AddInParameter(DatabaseCommand, "NroCredito", DbType.String, Credito)
                    DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, TipoDocumento)
                    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))


                    'Ejecuta el Procedimiento Almacenado InsertarVentaGTRecuperada
                    DB.ExecuteNonQuery(DatabaseCommand)
                    Recibo = CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))


                    If CBool(RecuperarParametro("BloquearManguerasVentasFueraSistema")) Then
                        DatabaseCommand.CommandText = "InsertarVentaFormaPago"
                        DatabaseCommand.Parameters.Clear()
                    Else
                        DatabaseCommand.CommandText = "InsertarVentaRecuperadaFormaPago"
                        DatabaseCommand.Parameters.Clear()
                    End If

                    'DatabaseCommand.CommandText = "InsertarVentaRecuperadaFormaPago"
                    'DatabaseCommand.Parameters.Clear()

                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
                    DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16)
                    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                    DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Nothing)
                    DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, Nothing)
                    DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, Nothing)

                    For Each idFormaPago As Int16 In formasPago.Keys
                        DB.SetParameterValue(DatabaseCommand, "IdFormaPago", idFormaPago)
                        DB.SetParameterValue(DatabaseCommand, "Valor", formasPago(idFormaPago))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                    Next

                    DatabaseCommand.CommandText = "ActualizarVentaRecuperada"
                    DatabaseCommand.Parameters.Clear()
                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

                    'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                    DB.ExecuteNonQuery(DatabaseCommand)

                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

                Return Recibo
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function














    Public Function InsertarVentaGTRecuperadaPeru(ByVal manguera As Int16, ByVal cantidad As Decimal, ByVal formasPago As Dictionary(Of Integer, Decimal), ByVal placa As String, ByVal kilometraje As String, ByVal GUID As String, ByVal EsVentaCredito As Boolean, ByVal Rut As String, ByVal NroCredito As String, ByVal TipoDocumento As Int32) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGTRecuperada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim Recibo As Int64

        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
                    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
                    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
                    DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUID)
                    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
                    DB.AddInParameter(DatabaseCommand, "EsVentaCredito", DbType.Boolean, EsVentaCredito)
                    DB.AddInParameter(DatabaseCommand, "Rut", DbType.String, Rut)
                    DB.AddInParameter(DatabaseCommand, "NroCredito", DbType.String, NroCredito)
                    DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, TipoDocumento)
                    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

                    DB.ExecuteNonQuery(DatabaseCommand)
                    Recibo = CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))

                    DatabaseCommand.CommandText = "InsertarVentaFormaPago"
                    DatabaseCommand.Parameters.Clear()


                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
                    DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16)
                    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                    DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Nothing)
                    DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, Nothing)
                    DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, Nothing)

                    For Each idFormaPago As Int16 In formasPago.Keys
                        DB.SetParameterValue(DatabaseCommand, "IdFormaPago", idFormaPago)
                        DB.SetParameterValue(DatabaseCommand, "Valor", formasPago(idFormaPago))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                    Next

                    DatabaseCommand.CommandText = "ActualizarVentaRecuperada"
                    DatabaseCommand.Parameters.Clear()
                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

                    'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                    DB.ExecuteNonQuery(DatabaseCommand)

                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

                Return Recibo
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaGTRecuperada(ByVal manguera As Int16, ByVal cantidad As Decimal, ByVal formasPago As Dictionary(Of Integer, Decimal), ByVal placa As String, ByVal kilometraje As String, ByVal GUID As String, ByVal idEstacion As Int16) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGTRecuperada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim Recibo As Int64


        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
                    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
                    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
                    DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUID)
                    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
                    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))
                    DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
                    'Ejecuta el Procedimiento Almacenado InsertarVentaGTRecuperada
                    DB.ExecuteNonQuery(DatabaseCommand)
                    Recibo = CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))

                    DatabaseCommand.CommandText = "InsertarVentaFormaPago"
                    DatabaseCommand.Parameters.Clear()

                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
                    DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16)
                    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                    DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Nothing)
                    DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, Nothing)
                    DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, Nothing)

                    For Each idFormaPago As Int16 In formasPago.Keys
                        DB.SetParameterValue(DatabaseCommand, "IdFormaPago", idFormaPago)
                        DB.SetParameterValue(DatabaseCommand, "Valor", formasPago(idFormaPago))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                    Next

                    DatabaseCommand.CommandText = "ActualizarVentaRecuperada"
                    DatabaseCommand.Parameters.Clear()
                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

                    'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                    DB.ExecuteNonQuery(DatabaseCommand)

                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

                Return Recibo
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaGTRecuperadaChile(ByVal manguera As Int16, ByVal cantidad As Decimal, ByVal formasPago As Dictionary(Of Integer, Decimal), ByVal placa As String, ByVal kilometraje As String, ByVal GUID As String, ByVal TipoDocumento As Int32, ByVal NumeroDocumento As Int64, ByVal RazonSocial As String, ByVal Direccion As String, ByVal Giro As String, ByVal Ruc As String, ByVal NroGuia As String, ByVal EsVentaCredito As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaGTRecuperada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing
        Dim Recibo As Int64

        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
                    DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
                    DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
                    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
                    DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUID)
                    DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
                    DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))
                    DB.AddInParameter(DatabaseCommand, "NumeroDocumento", DbType.Int64, CInt(NumeroDocumento))
                    DB.AddInParameter(DatabaseCommand, "TipoDocumento", DbType.Int32, TipoDocumento)
                    DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
                    DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, Direccion)
                    DB.AddInParameter(DatabaseCommand, "Giro", DbType.String, Giro)
                    DB.AddInParameter(DatabaseCommand, "NroGuia", DbType.String, NroGuia)
                    DB.AddInParameter(DatabaseCommand, "EsVentaCredito", DbType.Boolean, EsVentaCredito)

                    'Ejecuta el Procedimiento Almacenado InsertarVentaGTRecuperada
                    DB.ExecuteNonQuery(DatabaseCommand)
                    Recibo = CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))

                    DatabaseCommand.CommandText = "InsertarVentaFormaPago"
                    DatabaseCommand.Parameters.Clear()

                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
                    DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16)
                    DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal)
                    DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Nothing)
                    DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, Nothing)
                    DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, Nothing)

                    For Each idFormaPago As Int16 In formasPago.Keys
                        DB.SetParameterValue(DatabaseCommand, "IdFormaPago", idFormaPago)
                        DB.SetParameterValue(DatabaseCommand, "Valor", formasPago(idFormaPago))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                    Next

                    DatabaseCommand.CommandText = "ActualizarVentaRecuperada"
                    DatabaseCommand.Parameters.Clear()
                    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

                    'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                    DB.ExecuteNonQuery(DatabaseCommand)

                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

                Return Recibo
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintento(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal idFormaPagoP As Int16, ByVal autorizacion As String, ByVal presionLLenado As Decimal, ByVal descuentoPromocionalCliente As Decimal, ByVal esPorcentualPromocionCliente As Boolean, ByVal idDescuentoPromocionalCliente As Nullable(Of Int32), ByVal EsVentaFidelizada As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "IdFormaPagoP", DbType.Int16, idFormaPagoP)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, autorizacion)
        DB.AddInParameter(DatabaseCommand, "PresionLLenado", DbType.Decimal, presionLLenado)
        DB.AddInParameter(DatabaseCommand, "DescuentoPromocionalC", DbType.Decimal, descuentoPromocionalCliente)
        DB.AddInParameter(DatabaseCommand, "EsPorcentualPromocionC", DbType.Boolean, esPorcentualPromocionCliente)
        DB.AddInParameter(DatabaseCommand, "IdDescuentoPromocionalC", DbType.Int32, idDescuentoPromocionalCliente)
        DB.AddInParameter(DatabaseCommand, "EsVentaFidelizada", DbType.Boolean, EsVentaFidelizada)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarVentaReintentoGazel(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As String, ByVal cantidad As Double, ByVal valor As Double, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal presionLLenado As Decimal, ByVal descuentoPromocionalCliente As Decimal, ByVal esPorcentualPromocionCliente As Boolean, ByVal idDescuentoPromocionalCliente As Nullable(Of Int32), ByVal EsVentaFidelizada As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "PresionLLenado", DbType.Decimal, presionLLenado)
        DB.AddInParameter(DatabaseCommand, "DescuentoPromocionalC", DbType.Decimal, descuentoPromocionalCliente)
        DB.AddInParameter(DatabaseCommand, "EsPorcentualPromocionC", DbType.Boolean, esPorcentualPromocionCliente)
        DB.AddInParameter(DatabaseCommand, "IdDescuentoPromocionalC", DbType.Int32, idDescuentoPromocionalCliente)
        DB.AddInParameter(DatabaseCommand, "EsVentaFidelizada", DbType.Boolean, EsVentaFidelizada)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'INSERTAR VENTA REINTENTO UTILIZADO EN HADIGT
    Public Function InsertarVentaReintentoGT(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal cantidad As Decimal, ByVal valor As Decimal, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal presionLLenado As Decimal, ByVal manguera As Integer, ByVal lecturaInicialSurtidor As Decimal) As Int64

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 600

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "PresionLLenado", DbType.Decimal, presionLLenado)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialSurtidor", DbType.Decimal, lecturaInicialSurtidor)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarVentaReintentoGT(ByVal cara As Int16, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal cantidad As Decimal, ByVal valor As Decimal, ByVal producto As Int32, ByVal GUIDVenta As String, ByVal presionLLenado As Decimal, ByVal manguera As Integer, ByVal lecturaInicialSurtidor As Decimal, ByVal IdEstacion As Integer) As Int64

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaReintento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, manguera)
        DB.AddInParameter(DatabaseCommand, "PresionLLenado", DbType.Decimal, presionLLenado)
        DB.AddInParameter(DatabaseCommand, "LecturaInicialSurtidor", DbType.Decimal, lecturaInicialSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Dim Recibo As Int64
        DB.AddOutParameter(DatabaseCommand, "Recibo", DbType.Int64, CInt(Recibo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "Recibo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Sub InsertarImagenesVentas()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImagenesVentas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarImagenesVentas(ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarImagenesVentas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaFormaPagoTmp(ByVal recibo As Int64, ByVal idFormaPago As Int16, ByVal valor As Double, ByVal documento As String, ByVal tipoLectura As Nullable(Of Int32), ByVal nroConfirmacion As String, ByVal MontoMedioPago As Double, ByVal borrarTemporal As Boolean, ByVal NumAutorizacionCheque As Nullable(Of Long), ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaFormaPagoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "MontoReal", DbType.Double, MontoMedioPago)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, tipoLectura)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, nroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)
        DB.AddInParameter(DatabaseCommand, "NumAutorizacionCheque", DbType.Int64, NumAutorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub InsertarVentaFormaPagoTmpChile(ByVal recibo As Int64, ByVal idFormaPago As Int16, ByVal valor As Double, ByVal documento As String, ByVal tipoLectura As Nullable(Of Int32), ByVal nroConfirmacion As String, ByVal MontoMedioPago As Double, ByVal borrarTemporal As Boolean, ByVal NumAutorizacionCheque As Nullable(Of Long), ByVal Placa As String, ByVal NumeroCheque As String, ByVal NumeroValidacion As String, ByVal RUT As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaFormaPagoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "MontoReal", DbType.Double, MontoMedioPago)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, tipoLectura)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, nroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)
        DB.AddInParameter(DatabaseCommand, "NumAutorizacionCheque", DbType.Int64, NumAutorizacionCheque)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "NumeroCheque", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "NumeroValidacion", DbType.String, NumeroValidacion)
        DB.AddInParameter(DatabaseCommand, "RUT", DbType.String, RUT)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Sub InsertarVentaFormaPagoCanastillaTmp(ByVal recibo As Int64, ByVal idFormaPago As Int16, ByVal valor As Double, ByVal referencia As String, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaFormaPagoCanastillaTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Referencia", DbType.String, referencia)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaFormaPago(ByVal recibo As Int64, ByVal idFormaPago As Int16, ByVal valor As Double, ByVal documento As String, ByVal tipoLectura As Nullable(Of Int32), ByVal nroConfirmacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "TipoLectura", DbType.Int32, tipoLectura)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, nroConfirmacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarVenta(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarVenta(ByVal recibo As Int64, ByVal idVehiculo As Int32, ByVal idFormaPago As Int16, ByVal fechaHora As Date, ByVal idTurno As Int32, ByVal idManguera As Int16, ByVal horaInicio As Date, ByVal horaFin As Date, ByVal lecturaInicial As Double, ByVal lecturaFinal As Double, ByVal precio As Int32, ByVal iva As Double, ByVal abonoCredito As Double, ByVal idCliente As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "FechaHora", DbType.Date, fechaHora)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.Date, horaInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.Date, horaFin)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Double, lecturaInicial)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Double, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Int32, precio)
        DB.AddInParameter(DatabaseCommand, "Iva", DbType.Double, iva)
        DB.AddInParameter(DatabaseCommand, "AbonoCredito", DbType.Double, abonoCredito)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ValidarVentaCreditoManual(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentaCreditoManual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ValidarVentaFormaPago(ByVal recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVehiculoPorTag(ByVal tag As String) As VehiculoANH
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoPorTag"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tag", DbType.String, tag)
        Dim DatosVehiculo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DatosVehiculo = DB.ExecuteReader(DatabaseCommand)
                If DatosVehiculo.Read Then
                    Dim vehiculo As New VehiculoANH
                    vehiculo.FechaActualizacion = CDate(DatosVehiculo("FechaActualizacion"))
                    vehiculo.Imagen = DatosVehiculo("Imagen").ToString
                    vehiculo.Placa = DatosVehiculo("Placa").ToString
                    Return vehiculo
                End If


            Catch
                Throw
            Finally
                DatosVehiculo.Close()
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVehiculoPorIdentificador(ByVal rom As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    ' Verificado Uso Correcto del Pool de Conexion
    Public Function RecuperarInformacionVenta(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVenta"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.PresionLLenado = CDec(DatosRecibo("PresionLLenado").ToString)
                    oInfo.NroAutorizacionCheque = DatosRecibo("NroAutorizacionCheque").ToString
                    oInfo.NroAutorizacionCHEQUECDC = CInt(DatosRecibo("NroAutorizacionChequeCDC"))
                    oInfo.EsVentaRecuperada = CBool(DatosRecibo("EsRecuperada"))
                    oInfo.IdTipoVehiculoCDC = CInt(DatosRecibo("IdTipoVehiculoCDC"))
                    oInfo.ValorSobreTasa = CDec(DatosRecibo("ValorSobreTasa"))
                    oInfo.PorcentajeSobreTasa = CDec(DatosRecibo("SobreTasa"))
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))
                    oInfo.Kilometraje = CStr(DatosRecibo("Kilometraje"))
                    oInfo.Iva = CStr(DatosRecibo("Iva"))

                    If Not DatosRecibo("NroTarjeta") Is System.DBNull.Value Then
                        oInfo.NroTarjeta = DatosRecibo("NroTarjeta").ToString
                        oInfo.TipoLectura = CInt(DatosRecibo("TipoLectura"))
                        If Not DatosRecibo("NroSeguridad") Is System.DBNull.Value Then
                            oInfo.NroSeguridad = DatosRecibo("NroSeguridad").ToString
                        Else
                            oInfo.NroSeguridad = "0"
                        End If
                    Else
                        oInfo.NroTarjeta = String.Empty
                    End If

                    If Not DatosRecibo("CodTanque") Is System.DBNull.Value Then
                        oInfo.CodTanque = DatosRecibo("CodTanque").ToString
                    End If

                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionVentaComunicadorTerpel(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicador"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Manejo = CDec(DatosRecibo("Manejo"))
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.PresionLLenado = CDec(DatosRecibo("PresionLLenado").ToString)
                    oInfo.NroAutorizacionCheque = DatosRecibo("NroAutorizacionCheque").ToString
                    oInfo.NroAutorizacionCHEQUECDC = CInt(DatosRecibo("NroAutorizacionChequeCDC"))
                    oInfo.EsVentaRecuperada = CBool(DatosRecibo("EsRecuperada"))
                    oInfo.IdTipoVehiculoCDC = CInt(DatosRecibo("IdTipoVehiculoCDC"))
                    oInfo.ValorSobreTasa = CDec(DatosRecibo("ValorSobreTasa"))
                    oInfo.PorcentajeSobreTasa = CDec(DatosRecibo("SobreTasa"))
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))
                    oInfo.Kilometraje = CStr(DatosRecibo("Kilometraje"))
                    oInfo.Iva = CStr(DatosRecibo("Iva"))

                    If Not DatosRecibo("NroTarjeta") Is System.DBNull.Value Then
                        oInfo.NroTarjeta = DatosRecibo("NroTarjeta").ToString
                        oInfo.TipoLectura = CInt(DatosRecibo("TipoLectura"))
                        If Not DatosRecibo("NroSeguridad") Is System.DBNull.Value Then
                            oInfo.NroSeguridad = DatosRecibo("NroSeguridad").ToString
                        Else
                            oInfo.NroSeguridad = "0"
                        End If
                    Else
                        oInfo.NroTarjeta = String.Empty
                    End If

                    If Not DatosRecibo("CodTanque") Is System.DBNull.Value Then
                        oInfo.CodTanque = DatosRecibo("CodTanque").ToString
                    End If

                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionVentaFuelStation(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicador"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.FechaVenta = CDate(DatosRecibo("FechaHora"))
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.PresionLLenado = CDec(DatosRecibo("PresionLLenado").ToString)
                    oInfo.NroAutorizacionCheque = DatosRecibo("NroAutorizacionCheque").ToString
                    oInfo.NroAutorizacionCHEQUECDC = CInt(DatosRecibo("NroAutorizacionChequeCDC"))
                    oInfo.EsVentaRecuperada = CBool(DatosRecibo("EsRecuperada"))
                    oInfo.IdTipoVehiculoCDC = CInt(DatosRecibo("IdTipoVehiculoCDC"))
                    oInfo.ValorSobreTasa = CDec(DatosRecibo("ValorSobreTasa"))
                    oInfo.PorcentajeSobreTasa = CDec(DatosRecibo("SobreTasa"))
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))

                    If Not DatosRecibo("CodTanque") Is System.DBNull.Value Then
                        oInfo.CodTanque = DatosRecibo("CodTanque").ToString
                    End If

                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionVentaPeruCRMStation(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicadorCRMStation"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.FechaVenta = CDate(DatosRecibo("FechaHora"))
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))
                    oInfo.IdHistoricoPrecio = CInt(DatosRecibo("IdHistoricoPrecio"))
                    oInfo.IdUnidadMedida = CShort(DatosRecibo("IdUnidadMedida"))
                    oInfo.IdCara = CInt(DatosRecibo("Cara"))
                    oInfo.FechaProximoMantenimiento = DatosRecibo("FechaProximoMantenimiento").ToString

                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionVentaCRMStationChile(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicadorCRMStation"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.FechaVenta = CDate(DatosRecibo("FechaHora"))
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))
                    oInfo.IdHistoricoPrecio = CInt(DatosRecibo("IdHistoricoPrecio"))
                    oInfo.IdUnidadMedida = CShort(DatosRecibo("IdUnidadMedida"))
                    oInfo.IdCara = CInt(DatosRecibo("Cara"))
                    oInfo.FechaProximoMantenimiento = DatosRecibo("FechaProximoMantenimiento").ToString
                    oInfo.RUTConductor = DatosRecibo("RUTConductor").ToString
                    oInfo.Kilometraje = DatosRecibo("Kilometraje").ToString
                    oInfo.ComprobantePrepago = (DatosRecibo("ComprobantePrepago"))
                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Function RecuperarinformaciondeCreditoChile(ByVal recibo As Long) As InformacionRecaudoChile

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing
        Dim Recaudo As InformacionRecaudoChile
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarInformacionCredito"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)

                While DatosRecibo.Read
                    Recaudo = New InformacionRecaudoChile
                    Recaudo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    Recaudo.IdCredito = CLng(DatosRecibo("IdCreditoCDC").ToString)
                    Recaudo.Recaudo = CDec(DatosRecibo("Recaudo").ToString)
                    Recaudo.IdTipoRecaudo = CInt(DatosRecibo("IdTipoRecaudo"))
                    Recaudo.ValorTipoRecaudo = CDec(DatosRecibo("ValorTipoRecaudo"))
                End While
                Return Recaudo
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionVentaChileCRMStation(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicadorCRMStation"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.FechaVenta = CDate(DatosRecibo("FechaHora"))
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.IdUnidadMedida = CShort(DatosRecibo("IdUnidadMedida"))
                    oInfo.IdHistoricoPrecio = CInt(DatosRecibo("IdHistoricoPrecio"))
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.IdCara = CInt(DatosRecibo("Cara"))
                    oInfo.FechaProximoMantenimiento = DatosRecibo("FechaProximoMantenimiento").ToString
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()



                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Function RecuperarCupon(ByVal recibo As Long) As Cupon

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing
        Dim Cupon As Cupon = Nothing
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarCupon"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdCuponVenta", DbType.Int64, recibo)
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)

                While DatosRecibo.Read
                    Cupon = New Cupon
                    Cupon.CodEstacion = DatosRecibo("CodEstacion").ToString
                    Cupon.IdCupon = CLng(DatosRecibo("IdCupon").ToString)
                    Cupon.IdCliente = CInt(DatosRecibo("IdCliente").ToString)
                    Cupon.IdVehiculo = CInt(DatosRecibo("IdVehiculo"))
                    Cupon.NroCupon = DatosRecibo("NumeroCupon").ToString
                End While
                Return Cupon
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarValorVale(ByVal NroVale As String) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorVale"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NroVale)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarIdProductoVale(ByVal NroVale As String) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdProductoVale"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NroVale)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function


    Public Function RecuperarInformacionVentaCRMStationBolivia(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicadorCRMStation"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString

                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.FechaVenta = CDate(DatosRecibo("FechaHora"))
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))
                    oInfo.IdHistoricoPrecio = CInt(DatosRecibo("IdHistoricoPrecio"))
                    oInfo.IdUnidadMedida = CShort(DatosRecibo("IdUnidadMedida"))
                    oInfo.IdCara = CInt(DatosRecibo("Cara"))
                    oInfo.FechaProximoMantenimiento = DatosRecibo("FechaProximoMantenimiento").ToString
                    oInfo.RUTConductor = DatosRecibo("RUTConductor").ToString
                    oInfo.Kilometraje = DatosRecibo("Kilometraje").ToString
                    oInfo.Factura = DatosRecibo("FacturaVale").ToString
                    oInfo.CodigoControl = DatosRecibo("CodigoControl").ToString
                    oInfo.TipoEnvase = DatosRecibo("TipoEnvase").ToString
                    If DatosRecibo("IdVale") Is DBNull.Value Then
                        oInfo.IdVale = Nothing
                    Else
                        oInfo.IdVale = CInt(DatosRecibo("IdVale").ToString)
                    End If
                    If DatosRecibo("IdCupon") Is DBNull.Value Then
                        oInfo.IdCupon = Nothing
                    Else
                        oInfo.IdCupon = CLng(DatosRecibo("IdCupon").ToString)
                    End If
                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    ' Verificado Uso Correcto del Pool de Conexion
    Public Function RecuperarInformacionVentaGazel(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicador"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.PresionLLenado = CDec(DatosRecibo("PresionLLenado").ToString)
                    oInfo.NroAutorizacionCheque = DatosRecibo("NroAutorizacionCheque").ToString
                    oInfo.NroAutorizacionCHEQUECDC = CInt(DatosRecibo("NroAutorizacionChequeCDC"))
                    oInfo.EsVentaRecuperada = CBool(DatosRecibo("EsRecuperada"))
                    oInfo.IdTipoVehiculoCDC = CInt(DatosRecibo("IdTipoVehiculoCDC"))
                    oInfo.ValorSobreTasa = CDec(DatosRecibo("ValorSobreTasa"))
                    oInfo.PorcentajeSobreTasa = CDec(DatosRecibo("SobreTasa"))
                    oInfo.FechaProximoMantenimiento = DatosRecibo("FechaProximoMantenimiento").ToString

                    If Not DatosRecibo("TipoFidelizacion") Is System.DBNull.Value Then
                        oInfo.TipoFidelizacion = CInt(DatosRecibo("TipoFidelizacion"))
                        If CInt(DatosRecibo("TipoFidelizacion")) = TipoFidelizacion.Tarjeta Then
                            oInfo.NroTarjeta = DatosRecibo("NroTarjeta").ToString
                            oInfo.TipoLectura = CInt(DatosRecibo("TipoLectura"))
                            If Not DatosRecibo("NroSeguridad") Is System.DBNull.Value Then
                                oInfo.NroSeguridad = DatosRecibo("NroSeguridad").ToString
                            Else
                                oInfo.NroSeguridad = "0"
                            End If
                        ElseIf CInt(DatosRecibo("TipoFidelizacion")) = TipoFidelizacion.Cedula Then
                            oInfo.NroTarjeta = String.Empty
                            oInfo.CedulaFidelizacion = DatosRecibo("CedulaFidelizacion").ToString
                        End If
                    Else
                        oInfo.TipoFidelizacion = Nothing
                        oInfo.NroTarjeta = String.Empty
                        oInfo.CedulaFidelizacion = String.Empty
                    End If

                    If Not DatosRecibo("CodTanque") Is System.DBNull.Value Then
                        oInfo.CodTanque = DatosRecibo("CodTanque").ToString
                    End If

                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    ' Verificado Uso Correcto del Pool de Conexion
    Public Function RecuperarInformacionVentaPeru(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVenta"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionComunicadorVentaPeru(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicador"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC").ToString)
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    ' Verificado Uso Correcto del Pool de Conexion
    Public Function RecuperarInformacionVentaGasCaribe(ByVal recibo As Int64) As VentaGasCaribe
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaGasCaribe"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New VentaGasCaribe
                    oInfo.Usuario = DatosRecibo("Usuario").ToString
                    oInfo.Password = DatosRecibo("Password").ToString
                    oInfo.FechaVenta = DatosRecibo("FechaVenta").ToString
                    oInfo.IdEstacion = DatosRecibo("IdEstacion").ToString
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.CantidadM3 = CLng(DatosRecibo("Cantidad"))
                    oInfo.FechaUltimoMantenimiento = DatosRecibo("FechaUltimoMantenimiento").ToString
                    oInfo.IdChip = DatosRecibo("IdIdentificador").ToString
                    oInfo.CedulaVendedor = DatosRecibo("Cedula").ToString
                    oInfo.SerialMaquina = DatosRecibo("IdSurtidor").ToString
                    oInfo.IdEmpresa = DatosRecibo("IdEmpresa").ToString

                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    ' Verificado Uso Correcto del Pool de Conexion

    Public Function RecuperarInformacionVentaIG(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaIG"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Documento = DatosRecibo("Recibo").ToString
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionRedencionBono(ByVal idRedencionBono As Int64) As InformacionRedencionBono
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing
        Dim oInfo As InformacionRedencionBono = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarRedencionBono"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdRedencionBono", DbType.Int64, idRedencionBono)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    oInfo = New InformacionRedencionBono
                    oInfo.IdRedencionBono = CLng(idRedencionBono)
                    oInfo.IdAutorizacionFidelizacion = CLng(DatosRecibo("IdAutorizacionFidelizacion"))
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = DatosRecibo("Recibo").ToString
                    oInfo.Valor = CDec(DatosRecibo("Valor"))
                    oInfo.Tarjeta = DatosRecibo("Tarjeta").ToString
                End If
                DatosRecibo.Close()

                Return oInfo
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionAnulacionRedencionBono(ByVal IdAnulacionRedencionBono As Int64) As InformacionRedencionBono
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing
        Dim oInfo As InformacionRedencionBono = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarInformacionAnulacionRedencionBono"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdAnulacionRedencionBono", DbType.Int64, IdAnulacionRedencionBono)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    oInfo = New InformacionRedencionBono
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = DatosRecibo("Recibo").ToString
                    oInfo.Valor = CDec(DatosRecibo("Valor"))
                    oInfo.Tarjeta = DatosRecibo("Tarjeta").ToString
                End If
                DatosRecibo.Close()

                Return oInfo
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function


    Public Function RecuperarInformacionVentaFidelizada(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As InformacionVentaFidelizada
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing
        Dim oInfo As InformacionVentaFidelizada = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaFidelizadaGasolutions"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    oInfo = New InformacionVentaFidelizada
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Fecha = DatosRecibo("FechaHora").ToString
                    oInfo.Total = CStr(DatosRecibo("Valor").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Tarjeta = DatosRecibo("Tarjeta").ToString
                    DatosRecibo.Close()
                    connection.Close()
                Else
                    DatosRecibo.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function


    Public Function RecuperarInformacionVentaFidelizadaCanastilla(ByVal recibo As Int64) As InformacionVentaFidelizadaCanastilla
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing
        Dim oInfo As InformacionVentaFidelizadaCanastilla = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaFidelizadaCanastilla"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)


                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    oInfo = New InformacionVentaFidelizadaCanastilla

                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Fecha = CDate(DatosRecibo("Fecha"))
                    oInfo.Total = CStr(DatosRecibo("Valor").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Tarjeta = DatosRecibo("Tarjeta").ToString
                    oInfo.Rut = DatosRecibo("RUT").ToString
                    DatosRecibo.Close()
                    connection.Close()
                Else
                    DatosRecibo.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function


    Public Function RecuperarVentaImpuesto(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaImpuesto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentaANH(ByVal recibo As Int64) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaANH"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaDocumento(ByVal recibo As Int64, ByVal documento As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVenta(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True, Optional ByVal idEstacion As Int16 = 0) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        If idEstacion > 0 Then
            DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        End If

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaJSON(ByVal recibo As Int64) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaJSON"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarAutorizacionesVentasFlotaTerpelInactivas()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarAutorizacionesVentasFlotaTerpelInactivas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Function RecuperarImporteCreditoFiscalPorRecibo(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImporteCreditoFiscalPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaPrepago(ByVal recibo As Int64,EsCopia As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsCopia", DbType.Boolean, EsCopia)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaComunicador(ByVal recibo As Int64, Optional ByVal esVentaRegistrada As Boolean = True) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaComunicador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditosVenta(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecaudosFinanciera(ByVal IdTurno As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaMexico(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaSICC(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaSICC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarValorPorRecibo(ByVal recibo As Int64) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDbl(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarGUID(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarGUID"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarGUIDCanastilla(ByVal recibo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarGUIDCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoReciboCanastilla(ByVal idVentaCanastilla As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoReciboCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVentaCanastilla", DbType.Int32, idVentaCanastilla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ValidarReciboModficadoCheque(ByVal Cara As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarReciboModficadoCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarUltimoIdVentaCanastilla() As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoIdVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarFacturaTerpel(ByVal prefijo As String, ByVal consecutivo As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarFacturaTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, prefijo)
        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand).ToString)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarGUIDVenta(ByVal recibo As Int64, ByVal GUIDVenta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarGUIDVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "GUIDVenta", DbType.String, GUIDVenta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub VentaModificada(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "VentaModificada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarFormaPagoVenta(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPagoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarFormaPagoVentaGas(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPagoVentaGas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarFormaPagoVentaCanastilla(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPagoVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarFormasPagoVenta(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarFormasPagoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarVentasPorTurnoSurtidor(ByVal idTurno As Int32, ByVal idSurtidor As Int32, ByVal idFormaPago As Int32, ByVal producto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentasPorTurnoSurtidor(ByVal idTurno As Int32, ByVal idSurtidor As Int32, ByVal idFormaPago As Int32, ByVal producto As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasPorTurnoEmpleadoSurtidor(ByVal idTurno As Int32, ByVal idSurtidor As Int32, ByVal idFormaPago As Int32, ByVal producto As Int32, ByVal IdEmpleado As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorTurnoEmpleadoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentasPorTurnoDetallado(ByVal idTurno As Int32, ByVal idFormaPago As Int32) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorTurnoDetallado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasPorTurnoSurtidor(ByVal idTurno As Int32, ByVal idSurtidor As Int32, ByVal idFormaPago As Int32, ByVal producto As Int32, ByVal Mostrar As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "Excluir", DbType.Boolean, Mostrar)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasTotalizadasPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasTotalizadasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarVentasCanastillaPorTurno(ByVal idTurno As Int32, ByVal idFormaPago As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasCanastillaPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarVentasCanastillaPorTurno(ByVal idTurno As Int32, ByVal idFormaPago As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasCanastillaPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarVentasCanastillaPorTurnoTrabajo(ByVal idTurno As Int32, ByVal idFormaPago As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasCanastillaPorTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarVentasCanastillaPorTurnoTrabajo(ByVal idTurno As Int32, ByVal idFormaPago As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasCanastillaPorTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarFormasPagoCanastillaPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoCanastillaPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarFormasPagoCanastillaPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoCanastillaPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarFormasPagoCanastillaPorTurnoTrabajo(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoCanastillaPorTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarFormasPagoCanastillaPorTurnoTrabajo(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoCanastillaPorTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormasPagoPorTurno(ByVal idTurno As Int32, ByVal idSurtidor As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFormasPagoPorTurnoEmpleadoVendedor(ByVal idTurno As Int32, ByVal idSurtidor As Int32, ByVal IdEmpleado As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoPorTurnoEmpleadoVendedor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdEmpleado ", DbType.Int32, IdEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarStockTanquesTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarStockTanquesTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarStocksTurnoHorario(ByVal newId As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarStocksTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "GUID", DbType.String, newId)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarStocksTurnoHorario(ByVal newId As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarStocksTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "GUID", DbType.String, newId)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormasPagoPorTurnoDetallado(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoPorTurnoDetallado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFormasPagoPorTurnoDetallado(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoPorTurnoDetallado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarManguerasPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarManguerasPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarSurtidoresPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarSurtidoresPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarEmpleadosVendoresPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadosVendoresPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarFormasPagoPorTurnoEmpleado(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoPorTurnoEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEncabezadoReporte() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEncabezadoReporte(ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoReporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentas() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSlogansPorPlaca(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSlogansPorPlaca(ByVal placa As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMensajesCovinoc(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajesCovinoc"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarMensajesCovinoc(ByVal placa As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajesCovinoc"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMensajesFinanciacionConsumo(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajesFinanciacionConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDocumentoFactura(ByVal Documento As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDocumentoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSlogans() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogans"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSlogansPorTipo(ByVal tipo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorTipo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSlogansPorTipo(ByVal tipo As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorTipo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSlogansPorCliente(ByVal idCliente As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSlogansPorCliente(ByVal idCliente As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSlogansPorClienteLocal(ByVal RUC As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPremios(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPremios"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarPremios(ByVal placa As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPremios"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarMensajeSlogan() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajeSlogan"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region


    Public Function RecuperarUltimoGerenciamientoAnulado() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Long
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoGerenciamientoAnulado"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarInformacionGerenciamientoAnulado(ByVal IdAutorizaGerenciamiento As Long) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionGerenciamientoAnulado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAutorizaGerenciamiento", DbType.Int64, IdAutorizaGerenciamiento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub InsertarAutorizaGerenciamiento(ByVal Autorizacion As String, ByVal Estado As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAutorizaGerenciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int16, Estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarVentasDurantRecibodeCombustible(ByVal ReciboInicial As Int64, ByVal ReciboFinal As Int64) As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasDuranteReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
       
        DB.AddInParameter(DatabaseCommand, "ReciboInicial", DbType.Int64, ReciboInicial)
        DB.AddInParameter(DatabaseCommand, "ReciboFinal", DbType.Int64, ReciboFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTarjetasPorNuip(ByVal nuip As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTarjetasPorNuip"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, nuip)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarVentasSinCodigoControl() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasSinCodigoControl"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return (DB.ExecuteReader(DatabaseCommand))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarLLavePorFechaVenta(ByVal Fecha As DateTime) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLLavePorFechaVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarCodigoControl(ByVal recibo As Int64, ByVal codigoautorizacionestacion As String, ByVal codigocontrol As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCodigoControl"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "CodigoAutorizacionEstacion", DbType.String, codigoautorizacionestacion)
        DB.AddInParameter(DatabaseCommand, "CodigoControl", DbType.String, codigocontrol)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Function ValidarFechaMantenimientoPlaca(ByVal Placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarFechaMantenimientoPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function ValidarBonoDescuentoPromocion() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarBonoDescuentoPromocion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboPorConsecutivoChile(ByVal Recibo As Int64) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaPorNumeroConsecutivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarTotalReciboCombustible(ByVal Documento As String) As Decimal
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTotalReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarFechaCierreTanque(ByVal Fecha As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarFechaCierreTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidarCierreTanquePorCierreTurno()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCierreTanquePorCierreTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteOperador(ByVal Ruc As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteOperador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarConductorPorCodigo(ByVal IdCliente As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductorPorCodigo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConductorPorCodigo(ByVal IdCliente As Integer, ByVal Placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductorPorCodigo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarBloqueoVehiculo(ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarBloqueoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarDiferenciaLecturaCierreTurno(ByVal IdTurno As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDiferenciaDeLecturasCierreTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasPorEmpleadoVendedor(ByVal IdTurno As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorEmpleadoVendedor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#Region "Empresa"
    Public Function RecuperarUltimoRecaudoSRE() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoRecaudoSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarIdEmpresaPorCodigo(ByVal codigo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdEmpresaPorCodigo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarTotalSRE(ByVal codigo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarMinimoTanqueoParaAbonarSRE(ByVal idServicio As Int32, ByVal recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarMinimoTanqueoParaAbonarSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, idServicio)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function ValidarMinimoTanqueoParaAbonarSRE(ByVal IdServicio As Int32, ByVal recibo As Int64, ByVal IdEmpresa As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarMinimoTanqueoParaAbonarSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int64, IdEmpresa)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function


    Public Function ValidarVentaparaAbonarSRE(ByVal recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentaparaAbonarSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function InsertarPagoExtraOrdinarioSRE(ByVal IdEmpresa As Integer, ByVal NrAutorizacion As Nullable(Of Integer), ByVal Cedula As String, ByVal Empleado As String, ByVal clave As String, ByVal placa As String, ByVal IdServicio As Integer, ByVal Valor As Decimal, ByVal EsAnulado As Boolean, ByVal NumeroSeguridad As String, ByVal CodigoTarjeta As String, ByVal IdTipoLecturaTarjeta As Int32, ByVal IdConcepto As Int32, ByVal recibo As Int64, ByVal IdEstacion As Integer) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinarioSRE"
        Dim IdRecaudo As Integer
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "NrAutorizacion", DbType.Int64, NrAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "EsAnulado", DbType.Boolean, EsAnulado)
        DB.AddOutParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "NumeroSeguridad", DbType.String, NumeroSeguridad)
        DB.AddInParameter(DatabaseCommand, "CodigoTarjeta", DbType.String, CodigoTarjeta)
        DB.AddInParameter(DatabaseCommand, "IdTipoLecturaTarjeta", DbType.Int32, IdTipoLecturaTarjeta)
        DB.AddInParameter(DatabaseCommand, "IdConcepto", DbType.Int32, IdConcepto)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdRecaudo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function InsertarPagoExtraOrdinarioSRE(ByVal IdEmpresa As Integer, ByVal NrAutorizacion As Nullable(Of Integer), ByVal Cedula As String, ByVal Empleado As String, ByVal clave As String, ByVal placa As String, ByVal IdServicio As Integer, ByVal Valor As Decimal, ByVal EsAnulado As Boolean, ByVal NumeroSeguridad As String, ByVal CodigoTarjeta As String, ByVal IdTipoLecturaTarjeta As Int32, ByVal IdConcepto As Int32, ByVal recibo As Int64) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinarioSRE"
        Dim IdRecaudo As Integer
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "NrAutorizacion", DbType.Int64, NrAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "EsAnulado", DbType.Boolean, EsAnulado)
        DB.AddOutParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "NumeroSeguridad", DbType.String, NumeroSeguridad)
        DB.AddInParameter(DatabaseCommand, "CodigoTarjeta", DbType.String, CodigoTarjeta)
        DB.AddInParameter(DatabaseCommand, "IdTipoLecturaTarjeta", DbType.Int32, IdTipoLecturaTarjeta)
        DB.AddInParameter(DatabaseCommand, "IdConcepto", DbType.Int32, IdConcepto)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdRecaudo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPagoExtraOrdinarioSRE(ByVal IdEmpresa As Integer, ByVal NrAutorizacion As Nullable(Of Integer), ByVal Cedula As String, ByVal Empleado As String, ByVal clave As String, ByVal placa As String, ByVal IdServicio As Integer, ByVal Valor As Decimal, ByVal EsAnulado As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinarioSRE"
        Dim IdRecaudo As Integer
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "NrAutorizacion", DbType.Int64, NrAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "EsAnulado", DbType.Boolean, EsAnulado)
        DB.AddOutParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
      
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdRecaudo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function InsertarPagoExtraOrdinarioSRE(ByVal IdEmpresa As Integer, ByVal NrAutorizacion As Nullable(Of Integer), ByVal Cedula As String, ByVal Empleado As String, ByVal clave As String, ByVal placa As String, ByVal IdServicio As Integer, ByVal Valor As Decimal, ByVal EsAnulado As Boolean, ByVal IdEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoExtraOrdinarioSRE"
        Dim IdRecaudo As Integer
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "NrAutorizacion", DbType.Int64, NrAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "EsAnulado", DbType.Boolean, EsAnulado)
        DB.AddOutParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddOutParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdRecaudo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub CrearServicioSRE(ByVal IdServicio As Integer, ByVal Descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarServicioSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub AsignarServicioAEmpresa(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer, ByVal MinConsumoPorDia As Decimal, ByVal EsActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEmpresaServicioSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "MinConsumoPorDia", DbType.Decimal, MinConsumoPorDia)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub AsignarServicioAEmpresa(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEmpresaServicioSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarRecaudoInfoEmpresa(ByVal IdRecaudo As Integer, ByVal IdPagoEmpresa As Integer, ByVal EsAnulado As Boolean, ByVal Movil As Int32, ByVal Periodos As Int32, ByVal Descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRecaudoInfoEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "IdPagoEmpresa", DbType.Int32, IdPagoEmpresa)
        DB.AddInParameter(DatabaseCommand, "EsAnulado", DbType.Boolean, EsAnulado)
        DB.AddInParameter(DatabaseCommand, "Movil", DbType.Int32, Movil)
        DB.AddInParameter(DatabaseCommand, "Periodos", DbType.Int32, Periodos)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub ActualizarRecaudoInfoEmpresa(ByVal IdRecaudo As Integer, ByVal IdPagoEmpresa As Integer, ByVal EsAnulado As Boolean, ByVal Movil As Int32, ByVal Periodos As Int32, ByVal Descripcion As String, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRecaudoInfoEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "IdPagoEmpresa", DbType.Int32, IdPagoEmpresa)
        DB.AddInParameter(DatabaseCommand, "EsAnulado", DbType.Boolean, EsAnulado)
        DB.AddInParameter(DatabaseCommand, "Movil", DbType.Int32, Movil)
        DB.AddInParameter(DatabaseCommand, "Periodos", DbType.Int32, Periodos)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarRecaudoInfoSRE(ByVal IdRecaudo As Integer, ByVal Autorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRecaudoInfoSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, Autorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarEmpresaSRE(ByVal IdEmpresa As Integer, ByVal Nit As String, ByVal Nombre As String, ByVal Codigo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEmpresaSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function EsValidacionEmpresaEnCDC(ByVal Idempresa As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidacionEmpresaEnCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, Idempresa)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function





    Public Function RecuperarListadeEmpresasSRE() As System.Data.IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarListadeEmpresasSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarListadeEmpresasSRE(ByVal idEstacion As Integer) As System.Data.IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarListadeEmpresasSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarListadeEmpresasConPagosEnlineaSRE() As System.Data.IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarListadeEmpresasConPagosEnlineaSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarListadeEmpresasConPagosEnlineaSRE(ByVal IdEstacion As Integer) As System.Data.IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarListadeEmpresasConPagosEnlineaSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarServiciosAsignadosEmpresasSRE(ByVal IdEmpresa As Integer) As System.Data.IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarServiciosAsignadosEmpresasSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function




    Public Function RecuperarServiciosAsignadosEmpresasSRE(ByVal IdEmpresa As Integer, ByVal IdEstacion As Integer) As System.Data.IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarServiciosAsignadosEmpresasSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function


    Public Sub InsertarEmpresaSRE(ByVal IdEmpresa As Integer, ByVal Nit As String, ByVal Nombre As String, ByVal Codigo As Int32, ByVal AplicaConsumoMinimo As Boolean, ByVal ServicioWeb As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEmpresaSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)
        DB.AddInParameter(DatabaseCommand, "ServicioWeb", DbType.String, ServicioWeb)
        DB.AddInParameter(DatabaseCommand, "AplicaConsumoMinimo", DbType.Boolean, AplicaConsumoMinimo)
      

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarInformacionEmpresaSRE(ByVal Recibo As Long, ByVal IdEmpresa As Integer) As System.Data.IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionEmpresaSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarInformacionEmpresaSRE(ByVal Recibo As Long, ByVal IdEmpresa As Integer, ByVal IdEstacion As Int16) As System.Data.IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionEmpresaSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ValidarRecaudoSRE(ByVal Empleado As String, ByVal Clave As String, ByVal Recibo As Long, ByVal IdServicio As Integer, ByVal IdEmpresa As Integer) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRecaudoSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)




        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function





    Public Function ValidarRecaudoSRE(ByVal Empleado As String, ByVal Clave As String, ByVal Recibo As Long, ByVal IdServicio As Integer, ByVal IdEmpresa As Integer, ByVal IdEstacion As Int16) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRecaudoSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Sub InsertarValorConsumoMinEmpresaServicioSRE(ByVal IdServicio As Integer, ByVal IdEmpresa As Integer, ByVal MinConsumoPorDia As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarValorConsumoMinEmpresaServicioSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "MinConsumoPorDia", DbType.Decimal, MinConsumoPorDia)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarDescripcionEmpresaServcioSRE(ByVal IdEmpresa As Integer) As Data.DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDescripcionEmpresaServcioSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int64, IdEmpresa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDescripcionEmpresaServcioSRE() As Data.DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpresaServcioAsignadosSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ActualizarEmpresaSRE(ByVal IdEmpresa As Integer, ByVal Nit As String, ByVal Nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEmpresaSRE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarServicios() As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarServicios"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarServicios(ByVal IdEstacion As Int32) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarServicios"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpresa() As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarImpresoraPorIsla(ByVal IdIsla As Integer) As String

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarImpresoraPorIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, IdIsla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecaudoEmpresa(ByVal idRecaudo As Int32) As IDataReader

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudoEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, idRecaudo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarRecaudoEmpresa(ByVal idRecaudo As Int32, ByVal IdEstacion As Int16) As IDataReader

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudoEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, idRecaudo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecaudoEmpresaComunicador(ByVal idRecaudo As Int32) As IDataReader

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudoEmpresaComunicador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, idRecaudo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecaudosPorEmpresaTurno(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer, ByVal IdTurno As Int32) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosPorEmpresaTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()

            Try
                connection.Open()
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRecaudosPorEmpresaTurno(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer, ByVal IdTurno As Int32, ByVal idEstacion As Int16) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosPorEmpresaTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()

            Try
                connection.Open()
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEmpresasServicio(ByVal IdServicio As Integer) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpresasPorServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEmpresasServicio(ByVal IdServicio As Integer, ByVal idEstacion As Int16) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpresasPorServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesRecaudoporEmpresa(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer, ByVal Fecha As String) As Decimal

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesRecaudoporEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()

            Try
                connection.Open()
                DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
                DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
                DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesRecaudoporEmpresa(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer, ByVal Fecha As String, ByVal idEstacion As Int16) As Decimal

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesRecaudoporEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()

            Try
                connection.Open()
                DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
                DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
                DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesRecaudoporEmpresaDia(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer, ByVal Fecha As String) As Decimal

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesRecaudoporEmpresaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()

            Try
                connection.Open()
                DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
                DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
                DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTotalesRecaudoporEmpresaDia(ByVal IdEmpresa As Integer, ByVal IdServicio As Integer, ByVal Fecha As String, ByVal idEstacion As Int16) As Decimal

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesRecaudoporEmpresaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()

            Try
                connection.Open()
                DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
                DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, IdServicio)
                DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "Parametros"
    Public Sub InsertarParametro(ByVal nombre As String, ByVal valor As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarParametro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarParametro(ByVal nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarParametro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarParametro(ByVal nombre As String, ByVal valor As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarParametro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarParametro(ByVal nombre As String, ByVal valor As String, ByVal IdEstacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarParametro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    ' Revisado Con Manejo eficiente del Pool de Conexion
    Public Function RecuperarParametro(ByVal nombre As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Dim Resultado As String
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarParametro"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteScalar(DatabaseCommand).ToString()
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    'Realizdo por: Christian Galvis
    Public Function RecuperarParametro(ByVal nombre As String, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Dim Resultado As String
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarParametro"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteScalar(DatabaseCommand).ToString()
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function ValidarFechaAnulacionDocumento(ByVal prefijo As String, ByVal numero As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Dim Resultado As String
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "ValidarFechaAnulacionDocumento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "PREFIJO", DbType.String, prefijo)
                DB.AddInParameter(DatabaseCommand, "NUMERO", DbType.String, numero)

                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteScalar(DatabaseCommand).ToString()
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarParametros() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarParametros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormasPagoEsActivo() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoEsActivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Sincronizacion"
    Public Function RecuperarUltimoMovimientoCanastilla() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoMovimientoCanastilla"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimoCambioPrecioFallido() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoCambioPrecioFallido"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimoMovimientoKardex() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Long

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoMovimientoKardex"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimaNotificacionKardex() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Long

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaNotificacionKardex"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaReversion() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaReversion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarUltimaReversion(ByVal CDC As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaReversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarIdModificacionPorReciboVenta(ByVal Recibo As Int64) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdModificacionPorReciboVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarIdPagoPorIdRecaudoCDC(ByVal IdRecaudo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdPagoPorIdRecaudoCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimoPagoExtraordinario() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoPagoExtraordinario"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimoPagoSRE() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoRecaudoSRE"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimoGerenciamiento() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoGerenciamiento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimoCupon() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoCupon"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaLectura() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaLectura"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimoIdModificacion() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoIdModificacion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimoIdRedencionBono() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoIdRedencionBono"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimoIdAnulacionRedencionBono() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Int64

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoIdAnulacionRedencionBono"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarReciboPorIdModificacionVenta(ByVal IdModificacion As Int32) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarReciboPorIdModificacionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Int64

        DB.AddInParameter(DatabaseCommand, "IdModificacion", DbType.Int32, IdModificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimaLectura(ByVal CDC As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaLectura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimaLecturaCRM(ByVal CDC As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaLecturaCRM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function






    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaFactura() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaFactura"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaFacturacionCanastilla() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaFacturacionCanastilla"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaFacturacionCombustible() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaFacturacionCombustible"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaVentaCanastilla() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaVentaCanastilla"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaNotaCredito() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaNotaCredito"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaNotaCreditoTerpel() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaNotaCreditoTerpel"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimoCheque() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoCheque"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimoTurnoTrabajo() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoTurnoTrabajo"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimoTrasladoCombustible() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoTrasladoCombustible"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimoTrasladoCanastilla() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoTrasladoCanastilla"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Revisado Para uso Correcto del Pool de Conexion
    Public Function RecuperarUltimaAlarmaSobreTasa() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaAlarmaSobreTasa"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimaAlarmaVeederRoot() As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaAlarmaMedicion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Sub SincronizarPrecioProductoCombustible(ByVal idProducto As Int32, ByVal precio As Decimal, ByVal precioLeyFrontera As Decimal, ByVal fechaHora As DateTime, ByVal idManguera As Nullable(Of Int16))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarPrecioCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "PrecioLeyFrontera", DbType.Decimal, precioLeyFrontera)
        DB.AddInParameter(DatabaseCommand, "FechaHora", DbType.DateTime, fechaHora)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



#Region "Historico Precio FuelStation"
    Public Sub SincronizarPrecioProductoCombustibleFuelStation(ByVal idProducto As Int32, ByVal precio As Decimal, ByVal fechaHora As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarPrecioCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "FechaHora", DbType.DateTime, fechaHora)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub CargarHistoricoPrecioFuelStation(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarHistoricoPrecio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region
   


#Region "Recibo Combustible GasCorp"
    Public Function ValidarDocumentoPedidoGascorp(ByVal Documento As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarDocumentoPedidoGascorp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ActualizarTanqueoGas(ByVal Documento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTanqueoGas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function AlmacenarDocumentoPedidoTmp(ByVal Documento As String, ByVal cantidad As Decimal) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPedidoCombustibleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub AlmacenarDocumentoPedido(ByVal Documento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarPedidoCombustibleGasCorp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Function RecuperarInformacionPedidoGasTrailer(ByVal Documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionPedidoGasTrailer"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region


    Public Sub SincronizarPrecioProductoCanastilla(ByVal CodProducto As Int32, ByVal PrecioVenta As Decimal, ByVal fechaInicial As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarPrecioProductoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, CodProducto)
        DB.AddInParameter(DatabaseCommand, "PrecioVenta", DbType.Decimal, PrecioVenta)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, fechaInicial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarSobreTasaCombustible(ByVal IdHistoricoSobreTasa As Int32, ByVal IdProducto As Int32, ByVal SobreTasa As Decimal, ByVal fechaInicial As DateTime, ByVal fechaFinal As DateTime, ByVal esActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarSobreTasaCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdHistoricoSobreTasa", DbType.Int32, IdHistoricoSobreTasa)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "SobreTasa", DbType.Decimal, SobreTasa)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, fechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, fechaFinal)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub SincronizarSobreTasaCombustible(ByVal IdHistoricoSobreTasa As Int32, ByVal IdProducto As Int32, ByVal SobreTasa As Decimal, ByVal fechaInicial As DateTime, ByVal fechaFinal As DateTime, ByVal esActivo As Boolean, ByVal SobreTasaLeyFrontera As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarSobreTasaCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdHistoricoSobreTasa", DbType.Int32, IdHistoricoSobreTasa)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "SobreTasa", DbType.Decimal, SobreTasa)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, fechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, fechaFinal)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivo)
        DB.AddInParameter(DatabaseCommand, "SobreTasaLeyFrontera", DbType.Decimal, SobreTasaLeyFrontera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarFinanciera(ByVal idFinanciera As Int32, ByVal nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarDepartamento(ByVal idDpto As Int32, ByVal nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarDepartamento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarCiudad(ByVal idCiudad As Int32, ByVal codigo As String, ByVal nombre As String, ByVal idDpto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarCiudad"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "IdDpto", DbType.Int32, idDpto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarFormaPago(ByVal idFormaPago As Int16, ByVal descripcion As String, ByVal nroCopias As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "NroCopias", DbType.Int32, nroCopias)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarMotivo(ByVal idCausal As Int16, ByVal descripcion As String, ByVal codigo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarMotivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCausal", DbType.Int16, idCausal)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarTipoProducto(ByVal idTipo As Int16, ByVal nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarTipoProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipo", DbType.Int32, idTipo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarProducto(ByVal idProducto As Int32, ByVal precio As Double, ByVal nombre As String, ByVal tipo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarEmpleado(ByVal idEmpleado As Int32, ByVal codigo As String, ByVal cedula As String, ByVal nombre As String, ByVal telefono As String, ByVal direccion As String, ByVal idCargo As Int32, ByVal clave As String, ByVal estado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, idEmpleado)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "IdCargo", DbType.Int32, idCargo)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, IIf(estado, 1, 0))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarCliente(ByVal idCliente As Int32, ByVal nombre As String, ByVal documento As String, ByVal direccion As String, ByVal telefono As String, ByVal idFormaPago As Int32, ByVal idCiudad As Int32, ByVal precio As Double, ByVal descuento As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Descuento", DbType.Decimal, descuento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarVehiculo(ByVal idVehiculo As Int32, ByVal precio As Double, ByVal fechaProximoMantenimiento As String, ByVal descuento As Double, ByVal placa As String, ByVal modelo As String, ByVal tipo As String, ByVal idFormaPago As Int16, ByVal porcentajeCredito As Double, ByVal idCausalBloqueo As Int16, ByVal idFinanciera As Int32, ByVal idCliente As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "FechaProximoMantenimiento", DbType.String, fechaProximoMantenimiento)
        DB.AddInParameter(DatabaseCommand, "Descuento", DbType.Decimal, descuento)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Modelo", DbType.String, modelo)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.String, tipo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "PorcentajeCredito", DbType.Decimal, porcentajeCredito)
        DB.AddInParameter(DatabaseCommand, "IdCausalBloqueo", DbType.Int16, idCausalBloqueo)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarIdentificador(ByVal idIdentificador As Int32, ByVal rom As String, ByVal tipo As Int16, ByVal activo As Boolean, ByVal idVehiculo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int16, tipo)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, activo)
        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub SincronizarBloqueo(ByVal placa As String, ByVal activo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarBloqueo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, activo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Financiera"
    Public Function RecuperarFinanciera(ByVal idFinanciera As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As IDataReader

        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarDatosFinancieras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosFinancieras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarFinanciera(ByVal idFinanciera As Int32, ByVal url As String, ByVal fechaEnvio As Date, ByVal ultimaVenta As String, ByVal ultimoPago As String, ByVal ultimaReversion As String, ByVal EsActivada As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "URL", DbType.String, url)
        DB.AddInParameter(DatabaseCommand, "FechaEnvio", DbType.Date, fechaEnvio)
        DB.AddInParameter(DatabaseCommand, "UltimaVenta", DbType.String, ultimaVenta)
        DB.AddInParameter(DatabaseCommand, "UltimoPago", DbType.String, ultimoPago)
        DB.AddInParameter(DatabaseCommand, "UltimaReversion", DbType.String, ultimaReversion)
        DB.AddInParameter(DatabaseCommand, "EsActivada", DbType.Boolean, EsActivada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarFinancieraPorCredito(ByVal idCreditoCDC As Int32, ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFinancieraPorCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCreditoCDC", DbType.Int32, idCreditoCDC)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFinancieraPorCredito(ByVal idCreditoCDC As Int32, ByVal placa As String, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFinancieraPorCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCreditoCDC", DbType.Int32, idCreditoCDC)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIdentificadorPorId(ByVal ididentificador As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "ididentificador", DbType.Int32, ididentificador)
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEntidadesFinancieras() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFinancieras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecaudosFinancieraPorFecha(ByVal Financiera As Int16, ByVal Fecha As DateTime) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosFinancieraPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Financiera", DbType.Int16, Financiera)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ActualizarFechaEnvioFinanciera(ByVal Financiera As Int16, ByVal Fecha As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFechaEnvioFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Financiera", DbType.Int16, Financiera)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRecaudosSincronizacion(ByVal idFinanciera As Short) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecaudosSincronizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Financiera", DbType.Int16, idFinanciera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarRecaudosFinanciera(ByVal idFinanciera As Short, ByVal recaudo As Long)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarRecaudosFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Financiera", DbType.Int16, idFinanciera)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recaudo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region


#Region "GanaMillones"
    Public Sub CargarGanaMillones(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarGanaMillones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CargarKitEscolarCombustible(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarKitEscolarCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CargarGanaMillonesCombustible(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarGanaMillonesCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CargarKitEscolar(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarKitEscolar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub RegistrarRegla(ByVal idRegla As Int32, ByVal tipoVehiculo As String, ByVal requiereTarjeta As Boolean, ByVal mt3 As Int32, ByVal idFormaPago As Nullable(Of Int16), ByVal idProducto As Nullable(Of Int32))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarRegla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRegla", DbType.Int32, idRegla)
        DB.AddInParameter(DatabaseCommand, "TipoVehiculo", DbType.String, tipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "RequiereTarjeta", DbType.Boolean, requiereTarjeta)
        DB.AddInParameter(DatabaseCommand, "Mt3", DbType.Int32, mt3)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, idFormaPago)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub RegistrarSorteo(ByVal idSorteo As Int32, ByVal idRegla As Int32, ByVal fechaDesde As Date, ByVal fechaHasta As Date, ByVal loteria As String, ByVal fechaLoteria As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarSorteo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSorteo", DbType.Int32, idSorteo)
        DB.AddInParameter(DatabaseCommand, "IdRegla", DbType.Int32, idRegla)
        DB.AddInParameter(DatabaseCommand, "FechaDesde", DbType.Date, fechaDesde)
        DB.AddInParameter(DatabaseCommand, "FechaHasta", DbType.Date, fechaHasta)
        DB.AddInParameter(DatabaseCommand, "FechaLoteria", DbType.Date, fechaLoteria)
        DB.AddInParameter(DatabaseCommand, "Loteria", DbType.String, loteria)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub RegistrarHorarioSorteo(ByVal idSorteoHorario As Int32, ByVal idSorteo As Int32, ByVal horaInicial As DateTime, ByVal horaFinal As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarHorarioSorteo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSorteoHorario", DbType.Int32, idSorteoHorario)
        DB.AddInParameter(DatabaseCommand, "IdSorteo", DbType.Int32, idSorteo)
        DB.AddInParameter(DatabaseCommand, "HoraInicial", DbType.DateTime, horaInicial)
        DB.AddInParameter(DatabaseCommand, "HoraFinal", DbType.DateTime, horaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub RegistrarNumeroEnSorteo(ByVal idNumero As Int32, ByVal descripcion As String, ByVal idSorteo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarNumeroEnSorteo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdNumero", DbType.Int32, idNumero)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "IdSorteo", DbType.Int32, idSorteo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CancelarSorteo(ByVal idSorteo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CancelarSorteo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSorteo", DbType.Int32, idSorteo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarNumerosLoteriaPorRecibo(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumerosLoteriaPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNumerosLoteriaPorRecibo(ByVal recibo As Int64, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumerosLoteriaPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecibosConNumeroLoteria(ByVal CDC As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecibosConNumeroLoteria"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecibosConNumeroLoteria() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecibosConNumeroLoteria"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNumerosLoteria(ByVal recibo As Int64) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumerosLoteriaPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

#End Region

#Region "Conductor Peru"
    Public Sub InsertarConductor(ByVal documento As String, ByVal nombre As String, ByVal direccion As String, ByVal telefono As String, ByVal email As String, ByVal idCiudad As Int32, ByVal EsActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "Email", DbType.String, email)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarClienteConductor(ByVal IdentificacionCliente As String, ByVal documentoConductor As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarClienteConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdentificacionCliente", DbType.String, IdentificacionCliente)
        DB.AddInParameter(DatabaseCommand, "DocumentoConductor", DbType.String, documentoConductor)
      

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarConductor(ByVal documento As String, ByVal nombre As String, ByVal direccion As String, ByVal telefono As String, ByVal email As String, ByVal idCiudad As Int32, ByVal EsActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "Email", DbType.String, email)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

   
    Public Sub EliminarConductor(ByVal documento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteConductor(ByVal documento As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIGV() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIGV"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConductor(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function EsConductorAutorizado(ByVal DatoVehiculo As String, ByVal cara As String, ByVal Documento As String, ByVal esRom As Boolean) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsConductorAutorizado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "DatoVehiculo", DbType.String, DatoVehiculo)
        DB.AddInParameter(DatabaseCommand, "cara", DbType.String, cara)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "esRom", DbType.Boolean, esRom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarConductorPorTarjeta(ByVal numero As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductorPorTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub AsignarTarjetaAConductor(ByVal numero As String, ByVal documento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AsignarTarjetaAConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarRedencion(ByVal numero As String, ByVal puntos As Int32, ByVal idCampaa As Int32, ByVal idPremio As String, ByVal observaciones As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRedencion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "Puntos", DbType.Int32, puntos)
        DB.AddInParameter(DatabaseCommand, "IdCampaa", DbType.Int32, idCampaa)
        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.String, idPremio)
        DB.AddInParameter(DatabaseCommand, "Observaciones", DbType.String, observaciones)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarConsumosAcumulados(ByVal fechaInicial As Date, ByVal fechaFinal As Date, ByVal consumoMin As Int32, ByVal consumoRedimir As Int32, ByVal numero As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsumosAcumulados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.Date, fechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.Date, fechaFinal)
        DB.AddInParameter(DatabaseCommand, "ConsumoMinimo", DbType.Int32, consumoMin)
        DB.AddInParameter(DatabaseCommand, "ConsumoARedimir", DbType.Int32, consumoRedimir)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSaldos(ByVal numero As String, ByVal conductor As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaldos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, conductor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ReCalcularSaldosTarjetas()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ReCalcularSaldosTarjetas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Tarjeta Peru"
   
    Public Sub ActualizarTarjetaConsumo(ByVal IdTarjetaConsumo As Integer, ByVal numero As String, ByVal EsActiva As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTarjetaConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTarjetaConsumo", DbType.Int32, IdTarjetaConsumo)
        DB.AddInParameter(DatabaseCommand, "numero", DbType.Int32, numero)
        DB.AddInParameter(DatabaseCommand, "EsActiva", DbType.Boolean, EsActiva)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    

    Public Sub InsertarTarjetaConsumo(ByVal numero As String, ByVal EsActiva As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTarjetaConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "EsActiva", DbType.Boolean, EsActiva)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarTarjetaConsumo(ByVal idTarjeta As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTarjetaConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTarjeta", DbType.Int32, idTarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarTarjeta(ByVal numero As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarTarjeta(ByVal numero As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteTarjeta(ByVal numero As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarContraseaAdmin(ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarContraseaAdmin"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarPuntosATarjeta(ByVal numero As String, ByVal puntos As Int32, ByVal idOrigen As Int32, ByVal referencia As String, ByVal idCampaa As Int32, ByVal fecha As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPuntosATarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "Puntos", DbType.Int32, puntos)
        DB.AddInParameter(DatabaseCommand, "IdOrigen", DbType.Int32, idOrigen)
        DB.AddInParameter(DatabaseCommand, "Referencia", DbType.String, referencia)
        DB.AddInParameter(DatabaseCommand, "IdCampaa", DbType.Int32, idCampaa)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Campaa Peru"
    Public Sub InsertarCampaa(ByVal nombre As String, ByVal fechaInicial As Date, ByVal fechaFinal As Date, ByVal consumoMin As Int32, ByVal consumoRedimir As Int32, ByVal lapsoMaximo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCampaa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.Date, fechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.Date, fechaFinal)
        DB.AddInParameter(DatabaseCommand, "ConsumoMinimo", DbType.Int32, consumoMin)
        DB.AddInParameter(DatabaseCommand, "ConsumoARedimir", DbType.Int32, consumoRedimir)
        DB.AddInParameter(DatabaseCommand, "LapsoMaximo", DbType.Int32, lapsoMaximo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarCampaasActuales() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCampaasActuales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarTarjetaEnCampaa(ByVal idCampaa As Int32, ByVal numero As String, ByVal idPremio As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTarjetaEnCampaa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCampaa", DbType.Int32, idCampaa)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, idPremio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPuntosDisponiblesPorCampaa(ByVal idCampaa As Int32, ByVal numero As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuntosDisponiblesEnCampaa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCampaa", DbType.Int32, idCampaa)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "PremioFidelizacion Peru"
    Public Sub InsertarPremioFidelizacion(ByVal descripcion As String, ByVal puntos As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPremioFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "Puntos", DbType.Int32, puntos)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarPremioFidelizacionEnCampaa(ByVal idCampaa As Int32, ByVal idPremio As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPremioFidelizacionEnCampaa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCampaa", DbType.Int32, idCampaa)
        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, idPremio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarPremioFidelizacionEnCampaa(ByVal idCampaa As Int32, ByVal idPremio As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarPremioFidelizacionEnCampaa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCampaa", DbType.Int32, idCampaa)
        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, idPremio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExistePremioFidelizacion(ByVal descripcion As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExistePremioFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPremioFidelizacion(ByVal idPremio As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPremioFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPremio", DbType.Int32, idPremio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "OrigenFidelizacion Peru"
    Public Sub InsertarOrigenFidelizacion(ByVal descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarOrigenFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteOrigenFidelizacion(ByVal descripcion As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteOrigenFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Rastro CDC"
    Public Sub InsertarRastroCDC(ByVal identificador As Int64, ByVal tipoIdentificador As Char, ByVal falla As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRastroCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.Int64, identificador)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificador", DbType.String, tipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "Falla", DbType.String, falla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Contrato Mexico"
    Public Function ExisteContrato(ByVal numero As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteContrato"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPagoPredeterminado(ByVal contrato As String, ByVal valor As Decimal) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPagoPredeterminado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Contrato", DbType.String, contrato)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Reportes Exportar Per"

    Public Function RecuperarVentasReporteAnulados(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasReporteAnulados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarVentasReporteAnulados(ByVal fInicio As String, ByVal fFin As String, ByVal TimeOut As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasReporteAnulados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DatabaseCommand.CommandTimeout = TimeOut

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasPorDia(ByVal fInicio As DateTime, ByVal fFin As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentasPorDiaCanastilla(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorDiaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPedidoCombustiblePorFecha(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPedidoCombustiblePorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentasDocumentosParaArchivo(ByVal fInicio As String, ByVal fFin As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasDocumentosParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarVentasDocumentosParaArchivo(ByVal fInicio As String, ByVal fFin As String, ByVal TimeOut As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasDocumentosParaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = TimeOut
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.String, fInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, fFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarResumenVentaArchivo(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarResumenVentaArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDetalleVentasArchivo(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleVentasArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasDetalladasArchivo(ByVal FechaInicial As DateTime, ByVal FechaFinal As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasDetalladasArchivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "  Control Salto de Lecturas  "

    Public Sub ExisteSaltoLecturaInicial(ByVal Cara As Byte, ByVal LecturaInicial As Decimal, ByVal LecturaAnterior As Decimal, ByVal Motivo As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteSaltoLecturaInicial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "LecturaAnterior", DbType.Decimal, LecturaAnterior)
        DB.AddInParameter(DatabaseCommand, "IdMotivo", DbType.Int16, Motivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarVentaParcialCara(ByVal idCara As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarVentaParcial"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidarVentasSinSistema(ByVal idManguera As Int16, ByVal lectura As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentasSinSistema"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "LecturaActual", DbType.Decimal, lectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ValidarVentasSinSistema(ByVal idManguera As Int16, ByVal lectura As Decimal, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentasSinSistema"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "LecturaActual", DbType.Decimal, lectura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
            End Try
        End Using
    End Sub

    Public Sub ValidarLecturasEnUltimaVenta(ByVal recibo As Long, ByVal esVentaRegistrada As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarLecturasEnUltimaVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidarLecturasEnUltimaVenta(ByVal recibo As Long, ByVal esVentaRegistrada As Boolean, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarLecturasEnUltimaVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub VerificarConsecutivosImpresora(ByVal recibo As Long, ByVal esVentaRegistrada As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "VerificarConsecutivosImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub VerificarConsecutivosImpresoraPorCara(ByVal idCara As Int16, ByVal placa As String, ByVal idProducto As Int32, ByVal esIdentificada As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "VerificarConsecutivosImpresoraPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "EsIdentificada", DbType.Boolean, esIdentificada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CambiarTarjetaPorCara(ByVal idCara As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CambiarTarjetaPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub CambiarTarjetaPorCara(ByVal idCara As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CambiarTarjetaPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarLecturasCambioTarjeta(ByVal idManguera As Int16, ByVal lecturaFinal As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturasCambioTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarLecturasCambioTarjeta(ByVal idManguera As Int16, ByVal lecturaFinal As Decimal, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLecturasCambioTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarSaltosLecturasPorTurno(ByVal idTurno As Int32, ByVal idManguera As Integer, ByVal ordenadoMotivo As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaltosLecturasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "OrdenadoMotivo", DbType.Boolean, ordenadoMotivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSaltosLecturasPorTurno(ByVal idTurno As Int32, ByVal idManguera As Integer, ByVal ordenadoMotivo As Boolean, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaltosLecturasPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "OrdenadoMotivo", DbType.Boolean, ordenadoMotivo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSaltosLecturasPorFecha(ByVal fecha As String, ByVal idManguera As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaltosLecturasPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSaltosLecturasPorFecha(ByVal fecha As String, ByVal idManguera As Integer, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaltosLecturasPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSaltosLecturasPorFechaDia(ByVal fecha As String, ByVal idManguera As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaltosLecturasPorFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSaltosLecturasPorFechaDia(ByVal fecha As String, ByVal idManguera As Integer, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaltosLecturasPorFechaDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "     FullStation     "

    Public Sub ActualizarIdentificador(ByVal idIdentificador As Int32, ByVal estado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarIdentificadorLocal(ByVal idIdentificador As Int32, ByVal Identificador As String, ByVal placa As String, ByVal EsActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIdentificadorLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, idIdentificador)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, Identificador)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarVehiculoLocalPorPlacaFullStationPeru(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoLocalPorPlacaFullStationPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarPlacaPorIdentificador(ByVal idIdentificador As Integer) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idIdentificador", DbType.Int32, idIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function insertarPlacaIdentificador(ByVal idIdentificador As Integer, ByVal placa As String, ByVal fecha As Date) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idIdentificador", DbType.Int32, idIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarIdentificadorPorPlaca(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPlacaPorROM(ByVal ROM As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorROM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarPlacaVehiculoPorROM(ByVal ROM As String, Optional ByVal EsLocal As Boolean = True) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaVehiculoPorROM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)
        DB.AddInParameter(DatabaseCommand, "Esvehiculolocal", DbType.Boolean, EsLocal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function







    Public Function RecuperarPlacaVehiculoPorTarjeta(ByVal ROM As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaVehiculoPorTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)

     Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPlacaPorROM(ByVal ROM As String, ByVal IdEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorROM"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTarjetaConsumoPorNumero(ByVal Numero As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTarjetaConsumoPorNumero"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTarjetasConsumo() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTarjetasConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculoLocalPorPlaca(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoLocalPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculoLocalPorIdentificador(ByVal Rom As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoLocalPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculoPorPlaca(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarAnulacionPgn(ByVal IdAnulacion As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAnulacionPgn"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAnulacion", DbType.Int64, IdAnulacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculoPlaca(ByVal placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculoPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarTipoVehiculo(ByVal idTipoVehiculo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTipoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, idTipoVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarTipoVehiculo(ByVal idTipoVehiculo As Int32, ByVal descripcion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTipoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, idTipoVehiculo)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarTipoVehiculo(ByVal descripcion As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTipoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdTipoVehiculo As Int32

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, descripcion)
        DB.AddOutParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, CInt(IdTipoVehiculo))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdTipoVehiculo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTiposVehiculo() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarTipoVehiculoPorId(ByVal idTipoVehiculo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoVehiculoPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoVehiculo", DbType.Int32, idTipoVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Public Function RecuperarTiposVehiculoChile() As IDataReader
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "RecuperarTiposVehiculo"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()

    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            Return DB.ExecuteReader(DatabaseCommand)

    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using

    'End Function

    Public Function RecuperarMotivosBloqueo() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMotivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarFinancieras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFinancieras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As DataSet

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarCarasSurtidores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarasSurtidores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCarasSurtidores(ByVal idestacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarasSurtidores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub EliminarCaraSurtidor(ByVal idCara As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCaraSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarCaraSurtidor(ByVal idCara As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCaraSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCaraSurtidorFullStation(ByVal idCara As Int16, ByVal idSurtidor As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCaraSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarCaraSurtidorFullStation(ByVal idCara As Int16, ByVal idSurtidor As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCaraSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, idSurtidor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarConfiguracionFullStation(ByVal IdEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguracionFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConfiguracionFullStation() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConfiguracionFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdVehiculo(ByVal Placa As String) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTipoCredito() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarEncabezadoCredito(ByVal IdCliente As Int64, ByVal Cupo As Decimal, ByVal IdTipo As Integer, ByVal Estado As Boolean, ByVal TipoFacturacion As String, ByVal ManejaCupoPorVehiculo As Boolean, ByVal PermitirUsoEnCanastilla As Boolean, EsActivoBloqueo As Boolean, FechaInicialBloqueo As DateTime, FechaFinalBloqueo As Nullable(Of DateTime), PlazoPagoFactura As Int32, AplicaRenovacion As Boolean, PeriodoRenovacion As Integer) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEncabezadoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int64, IdCliente)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, Cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipo", DbType.Int16, IdTipo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int64, 0)
        DB.AddInParameter(DatabaseCommand, "TipoFacturacion", DbType.String, TipoFacturacion)
        DB.AddInParameter(DatabaseCommand, "ManejaCupoPorVehiculo", DbType.Boolean, ManejaCupoPorVehiculo)
        DB.AddInParameter(DatabaseCommand, "PermitirUsoEnCanastilla", DbType.Boolean, PermitirUsoEnCanastilla)
        DB.AddInParameter(DatabaseCommand, "EsActivoBloqueo", DbType.Boolean, EsActivoBloqueo)
        DB.AddInParameter(DatabaseCommand, "FechaInicialBloqueo", DbType.DateTime, FechaInicialBloqueo)
        DB.AddInParameter(DatabaseCommand, "FechaFinalBloqueo", DbType.DateTime, FechaFinalBloqueo)
        DB.AddInParameter(DatabaseCommand, "PlazoPagoFactura", DbType.Int32, PlazoPagoFactura)
        DB.AddInParameter(DatabaseCommand, "AplicaRenovacion", DbType.Boolean, AplicaRenovacion)
        DB.AddInParameter(DatabaseCommand, "PeriodoRenovacion", DbType.Int32, PeriodoRenovacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarEncabezadoCredito(ByVal IdCredito As Int64, ByVal IdCliente As Int64, ByVal Cupo As Decimal, ByVal IdTipo As Integer, ByVal Estado As Boolean, ByVal TipoFacturacion As String, ByVal ManejaCupoPorVehiculo As Boolean, ByVal PermitirUsoEnCanastilla As Boolean, EsActivoBloqueo As Boolean, FechaInicialBloqueo As DateTime, FechaFinalBloqueo As Nullable(Of DateTime), PlazoPagoFactura As Int32, AplicaRenovacion As Boolean, PeriodoRenovacion As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarEncabezadoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int64, IdCliente)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, Cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipo", DbType.Int16, IdTipo)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int64, IdCredito)
        DB.AddInParameter(DatabaseCommand, "TipoFacturacion", DbType.String, TipoFacturacion)
        DB.AddInParameter(DatabaseCommand, "ManejaCupoPorVehiculo", DbType.Boolean, ManejaCupoPorVehiculo)
        DB.AddInParameter(DatabaseCommand, "PermitirUsoEnCanastilla", DbType.Boolean, PermitirUsoEnCanastilla)
        DB.AddInParameter(DatabaseCommand, "EsActivoBloqueo", DbType.Boolean, EsActivoBloqueo)
        DB.AddInParameter(DatabaseCommand, "FechaInicialBloqueo", DbType.DateTime, FechaInicialBloqueo)
        DB.AddInParameter(DatabaseCommand, "FechaFinalBloqueo", DbType.DateTime, FechaFinalBloqueo)
        DB.AddInParameter(DatabaseCommand, "PlazoPagoFactura", DbType.Int32, PlazoPagoFactura)
        DB.AddInParameter(DatabaseCommand, "AplicaRenovacion", DbType.Boolean, AplicaRenovacion)
        DB.AddInParameter(DatabaseCommand, "PeriodoRenovacion", DbType.Int32, PeriodoRenovacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return True

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEncabezadoCredito(ByVal Nuip As String, ByVal EsDocumento As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, Nuip)
        DB.AddInParameter(DatabaseCommand, "EsDocumento", DbType.Int16, EsDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarDetalleCredito(ByVal IdCreditoConsumo As Int64, ByVal IdVehiculo As Int32, ByVal IdProducto As Int16, ByVal Estado As Int16, ByVal AutorizaVenta As Boolean, ByVal CupoAsignado As Decimal) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDetalleCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCreditoConsumo", DbType.Int64, IdCreditoConsumo)
        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int16, IdVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int16, Estado)
        DB.AddInParameter(DatabaseCommand, "AutorizaVenta", DbType.Boolean, AutorizaVenta)
        DB.AddInParameter(DatabaseCommand, "CupoAsignado", DbType.Decimal, CupoAsignado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return True
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDetalleCreditoConsumo(ByVal IdCreditoConsumo As Int64) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoConsumoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCreditoConsumo", DbType.Int64, IdCreditoConsumo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEstadosCreditos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstadosCreditos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFactoresdeConversion(ByVal IdSurtidor As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFactoresdeConversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, IdSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarComboFactores() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFactores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ActualizaFactordeDivision(ByVal IdSurtidor As Int32, ByVal Precio As Int16, ByVal Volumen As Int16, ByVal Valor As Int16, ByVal Totalizador As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizaFactordeDivision"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, IdSurtidor)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Int16, Precio)
        DB.AddInParameter(DatabaseCommand, "Volumen", DbType.Int16, Volumen)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Int16, Valor)
        DB.AddInParameter(DatabaseCommand, "Totalizador", DbType.Int16, Totalizador)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return True
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ActualizaFactordeDivision(ByVal IdSurtidor As Int32, ByVal Precio As Int16, ByVal Volumen As Int16, ByVal Valor As Int16, ByVal Totalizador As Int16, ByVal PredeterminacionVol As Int16, ByVal PredeterminacionImp As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizaFactordeDivision"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, IdSurtidor)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Int16, Precio)
        DB.AddInParameter(DatabaseCommand, "Volumen", DbType.Int16, Volumen)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Int16, Valor)
        DB.AddInParameter(DatabaseCommand, "Totalizador", DbType.Int16, Totalizador)
        DB.AddInParameter(DatabaseCommand, "PredeterminacionVolumen", DbType.Int16, PredeterminacionVol)
        DB.AddInParameter(DatabaseCommand, "PredeterminacionImporte", DbType.Int16, PredeterminacionImp)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return True
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRedCaras(ByVal idRed As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRedSurtidor", DbType.Int32, idRed)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarRedCaras(ByVal idRed As Integer, ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedCaras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRedSurtidor", DbType.Int32, idRed)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManguerasPorCara(ByVal cara As Byte) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCaraDB", DbType.Byte, cara)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManguerasPorCara(ByVal cara As Byte, ByVal IdEstacion As Short) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCaraDB", DbType.Byte, cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditoPorIdentificador(ByVal rom As String, ByVal idProducto As String, ByVal valor As Decimal) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.String, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditoPorIdentificador(ByVal identificador As String, ByVal idTipoIdentificador As Int32, ByVal idProducto As String, ByVal valor As Decimal, ByVal cara As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.String, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditoPorIdentificador(ByVal rom As String, ByVal idProducto As String, ByVal valor As Decimal, ByVal cara As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.String, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditoPorIdentificador(ByVal rom As String, ByVal idProducto As String, ByVal valor As Decimal, ByVal precio As Decimal, ByVal cara As Int16, ByVal tipoPresetMR As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.String, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "TipoPresetMR", DbType.Int32, tipoPresetMR)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    'Creado por: Christian Galvis
    Public Function RecuperarCreditoPorIdentificador(ByVal rom As String, ByVal idProducto As String, ByVal valor As Decimal, ByVal precio As Decimal, ByVal cara As Int16, ByVal tipoPresetMR As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.String, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "TipoPresetMR", DbType.Int32, tipoPresetMR)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditoPorIdentificador(ByVal identificador As String, ByVal idProducto As String, ByVal valor As Decimal, ByVal precio As Decimal, ByVal cara As Int16, ByVal tipoPresetMR As Int32, ByVal tipoIdentificacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.String, idProducto)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "TipoPresetMR", DbType.Int32, tipoPresetMR)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, tipoIdentificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosAutorizacionVehiculo(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosAutorizacionVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDatosAutorizacionVehiculo(ByVal placa As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosAutorizacionVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosVehiculoPorTarjetaFlota(ByVal nroTarjeta As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoPorTarjetaFlota"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, nroTarjeta)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarPlacaUltimaVenta(ByVal cara As Byte, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPlacaUltimaVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Byte, cara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarPlacaUltimaVenta(ByVal cara As Byte, ByVal placa As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPlacaUltimaVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Byte, cara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarPlacaRecibo(ByVal recibo As Long, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPlacaRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarKilometrajeUltimaVenta(ByVal cara As Byte, ByVal kilometraje As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarKilometrajeUltimaVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Byte, cara)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ExisteCreditoVehiculo(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteCreditoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim Resultado As Boolean = CBool(DB.ExecuteScalar(DatabaseCommand))
                connection.Close()
                Return Resultado
            Catch
                Throw
            Finally
                If connection.State = ConnectionState.Open Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarPreciosProductos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPreciosProductos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                If connection.State = ConnectionState.Open Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function
    Public Function RecuperarPreciosProductos(ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPreciosProductos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                If connection.State = ConnectionState.Open Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarMontoFacturar(ByVal FechaInicial As String, ByVal FechaFinal As String, ByVal Facturar As Boolean) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMontoFacturar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.String, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "TipoOperacion", DbType.Boolean, Facturar)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarFacturasCreditoConsumo(ByVal Nuip As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cliente", DbType.String, Nuip)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub RegistrarPagoFactura(ByVal IdFactura As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarPagoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFactura", DbType.Int64, IdFactura)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarClienteLocal(ByVal nuip As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, nuip)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdentificadoresLocalesPorPlaca(ByVal placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadoresLocalesPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdentificadorLocalPorRom(ByVal rom As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorLocalPorRom"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdentificadorLocalPorId(ByVal Identificador As String, ByVal idTipoIdentificador As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorLocalPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, Identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    ''' <summary>
    ''' victor
    ''' </summary>
    ''' <param name="Identificador"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Public Function RecuperarIdentificadorLocalPorIdPlaca(ByVal Identificador As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorLocalPorIdPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.String, Identificador)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'datse = DB.ExecuteDataSet(DatabaseCommand)

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    ''' <summary>
    ''' victor
    ''' </summary>
    ''' <param name="Identificador"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Public Function RecuperarIdentificadorLocalPorIdPlaca2(ByVal Identificador As String, ByVal placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorLocalPorIdPlaca2"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.String, Identificador)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'datse = DB.ExecuteDataSet(DatabaseCommand)

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    ''' <summary>
    ''' victor
    ''' </summary>
    ''' <param name="Identificador"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Public Function RecuperarIdentificadorLocalPorIdPlacaRefrescar(ByVal Identificador As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadorLocalPorIdPlacaRefrescar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.String, Identificador)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'datse = DB.ExecuteDataSet(DatabaseCommand)

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    ''' <summary>
    ''' victor
    ''' </summary>
    ''' <param name="identificacion"></param>
    ''' <param name="placa"></param>
    ''' <param name="fecha"></param>
    ''' <remarks></remarks>
    Public Sub InsertarIdentificadorLocalPorIdPlaca(ByVal IdIdentificacion As String, ByVal placa As String, ByVal FechaCrea As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarIdentificadorLocalPorIdPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.String, IdIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "FechaCrea", DbType.DateTime, FechaCrea)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    ''' <summary>
    ''' victor
    ''' </summary>
    ''' <param name="idIdentificador"></param>
    ''' <remarks></remarks>
    Public Sub EliminarIdentificadorLocalPorIdPlaca(ByVal idIdentificador As String, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarIdentificadorLocalPorIdPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idIdentificador", DbType.String, idIdentificador)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



   

    Public Function RecuperarROMPorPlaca(ByVal placa As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarROMPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarROMPorPlaca(ByVal placa As String, ByVal IdEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarROMPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarInformacionPorIdentificador(ByVal Numero As String, ByVal IdTipoIdentificador As Short) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int16, IdTipoIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarInformacionPorIdentificador(ByVal Numero As String, ByVal IdTipoIdentificador As Short, ByVal IdEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionPorIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int16, IdTipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ValidaRestricciones(ByVal identificador As String, ByVal producto As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaRestricciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IDPRODUCTO", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidaRestricciones(ByVal identificador As String, IdTipoIdentificador As Int32, ByVal producto As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaRestricciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, IdTipoIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidaRestricciones(ByVal identificador As String, ByVal idTipoIdentificador As Int32, ByVal producto As Integer, ByVal kilometraje As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaRestricciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidaRestricciones(ByVal identificador As String, ByVal producto As Integer, ByVal kilometraje As String, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaRestricciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IDPRODUCTO", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidaRestricciones(ByVal identificador As String, ByVal producto As Integer, ByVal kilometraje As String, ByVal tipoIdentificacion As Int32, Optional ByVal PIN As String = Nothing)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaRestricciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IDPRODUCTO", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, kilometraje)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, tipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "PIN", DbType.String, PIN)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ValidarTanqueosPorDia(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTanqueosPorDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function EsventaImpresa(ByVal Recibo As Long) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsventaImpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function EsventaImpresa(ByVal Recibo As Long, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsventaImpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsNotificacionDelKardexActual(ByVal idNotificacion As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsNotificacionDelKardexActual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idNotificacion", DbType.Int64, idNotificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNotificacionKardexSinImprimir(ByVal idNotificacion As Int64) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNotificacionKardexSinImprimir"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idNotificacion", DbType.Int64, idNotificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarEstadoImpresionNotificacionKardex(ByVal idNotificacion As Int64, ByVal esImpresa As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoImpresionNotificacionKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idNotificacion", DbType.Int64, idNotificacion)
        DB.AddInParameter(DatabaseCommand, "esImpresa", DbType.Boolean, esImpresa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function EsNotificacionKardexImpresa(ByVal idNotificacion As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsNotificacionKardexImpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idNotificacion", DbType.Int64, idNotificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function SolicitaChipParaVenderEnCara(ByVal idCara As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SolicitaChipParaVenderEnCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara ", DbType.String, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsLecturaChipObligatoria(ByVal producto As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsLecturadeChipObligatoria"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IDPRODUCTO", DbType.Int32, producto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    ' Realizado pr: Christian Galvis 01-09-2010
    Public Function EsLecturaChipObligatoria(ByVal producto As Integer, ByVal IdEstacion As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsLecturadeChipObligatoria"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IDPRODUCTO", DbType.Int32, producto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculosporClienteLocal(ByVal NUIP As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculosporCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NUIP", DbType.String, NUIP)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdCreditoLocal(ByVal placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdCreditoLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTipoFacturacion(ByVal Tipo As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoFacturacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Tipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function GeneraFacturacion(ByVal IdCredito As Int32, ByVal FechaFinal As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "GeneraFacturacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, IdCredito)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return True

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPrepago(ByVal Nuip As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, Nuip)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPrepago(ByVal Afectacion As Boolean, ByVal Monto As Decimal, ByVal FechaInsercion As String, ByVal Concepto As String, _
                                    ByVal Documento As Int64, ByVal Cuenta As Int64, ByVal Origen As String, ByVal Placa As String, ByVal CupoAsignado As Decimal) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Afectacion", DbType.Boolean, Afectacion)
        DB.AddInParameter(DatabaseCommand, "Monto", DbType.Decimal, Monto)
        DB.AddInParameter(DatabaseCommand, "FechaInsercion", DbType.String, FechaInsercion)
        DB.AddInParameter(DatabaseCommand, "Concepto", DbType.String, Concepto)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, Documento)
        DB.AddInParameter(DatabaseCommand, "Cuenta", DbType.Int64, Cuenta)
        DB.AddInParameter(DatabaseCommand, "Origen", DbType.String, Origen)
        DB.AddInParameter(DatabaseCommand, "CupoAsignado", DbType.Decimal, CupoAsignado)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                DB.ExecuteNonQuery(DatabaseCommand)
                Return True
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUnidadMedida() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUnidadMedida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosMedida() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosMedida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosTipoCombustible() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosTipoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    'Public Function RecuperarDatosTipoCombustible(ByVal IdTipoCombustible As Int64, ByVal Descripcion As String) As DataTable

    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    Dim SqlCommand As String = "RecuperarDatosTipoCombustible"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

    '    DB.AddInParameter(DatabaseCommand, "IdTipoCombustible", DbType.Int64, IdTipoCombustible)
    '    DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)

    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()

    '        Try
    '            'Ejecuta el Procedimiento Almacenado

    '            Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using


    'End Function
#End Region

#Region "   Uso Genaral - Consultas Display   "

    Public Function RecuperarVentaDisplay() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaDisplay"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ActualizaSaldos(ByVal IdTipoCredito As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizaSaldos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, IdTipoCredito)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return True

            Catch ex As Exception
                If ex.Message.ToString() = "Invalido" Then
                    Return False
                Else
                    Throw
                End If

            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   TerpelFullStation   "
    Public Sub EliminarCupoEnReserva(ByVal idCara As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCupoEnReserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub EliminarCupoEnReserva(ByVal idCara As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCupoEnReserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarConsumoEnReserva(ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarConsumoEnReserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarConsumoEnReserva(ByVal identificador As String, ByVal idTipoIdentificador As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarConsumoEnReserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarTurnosEntreFecha(ByVal fechaInicial As String, ByVal fechaFinal As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnosEntreFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.String, fechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, fechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarMapaTurnoExport(ByVal idTurno As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMapaTurnoExport"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarCuentasPorTurnoExport(ByVal idTurno As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCuentasPorTurnoExport"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarProductosPorTurnoExport(ByVal idTurno As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorTurnoExport"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarLecturasPorTurnoExport(ByVal idTurno As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorTurnoExport"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarVentasPorTurnoExport(ByVal idTurno As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasPorTurnoExport"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarVentasGRPPorFecha(ByVal fechaInicio As String, ByVal fechaFinal As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasGRPPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.String, fechaInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, fechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ImportarArchivoTerpel(ByVal Empresa As String, ByVal Direccion As String, ByVal Nit As String, ByVal Telefono As String, ByVal PorcDescuento As Decimal, ByVal TipoCuenta As String, ByVal Saldo As Decimal, ByVal ValMaxCredito As Decimal, ByVal FechaInicialCredito As DateTime, ByVal FechaFinalCredito As DateTime, ByVal BloqueadoCredito As Boolean, ByVal Placa As String, ByVal Marca As String, ByVal FechaRegistro As DateTime, ByVal Producto1 As String, ByVal Producto2 As String, ByVal Rom As String, ByVal MaxPreset As Decimal, ByVal MapaHoras As String, ByVal MaxVisitasDias As Integer, ByVal BloqueoVehiculo As Boolean, ByVal ControlKilometraje As Boolean, ByVal esCorporativa As Boolean, ByVal maxVolumenSemanal As Decimal, ByVal maxVolumenMensual As Decimal, ByVal Representante As String)

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ImportarArchivoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Marca", DbType.String, Marca)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "ControlKM", DbType.Boolean, ControlKilometraje)
        DB.AddInParameter(DatabaseCommand, "MaxVisitasDias", DbType.Int16, MaxVisitasDias)
        DB.AddInParameter(DatabaseCommand, "MaxPreset", DbType.Decimal, MaxPreset)
        DB.AddInParameter(DatabaseCommand, "MapaHoras", DbType.String, MapaHoras)
        DB.AddInParameter(DatabaseCommand, "Producto1", DbType.String, Producto1)
        DB.AddInParameter(DatabaseCommand, "Producto2", DbType.String, Producto2)
        DB.AddInParameter(DatabaseCommand, "NuipCliente", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "NombreCliente", DbType.String, Empresa)
        DB.AddInParameter(DatabaseCommand, "DireccionCliente", DbType.String, Direccion)
        DB.AddInParameter(DatabaseCommand, "TelefonoCliente", DbType.String, Telefono)
        DB.AddInParameter(DatabaseCommand, "DescuentoCliente", DbType.Decimal, PorcDescuento)
        DB.AddInParameter(DatabaseCommand, "FechaIniCredito", DbType.DateTime, FechaInicialCredito)
        DB.AddInParameter(DatabaseCommand, "FechaFinCredito", DbType.DateTime, FechaFinalCredito)
        DB.AddInParameter(DatabaseCommand, "TipoCuenta", DbType.String, TipoCuenta)
        DB.AddInParameter(DatabaseCommand, "ValorMaximoCredito", DbType.Decimal, ValMaxCredito)
        DB.AddInParameter(DatabaseCommand, "SaldoCredito", DbType.Decimal, Saldo)
        DB.AddInParameter(DatabaseCommand, "EstadoCreditoConsumo", DbType.Boolean, BloqueadoCredito)
        DB.AddInParameter(DatabaseCommand, "EsCuentaCorporativa", DbType.Boolean, esCorporativa)
        DB.AddInParameter(DatabaseCommand, "FechaIngreso", DbType.DateTime, FechaRegistro)
        DB.AddInParameter(DatabaseCommand, "EstadoCreditoVehiculo", DbType.Boolean, BloqueoVehiculo)
        DB.AddInParameter(DatabaseCommand, "MaxVolumenSemanal", DbType.Decimal, maxVolumenSemanal)
        DB.AddInParameter(DatabaseCommand, "MaxVolumenMensual", DbType.Decimal, maxVolumenMensual)
        DB.AddInParameter(DatabaseCommand, "Representante", DbType.String, Representante)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Function InsertarRestriccion(ByVal IdVehiculo As Int64, ByVal Tanqueos As Int64, ByVal Preset As Decimal) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRestriccion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdRestriccion As Int64

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int64, IdVehiculo)
        DB.AddInParameter(DatabaseCommand, "Tanqueos", DbType.Int64, Tanqueos)
        DB.AddInParameter(DatabaseCommand, "MaxPreset", DbType.Decimal, Preset)
        DB.AddInParameter(DatabaseCommand, "IdRestriccion", DbType.Int64, IdRestriccion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return IdRestriccion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarRestriccion(ByVal IdVehiculo As Int64, ByVal Tanqueos As Int64, ByVal Preset As Decimal, ByVal PresetSemanal As Decimal, ByVal PresetMensual As Decimal) As Int64

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRestriccion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdRestriccion As Int64

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int64, IdVehiculo)
        DB.AddInParameter(DatabaseCommand, "Tanqueos", DbType.Int64, Tanqueos)
        DB.AddInParameter(DatabaseCommand, "MaxPreset", DbType.Decimal, Preset)
        DB.AddInParameter(DatabaseCommand, "MaxPresetSemanal", DbType.Decimal, PresetSemanal)
        DB.AddInParameter(DatabaseCommand, "MaxPresetMensual", DbType.Decimal, PresetMensual)
        DB.AddInParameter(DatabaseCommand, "IdRestriccion", DbType.Int64, IdRestriccion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return IdRestriccion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function






    Public Function InsertarRestriccion(ByVal IdVehiculo As Int64, ByVal Tanqueos As Int64, ByVal Preset As Decimal, ByVal PresetSemanal As Decimal, ByVal PresetMensual As Decimal, ByVal Estado As Boolean) As Int64

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRestriccion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdRestriccion As Int64

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int64, IdVehiculo)
        DB.AddInParameter(DatabaseCommand, "Tanqueos", DbType.Int64, Tanqueos)
        DB.AddInParameter(DatabaseCommand, "MaxPreset", DbType.Decimal, Preset)
        DB.AddInParameter(DatabaseCommand, "MaxPresetSemanal", DbType.Decimal, PresetSemanal)
        DB.AddInParameter(DatabaseCommand, "MaxPresetMensual", DbType.Decimal, PresetMensual)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "IdRestriccion", DbType.Int64, IdRestriccion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return IdRestriccion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRestriccionBasica(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionBasica"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarRestriccionDia(ByVal Placa As String, ByVal IdDia As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRestriccionDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdDia", DbType.Int64, IdDia)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRestriccionDia(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarRestriccionHora(ByVal Placa As String, ByVal HoraInicial As String, ByVal HoraFinal As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRestriccionHora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "HoraInicial", DbType.String, HoraInicial)
        DB.AddInParameter(DatabaseCommand, "HoraFinal", DbType.String, HoraFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRestriccionHora(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionHora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarRestriccionHoraDia(ByVal Placa As String, ByVal IdDia As Int16, ByVal HoraInicial As String, ByVal HoraFinal As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRestriccionHoraDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdDia", DbType.Int16, IdDia)
        DB.AddInParameter(DatabaseCommand, "HoraInicial", DbType.String, HoraInicial)
        DB.AddInParameter(DatabaseCommand, "HoraFinal", DbType.String, HoraFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRestriccionHoraDia(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionHoraDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarRestriccionProducto(ByVal IdVehiculo As Int64, ByVal IdProducto As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRestriccionProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int64, IdVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRestriccionProducto(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosVehiculoRestriccion(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoRestriccion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRestriccionesTipo(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionesTipo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDiasSemana() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDiasSemana"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarRestriccionBasica(ByVal IdRestriccion As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRestriccionBasica"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRestriccion", DbType.Int64, IdRestriccion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRestriccionDia(ByVal IdRestriccionDia As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRestriccionDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRestriccionDia", DbType.Int64, IdRestriccionDia)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRestriccionHora(ByVal IdRestriccionHora As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRestriccionHora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRestriccionHora", DbType.Int64, IdRestriccionHora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRestriccionProducto(ByVal IdProducto As Int64, ByVal IdVehiculo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRestriccionProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int64, IdProducto)
        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int64, IdVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRestriccionHoraDia(ByVal IdRestriccionDia As Int64, ByVal IdRestriccionHora As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRestriccionHoraDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRestriccionDia", DbType.Int64, IdRestriccionDia)
        DB.AddInParameter(DatabaseCommand, "IdRestriccionHora", DbType.Int64, IdRestriccionHora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region

#Region "Promocion Kit Escolar"
    Public Function RecuperarRecibosConPremiosPKE() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecibosConPremiosPKE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarRecibosConPremiosPKE(ByVal CDC As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecibosConPremiosPKE"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "          GET LOG         "

    Public Function RecuperarLog(ByVal FechaHoraInicial As DateTime, ByVal FechaHoraFinal As DateTime, connectionString As String, _
                                 Optional ByVal CategoriaN As String = Nothing, Optional ByVal HiloId As String = Nothing) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase(connectionString)
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "GetLog"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "FechaHoraInicial", DbType.DateTime, FechaHoraInicial)
        DB.AddInParameter(DatabaseCommand, "FechaHoraFinal", DbType.DateTime, FechaHoraFinal)
        DB.AddInParameter(DatabaseCommand, "CategoriaN", DbType.String, CategoriaN)
        DB.AddInParameter(DatabaseCommand, "HiloId", DbType.String, HiloId)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "Metodos Servicios Web Financieras"
    Public Sub ActualizarPorcentajeRecaudo(ByVal codFinanciera As Integer, ByVal placa As String, ByVal porcentajeNuevo As Decimal, ByVal Fecha As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPorcentajeRecaudo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodFinanciera", DbType.Int32, codFinanciera)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "PorcentajeNuevo", DbType.Decimal, porcentajeNuevo)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstadoCreditoFinanciera(ByVal codFinanciera As Integer, ByVal estado As Byte, ByVal placa As String, ByVal fecha As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarNovedades"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodFinanciera", DbType.Int32, codFinanciera)
        DB.AddInParameter(DatabaseCommand, "TipoNovedad", DbType.Byte, estado)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarCreditoFinanciera(ByVal codFinanciera As Integer, ByVal suscripcion As String, ByVal nombre As String, ByVal cedula As String, ByVal direccion As String, ByVal placa As String, ByVal porcentaje As Decimal, ByVal fecha As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCreditoFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodFinanciera", DbType.Int32, codFinanciera)
        DB.AddInParameter(DatabaseCommand, "Suscripcion", DbType.String, suscripcion)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Porcentaje", DbType.Decimal, porcentaje)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarSincronizacionFinancieras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSincronizacionFinancieras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "   Servicios Web de Terpel     "

    Public Sub LiberarCupoenReserva(ByVal Rom As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "LiberarCupoenReserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub AlmacenarVenta(ByVal Recibo As Int64, ByVal IdFormaPago As Int32, ByVal FechaHora As DateTime, _
                                 ByVal Turno As Int64, ByVal Manguera As Int64, ByVal HoraInicio As DateTime, ByVal HoraFin As DateTime, _
                                 ByVal LecturaInicial As Decimal, ByVal LecturaFinal As Decimal, ByVal Precio As Decimal, _
                                 ByVal Cantidad As Decimal, ByVal Valor As Decimal, ByVal Descuento As Decimal, _
                                 ByVal Placa As String, ByVal IdProducto As Int32, ByVal PorcentajeDescuento As Decimal, _
                                 ByVal Rom As String, ByVal RecaudoOpcional As Decimal, ByVal Kilometraje As String, ByVal IdCredito As Int64, _
                                 ByVal Estacion As Int64)

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "FechaHora", DbType.DateTime, FechaHora)
        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int64, Turno)
        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int64, Manguera)
        DB.AddInParameter(DatabaseCommand, "HoraInicio", DbType.DateTime, HoraInicio)
        DB.AddInParameter(DatabaseCommand, "HoraFin", DbType.DateTime, HoraFin)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, LecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, Precio)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "Descuento", DbType.Decimal, Descuento)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "PorcentajeDescuento", DbType.Decimal, PorcentajeDescuento)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "RecaudoOpcional", DbType.Decimal, RecaudoOpcional)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.String, Kilometraje)
        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int64, IdCredito)
        DB.AddInParameter(DatabaseCommand, "Estacion", DbType.Int64, Estacion)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region

#Region "Creditos Gazel"
    Public Function RecuperarCreditos(ByVal placa As String, ByVal numeroCredito As String, ByVal cliente As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "Cliente", DbType.String, cliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditosActivos(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosActivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditosFinalizadosPorRecibo(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosFinalizadosPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditosActivos(ByVal placa As String, ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosActivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditosConversion(ByVal placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosConversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCreditosConversion(ByVal placa As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosConversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ESCreditoCovinoc(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCreditoCovinoc"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
    ' Relaizado por: Christian Galvis
    Public Function ESCreditoCovinoc(ByVal placa As String, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCreditoCovinoc"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
    'Verificada Uso de Pool de Conexiones
    Public Function ESCreditoDeFinanciacionConsumo(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCreditoDeFinanciacionConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function ESCreditoCovinocPorIdCredito(ByVal idCredito As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCreditoCovinocPorIdCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
    Public Function ESCreditoCovinocPorIdCredito(ByVal idCredito As Integer, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCreditoCovinocPorIdCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function ESCreditoCovinoc(ByVal recibo As Long) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCreditoCovinocPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function ESCreditoFinanciera(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCreditoFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarIdCreditoCDC(ByVal placa As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RECUPERARIDCREDITOCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Int64


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = Int64.Parse(DB.ExecuteScalar(DatabaseCommand).ToString)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function RecuperarIdClienteCDC(ByVal placa As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdClienteCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Int32

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = Int32.Parse(DB.ExecuteScalar(DatabaseCommand).ToString)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
    Public Function RecuperarIdClienteCDC(ByVal placa As String, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdClienteCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Int32

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = Int32.Parse(DB.ExecuteScalar(DatabaseCommand).ToString)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
    Public Function RecuperarTipoCreditoPorPlaca(ByVal placa As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoCreditoPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Int32

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = Int32.Parse(DB.ExecuteScalar(DatabaseCommand).ToString)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
#End Region

#Region "   Configuracin de Documentos Per    "

    Public Function RecuperarTiposDocumento() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTiposDocumentoVentasRecuperadas() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposDocumentoVentasRecuperadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDocumentosImpresora(ByVal IdImpresora As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDocumentosImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, IdImpresora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDocumentoFacturaGrande(ByVal Recibo As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDocumentoFacturareporte"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNumeroEnLetras(ByVal Numero As double) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumeroEnLetras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Decimal, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsecutivosTiposDocumento() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsecutivosTiposDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarDocumentosImpresora(ByVal IdImpConsecutivo As Int32, ByVal IdImpresora As Int32, _
                                           ByVal IdTipoDocumento As Int32, ByVal Prefijo As String, _
                                           ByVal ConsecutivoActual As Int64, ByVal ConsecutivoDesde As Int64, _
                                           ByVal ConsecutivoHasta As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDocumentosImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpConsecutivo", DbType.Int32, IdImpConsecutivo)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, IdImpresora)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumento", DbType.Int32, IdTipoDocumento)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoActual", DbType.Int64, ConsecutivoActual)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoDesde", DbType.Int64, ConsecutivoDesde)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoHasta", DbType.Int64, ConsecutivoHasta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarDocumentosImpresora(ByVal IdImpConsecutivo As Int32, ByVal IdImpresora As Int32, _
                                       ByVal IdTipoDocumento As Int32, _
                                       ByVal ConsecutivoActual As Int64, ByVal ConsecutivoDesde As Int64, _
                                       ByVal ConsecutivoHasta As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDocumentosImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdImpConsecutivo", DbType.Int32, IdImpConsecutivo)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, IdImpresora)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumento", DbType.Int32, IdTipoDocumento)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoDesde", DbType.Int64, ConsecutivoDesde)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoHasta", DbType.Int64, ConsecutivoHasta)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoActual", DbType.Int64, ConsecutivoActual)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarConsecutivoTipoDocumento(ByVal IdImpConsecutivo As Int32, _
                                       ByVal IdTipoDocumento As Int32, _
                                       ByVal ConsecutivoActual As Int64, ByVal ConsecutivoDesde As Int64, _
                                       ByVal ConsecutivoHasta As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarConsecutivoTipoDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdConsecutivo", DbType.Int32, IdImpConsecutivo)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumento", DbType.Int32, IdTipoDocumento)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoDesde", DbType.Int64, ConsecutivoDesde)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoHasta", DbType.Int64, ConsecutivoHasta)
        DB.AddInParameter(DatabaseCommand, "ConsecutivoActual", DbType.Int64, ConsecutivoActual)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "       Tools Station       "

    Public Sub GenerarBackup(ByVal Sqlcommand As String, Optional ByVal tiempo As Integer = -1) ', ByVal RutaArchivo As String)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        'Dim SqlCommand As String = "CrearBackupDataBase"
        Dim DatabaseCommand As DbCommand = DB.GetSqlStringCommand(Sqlcommand)


        'DB.AddInParameter(DatabaseCommand, "DataBase", DbType.String, Database)
        'DB.AddInParameter(DatabaseCommand, "RutaArchivo", DbType.String, RutaArchivo)

        If tiempo <> -1 Then
            DatabaseCommand.CommandTimeout = tiempo
        End If


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarDataBases() As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "select name from sys.databases"
        Dim DatabaseCommand As DbCommand = DB.GetSqlStringCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

    End Function
#End Region

#Region "Talleres"
    Public Function RecuperarTalleres(ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTalleres"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int64, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarTalleres() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTalleres"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Restricciones"
    Public Function RecuperarInformacionRestriccion(ByVal restriccion As Long) As InformacionRestriccion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosNotificacion As IDataReader = Nothing
        Dim oInfo As InformacionRestriccion = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarBloqueoRestriccionPorId"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdRestriccion", DbType.Int64, restriccion)

                'Ejecuta el Procedimiento Almacenado
                DatosNotificacion = DB.ExecuteReader(DatabaseCommand)

                If DatosNotificacion.Read Then
                    oInfo = New InformacionRestriccion
                    oInfo.IdBloqueoRestriccion = CLng(DatosNotificacion.Item("IdBloqueoRestriccion"))
                    oInfo.IdCausalBloqueo = CLng(DatosNotificacion.Item("IdCausal"))
                    oInfo.IdVehiculo = CLng(DatosNotificacion.Item("IdVehiculo"))
                    oInfo.FechaHora = CDate(DatosNotificacion.Item("FechaHora"))
                    oInfo.Tope = CLng(DatosNotificacion.Item("Tope"))
                    oInfo.Placa = DatosNotificacion.Item("Placa").ToString
                    oInfo.CodEstacion = DatosNotificacion.Item("CodEstacion").ToString
                    DatosNotificacion.Close()
                    'connection.Close()
                Else
                    DatosNotificacion.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosNotificacion Is Nothing Then
                    If Not DatosNotificacion.IsClosed Then
                        DatosNotificacion.Close()
                        DatosNotificacion = Nothing
                    End If
                End If
                Throw 
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionGerenciamiento(ByVal idGerenciamiento As Long) As InformacionGerenciamiento
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosNotificacion As IDataReader = Nothing
        Dim oInfo As InformacionGerenciamiento = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaGerenciamiento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdGerenciamiento", DbType.Int64, idGerenciamiento)

                'Ejecuta el Procedimiento Almacenado
                DatosNotificacion = DB.ExecuteReader(DatabaseCommand)

                If DatosNotificacion.Read Then
                    oInfo = New InformacionGerenciamiento
                    oInfo.GUID = DatosNotificacion.Item("GUIDVenta").ToString
                    oInfo.Recibo = CLng(DatosNotificacion.Item("Recibo"))
                    oInfo.Valor = CDec(DatosNotificacion.Item("Valor"))
                    oInfo.CodEstacion = DatosNotificacion.Item("CodEstacion").ToString
                    oInfo.Autorizacion = CInt(DatosNotificacion.Item("Autorizacion"))
                    oInfo.CodigoContrato = DatosNotificacion.Item("CodigoContrato").ToString
                    oInfo.EsAutorizacionLocal = CBool(DatosNotificacion.Item("EsAutorizacionLocal").ToString)
                    oInfo.PosicionContrato = DatosNotificacion.Item("PosicionContrato").ToString
                    oInfo.Placa = DatosNotificacion.Item("Placa").ToString
                    oInfo.Kilometraje = CStr(DatosNotificacion.Item("Kilometraje"))
                    oInfo.EsCanastilla = CBool(DatosNotificacion.Item("EsCanastilla"))
                    DatosNotificacion.Close()
                    'connection.Close()
                Else
                    DatosNotificacion.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosNotificacion Is Nothing Then
                    If Not DatosNotificacion.IsClosed Then
                        DatosNotificacion.Close()
                        DatosNotificacion = Nothing
                    End If
                End If
                Throw 
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionGerenciamientoTerpel(ByVal idGerenciamiento As Long) As InformacionGerenciamiento
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosNotificacion As IDataReader = Nothing
        Dim oInfo As InformacionGerenciamiento = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaGerenciamiento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdGerenciamiento", DbType.Int64, idGerenciamiento)

                'Ejecuta el Procedimiento Almacenado
                DatosNotificacion = DB.ExecuteReader(DatabaseCommand)

                If DatosNotificacion.Read Then
                    oInfo = New InformacionGerenciamiento
                    oInfo.GUID = DatosNotificacion.Item("GUIDVenta").ToString
                    oInfo.Recibo = CLng(DatosNotificacion.Item("Recibo"))
                    oInfo.Valor = CDec(DatosNotificacion.Item("Valor"))
                    oInfo.CodEstacion = DatosNotificacion.Item("CodEstacion").ToString
                    oInfo.Autorizacion = CInt(DatosNotificacion.Item("Autorizacion"))
                    oInfo.CodigoContrato = DatosNotificacion.Item("CodigoContrato").ToString
                    oInfo.EsAutorizacionLocal = CBool(DatosNotificacion.Item("EsAutorizacionLocal").ToString)
                    oInfo.PosicionContrato = DatosNotificacion.Item("PosicionContrato").ToString
                    oInfo.Placa = DatosNotificacion.Item("Placa").ToString
                    oInfo.Kilometraje = CStr(DatosNotificacion.Item("Kilometraje"))
                    oInfo.EsCanastilla = CBool(DatosNotificacion.Item("EsCanastilla"))

                    If (Not DatosNotificacion.Item("IdExtraCupo") Is System.DBNull.Value) And oInfo.EsAutorizacionLocal Then
                        oInfo.IdExtraCupo = CInt(DatosNotificacion.Item("IdExtraCupo"))
                    Else
                        oInfo.IdExtraCupo = Nothing
                    End If

                    oInfo.EsSobreGiro = CBool(DatosNotificacion.Item("EsSobreGiro"))

                    DatosNotificacion.Close()
                    'connection.Close()
                Else
                    DatosNotificacion.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosNotificacion Is Nothing Then
                    If Not DatosNotificacion.IsClosed Then
                        DatosNotificacion.Close()
                        DatosNotificacion = Nothing
                    End If
                End If
                Throw 
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionGerenciamientoFuelStation(ByVal idGerenciamiento As Long) As InformacionGerenciamiento
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosNotificacion As IDataReader = Nothing
        Dim oInfo As InformacionGerenciamiento = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaGerenciamiento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdGerenciamiento", DbType.Int64, idGerenciamiento)

                'Ejecuta el Procedimiento Almacenado
                DatosNotificacion = DB.ExecuteReader(DatabaseCommand)

                If DatosNotificacion.Read Then
                    oInfo = New InformacionGerenciamiento
                    oInfo.GUID = DatosNotificacion.Item("GUIDVenta").ToString
                    oInfo.Recibo = CLng(DatosNotificacion.Item("Recibo"))
                    oInfo.Valor = CDec(DatosNotificacion.Item("Valor"))
                    oInfo.CodEstacion = DatosNotificacion.Item("CodEstacion").ToString
                    oInfo.Autorizacion = CInt(DatosNotificacion.Item("Autorizacion"))
                    oInfo.CodigoContrato = DatosNotificacion.Item("CodigoContrato").ToString
                    oInfo.EsAutorizacionLocal = CBool(DatosNotificacion.Item("EsAutorizacionLocal").ToString)
                    oInfo.PosicionContrato = DatosNotificacion.Item("PosicionContrato").ToString
                    oInfo.Placa = DatosNotificacion.Item("Placa").ToString
                    oInfo.Kilometraje = CStr(DatosNotificacion.Item("Kilometraje"))
                    oInfo.EsCanastilla = CBool(DatosNotificacion.Item("EsCanastilla"))

                    If (Not DatosNotificacion.Item("IdExtraCupo") Is System.DBNull.Value) And oInfo.EsAutorizacionLocal Then
                        oInfo.IdExtraCupo = CInt(DatosNotificacion.Item("IdExtraCupo"))
                    Else
                        oInfo.IdExtraCupo = Nothing
                    End If

                    oInfo.EsSobreGiro = CBool(DatosNotificacion.Item("EsSobreGiro"))

                    DatosNotificacion.Close()
                    'connection.Close()
                Else
                    DatosNotificacion.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosNotificacion Is Nothing Then
                    If Not DatosNotificacion.IsClosed Then
                        DatosNotificacion.Close()
                        DatosNotificacion = Nothing
                    End If
                End If
                Throw 
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionGerenciamientoPeruCRMStation(ByVal idGerenciamiento As Long) As InformacionGerenciamiento
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosNotificacion As IDataReader = Nothing
        Dim oInfo As InformacionGerenciamiento = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaGerenciamiento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdGerenciamiento", DbType.Int64, idGerenciamiento)

                'Ejecuta el Procedimiento Almacenado
                DatosNotificacion = DB.ExecuteReader(DatabaseCommand)

                If DatosNotificacion.Read Then
                    oInfo = New InformacionGerenciamiento
                    oInfo.GUID = DatosNotificacion.Item("GUIDVenta").ToString
                    oInfo.Recibo = CLng(DatosNotificacion.Item("Recibo"))
                    oInfo.Valor = CDec(DatosNotificacion.Item("Valor"))
                    oInfo.CodEstacion = DatosNotificacion.Item("CodEstacion").ToString
                    oInfo.Autorizacion = CInt(DatosNotificacion.Item("Autorizacion"))
                    oInfo.Placa = DatosNotificacion.Item("Placa").ToString
                    oInfo.Kilometraje = CStr(DatosNotificacion.Item("Kilometraje"))

                    DatosNotificacion.Close()
                Else
                    DatosNotificacion.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosNotificacion Is Nothing Then
                    If Not DatosNotificacion.IsClosed Then
                        DatosNotificacion.Close()
                        DatosNotificacion = Nothing
                    End If
                End If
                Throw 
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarUltimaRestriccion() As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaRestriccion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ValidarRestriccionVehiculo(ByVal Placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ValidarRestriccionVehiculo(ByVal Placa As String, ByVal IdEstacion as Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRestriccionVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarRestriccionVehiculoPorRecibo(ByVal recibo As Long)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRestriccionVehiculoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ValidarRestriccionVehiculoPorRecibo(ByVal recibo As Long, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRestriccionVehiculoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRestriccionPorId(ByVal IdRestriccion As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarBloqueoRestriccionPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRestriccion", DbType.Int64, IdRestriccion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function GenerarReporteVentasPorFecha(ByVal fecha As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "GenerarReporteVentasPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "Fidelizacion CDC"
    Public Function RecuperarVentaFidelizada(ByVal recibo As Long, ByVal esVentaRegistrada As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaFidelizada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentaFidelizadaGazel(ByVal recibo As Long) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaFidelizada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentaFidelizadaGazel(ByVal recibo As Long, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaFidelizada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub FidelizarVentaGazel(ByVal recibo As Int64, ByVal codigo As String, ByVal numero As String, ByVal idTipoLectura As Int32, ByVal cedula As String, ByVal tipoFidelizacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FidelizarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "IdTipoLecturaTarjeta", DbType.Int32, idTipoLectura)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "IdTipoFidelizacion", DbType.Int32, tipoFidelizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub FidelizarVentaGazel(ByVal recibo As Int64, ByVal codigo As String, ByVal numero As String, ByVal idTipoLectura As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FidelizarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "IdTipoLecturaTarjeta", DbType.Int32, idTipoLectura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub FidelizarVentaGazel(ByVal recibo As Int64, ByVal codigo As String, ByVal numero As String, ByVal idTipoLectura As Int32, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FidelizarVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, numero)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "IdTipoLecturaTarjeta", DbType.Int32, idTipoLectura)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



#End Region

#Region "       Fidelizacion Peru       "

    Public Function ManejaRedFidelizacion() As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaRedFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CShort(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ManejaSaldoFidelizacion(ByVal idRedFidelizacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaSaldoFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                DB.AddInParameter(DatabaseCommand, "RedFidelizacion", DbType.Int16, idRedFidelizacion)
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function FidelizacionUltimaVenta() As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarParametro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As String = ""

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, "FidelizacionUltimaVenta")

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                For Each oRow As DataRow In DB.ExecuteDataSet(DatabaseCommand).Tables(0).Rows
                    If Trim(oRow("Valor").ToString()) = "True" Then
                        Resultado = "1"
                    Else
                        Resultado = "0"
                    End If

                Next
                Return Resultado


            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "   Consultas de MR a Base de Datos    "

    Public Function RecuperarTramaImpresoras() As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTramaImpresoras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As String = ""


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                For Each oRow As DataRow In DB.ExecuteDataSet(DatabaseCommand).Tables(0).Rows
                    Resultado = Trim(oRow("Trama").ToString())
                Next
                Return Resultado

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ActulizarCambioImpresoraIsla(ByVal IdIsla As Int32, ByVal IdImpresora As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActulizarCambioImpresoraIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As String = ""

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, IdIsla)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, IdImpresora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                For Each oRow As DataRow In DB.ExecuteDataSet(DatabaseCommand).Tables(0).Rows
                    Resultado = Trim(oRow("Mensaje").ToString())
                Next
                Return Resultado


            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "ServiPunto"
    Public Sub InsertarVehiculoServiPunto(ByVal placa As String, ByVal rom As String, ByVal fechaProximoMant As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculoServiPunto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "FechaProximoMant", DbType.Date, fechaProximoMant)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarVehiculoServiPunto(ByVal placa As String, ByVal rom As String, ByVal fechaProximoMant As Date, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculoServiPunto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "FechaProximoMant", DbType.Date, fechaProximoMant)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Clientes Locales Peru"

    Public Sub RegistrarBloqueoPagoFinanciamiento(ByVal IdBloqueo As Int32, ByVal FechaInicio As DateTime, ByVal FechaFin As DateTime, ByVal EsActivo As Boolean, ByVal Motivo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarBloqueoPagoFinanciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdBloqueo", DbType.Int32, IdBloqueo)
        DB.AddInParameter(DatabaseCommand, "FechaInicio", DbType.DateTime, FechaInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFin", DbType.DateTime, FechaFin)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "Motivo", DbType.String, Motivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ValidarFechaBloqueoPagoFinanciamiento(ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarFechaBloqueoPagoFinanciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)


            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub LevantarBloqueoPagoFinanciamiento(ByVal IdBloqueo As Int32)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "LevantarBloqueoPagoFinanciamiento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdBloqueo", DbType.Int32, IdBloqueo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Sub InsertarCompartimientoTmp(ByVal guid As String, ByVal IdCompartimiento As Nullable(Of Int32), ByVal Nombre As String, ByVal Capacidad As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCompartimientoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "GUID", DbType.String, guid)
        DB.AddInParameter(DatabaseCommand, "IdCompartimiento", DbType.Int32, IdCompartimiento)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCarroTanque(ByVal IdCarroTanque As Int32, ByVal Placa As String, ByVal Marca As String, ByVal IdTipoCarroTanque As Int32, ByVal guid As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCarroTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCarroTanque", DbType.Int32, IdCarroTanque)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Marca", DbType.String, Marca)
        DB.AddInParameter(DatabaseCommand, "IdTipoCarroTanque", DbType.Int32, IdTipoCarroTanque)
        DB.AddInParameter(DatabaseCommand, "GUID", DbType.String, guid)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarCarroTanque(ByVal Placa As String, ByVal Marca As String, ByVal IdTipoCarroTanque As Int32, ByVal guid As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCarroTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdCarroTanque As Int32

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Marca", DbType.String, Marca)
        DB.AddInParameter(DatabaseCommand, "IdTipoCarroTanque", DbType.Int32, IdTipoCarroTanque)
        DB.AddOutParameter(DatabaseCommand, "IdCarroTanque", DbType.Int32, CInt(IdCarroTanque))
        DB.AddInParameter(DatabaseCommand, "GUID", DbType.String, guid)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCarroTanque"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarProveedor(ByVal IdProveedor As Int32, ByVal Nit As String, ByVal Nombre As String, ByVal Direccion As String, ByVal Telefono As String, ByVal Email As String, ByVal IdCiudad As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarProveedor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProveedor", DbType.Int32, IdProveedor)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, Direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, Telefono)
        DB.AddInParameter(DatabaseCommand, "Email", DbType.String, Email)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, IdCiudad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarProveedor(ByVal Nit As String, ByVal Nombre As String, ByVal Direccion As String, ByVal Telefono As String, ByVal Email As String, ByVal IdCiudad As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarProveedor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdProveedor As Int32

        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, Direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, Telefono)
        DB.AddInParameter(DatabaseCommand, "Email", DbType.String, Email)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, IdCiudad)
        DB.AddOutParameter(DatabaseCommand, "IdProveedor", DbType.Int32, CInt(IdProveedor))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdProveedor"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarAutorizacionEstacion(ByVal IdAutorizacion As Int32, ByVal NroAutorizacion As String, ByVal Capacidad As Decimal, ByVal FechaInicial As Date, ByVal FechaFinal As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarAutorizacionEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.Int32, IdAutorizacion)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, NroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.Date, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.Date, FechaFinal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarAutorizacionEstacion(ByVal IdAutorizacion As Int32, ByVal NroAutorizacion As String, ByVal Capacidad As Decimal, ByVal FechaInicial As Date, ByVal FechaFinal As Date, ByVal EsActiva As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarAutorizacionEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.Int32, IdAutorizacion)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, NroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.Date, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.Date, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "EsActiva", DbType.Boolean, EsActiva)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarAutorizacionEstacion(ByVal NroAutorizacion As String, ByVal Capacidad As Decimal, ByVal FechaInicial As Date, ByVal FechaFinal As Date) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAutorizacionEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdNroAutorizacion As Int32

        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, NroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.Date, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.Date, FechaFinal)
        DB.AddOutParameter(DatabaseCommand, "IdAutorizacion", DbType.Int32, CInt(IdNroAutorizacion))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdAutorizacion"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarAutorizacionEstacion(ByVal NroAutorizacion As String, ByVal Capacidad As Decimal, ByVal FechaInicial As Date, ByVal FechaFinal As Date, ByVal EsActiva As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAutorizacionEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdNroAutorizacion As Int32

        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, NroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.Date, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.Date, FechaFinal)
        DB.AddOutParameter(DatabaseCommand, "IdAutorizacion", DbType.Int32, CInt(IdNroAutorizacion))
        DB.AddInParameter(DatabaseCommand, "EsActiva", DbType.Boolean, EsActiva)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdAutorizacion"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarClienteLocal(ByVal idCliente As Int32, ByVal nombre As String, ByVal ruc As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, ruc)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarClienteLocal(ByVal nombre As String, ByVal ruc As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdCliente As Int32

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, ruc)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddOutParameter(DatabaseCommand, "IdCliente", DbType.Int32, CInt(IdCliente))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCliente"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarConductorLocal(ByVal RUC As String, ByVal Nombre As String, ByVal Apellido As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarConductorLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdClienteEstacion As Integer

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Apellido", DbType.String, Apellido)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                IdClienteEstacion = Convert.ToInt32(DB.ExecuteScalar(DatabaseCommand))
                Return IdClienteEstacion
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarClienteLocal(ByVal idCliente As Int32, ByVal nombre As String, ByVal ruc As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32, ByVal razonSocial As String, Optional ByVal EsActivo As Boolean = True)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, ruc)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, razonSocial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarConductorLocal(ByVal IdConductor As Int64, ByVal Ruc As String, ByVal Nombre As String, ByVal Apellido As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarConductorLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdConductor", DbType.Int64, IdConductor)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Apellido", DbType.String, Apellido)
        
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarClienteLocal(ByVal nombre As String, ByVal ruc As String, ByVal direccion As String, ByVal telefono As String, ByVal idCiudad As Int32, ByVal razonSocial As String, Optional ByVal EsActivo As Boolean = True) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdCliente As Int32

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, ruc)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "Direccion", DbType.String, direccion)
        DB.AddInParameter(DatabaseCommand, "Telefono", DbType.String, telefono)
        DB.AddInParameter(DatabaseCommand, "IdCiudad", DbType.Int32, idCiudad)
        DB.AddOutParameter(DatabaseCommand, "IdCliente", DbType.Int32, CInt(IdCliente))
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, razonSocial)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCliente"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub SincronizarPrecioClienteCredito(ByVal idCliente As Int32, ByVal valor As Decimal, ByVal aplicaPorcentaje As Boolean, ByVal esDescuento As Boolean, ByVal esActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SincronizarPrecioClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "AplicaPorcentaje", DbType.Boolean, aplicaPorcentaje)
        DB.AddInParameter(DatabaseCommand, "EsDescuento", DbType.Boolean, esDescuento)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarPrecioClienteCredito(ByVal identificacion As String, ByVal valor As Decimal, ByVal aplicaPorcentaje As Boolean, ByVal esDescuento As Boolean, ByVal esActivo As Boolean, ByVal EsDescuentoVehiculo As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPrecioClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "AplicaPorcentaje", DbType.Boolean, aplicaPorcentaje)
        DB.AddInParameter(DatabaseCommand, "EsDescuento", DbType.Boolean, esDescuento)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivo)
        DB.AddInParameter(DatabaseCommand, "EsDescuentoVehiculo", DbType.Boolean, EsDescuentoVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPrecioClienteCredito(ByVal identificacion As String, ByVal valor As Decimal, ByVal aplicaPorcentaje As Boolean, ByVal esDescuento As Boolean, ByVal esActivo As Boolean, ByVal EsDescuentoVehiculo As Boolean, ByVal AplicaEnSurtidor As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPrecioClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "identificacion", DbType.String, identificacion)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "AplicaPorcentaje", DbType.Boolean, aplicaPorcentaje)
        DB.AddInParameter(DatabaseCommand, "EsDescuento", DbType.Boolean, esDescuento)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivo)
        DB.AddInParameter(DatabaseCommand, "EsDescuentoVehiculo", DbType.Boolean, EsDescuentoVehiculo)
        DB.AddInParameter(DatabaseCommand, "AplicaEnSurtidor", DbType.Boolean, AplicaEnSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarPrecioClienteCredito(ByVal IdPrecio As Int32, ByVal valor As Decimal, ByVal aplicaPorcentaje As Boolean, ByVal esDescuento As Boolean, ByVal esActivo As Boolean, ByVal EsDescuentoVehiculo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPrecioClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPrecio", DbType.Int32, IdPrecio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "AplicaPorcentaje", DbType.Boolean, aplicaPorcentaje)
        DB.AddInParameter(DatabaseCommand, "EsDescuento", DbType.Boolean, esDescuento)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivo)
        DB.AddInParameter(DatabaseCommand, "EsDescuentoVehiculo", DbType.Boolean, EsDescuentoVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarPrecioClienteCredito(ByVal IdPrecio As Int32, ByVal valor As Decimal, ByVal aplicaPorcentaje As Boolean, ByVal esDescuento As Boolean, ByVal esActivo As Boolean, ByVal EsDescuentoVehiculo As Boolean, ByVal AplicaEnSurtidor As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPrecioClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPrecio", DbType.Int32, IdPrecio)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "AplicaPorcentaje", DbType.Boolean, aplicaPorcentaje)
        DB.AddInParameter(DatabaseCommand, "EsDescuento", DbType.Boolean, esDescuento)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivo)
        DB.AddInParameter(DatabaseCommand, "EsDescuentoVehiculo", DbType.Boolean, EsDescuentoVehiculo)
        DB.AddInParameter(DatabaseCommand, "AplicaEnSurtidor", DbType.Boolean, AplicaEnSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarPrecioCategoriaANH(ByVal idProducto As Integer, ByVal idCategoria As Nullable(Of Int32), ByVal precio As Double, ByVal Fecha As DateTime)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPrecioANH"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProductoANH", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "idCategoria", DbType.Int32, idCategoria)
        DB.AddInParameter(DatabaseCommand, "precio", DbType.Double, precio)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarPrecioClienteCreditoVehiculo(ByVal IdPrecioClienteCredito As Int32, ByVal vehiculos As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPrecioClienteCreditoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPrecioClienteCredito", DbType.Int32, IdPrecioClienteCredito)
        DB.AddInParameter(DatabaseCommand, "Vehiculos", DbType.String, vehiculos)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarPrecioClienteCreditoProductos(ByVal IdPrecioClienteCredito As Int32, ByVal Productos As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPrecioClienteCreditoProductos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPrecioClienteCredito", DbType.Int32, IdPrecioClienteCredito)
        DB.AddInParameter(DatabaseCommand, "Productos", DbType.String, Productos)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarPrecioClienteCredito(ByVal Identificacion As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Identificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarClienteLocalPorId(ByVal idCliente As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClienteLocalPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarPrecioClienteCredito(ByVal IdPrecio As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPrecioCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPrecio", DbType.Int32, IdPrecio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarClienteLocal(ByVal idCliente As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarClienteLocal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarConductorLocalPorID(ByVal IdConductor As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarConductorLocalPorID"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdConductor", DbType.Int32, IdConductor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarClientesLocales(ByVal nombre As String, ByVal ruc As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClientesLocales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, ruc)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarConductorLocalPorRUC(ByVal RUC As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductorLocalPorRUC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConductorLocalPorRUC(ByVal RUC As String, ByVal IdConductor As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductorLocalPorRUC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "IdConductor", DbType.Int32, IdConductor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCarroTanquePorId(ByVal IdCarroTanque As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarroTanquePorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCarroTanque", DbType.Int32, IdCarroTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCarroTanquePorPlaca(ByVal Placa As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarroTanquePorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCompartimientosPorCarroTanque(ByVal IdCarroTanque As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCompartimientosPorCarroTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCarroTanque", DbType.Int32, IdCarroTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarCarroTanque(IdCarroTanque As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarCarroTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCarroTanque", DbType.Int32, IdCarroTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarCarroTanques() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCarroTanques"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTiposCarroTanque() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposCarroTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProveedorPorId(IdProveedor As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProveedorPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProveedor", DbType.Int32, IdProveedor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProveedorPorNit(Nit As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProveedorPorNit"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarProveedor(ByVal IdProveedor As Integer)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarProveedor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdProveedor", DbType.Int32, IdProveedor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarNroAutorizacionPorId(IdNroAutorizacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNroAutorizacionPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.Int32, IdNroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarAutorizacionEstacionPorNro(Nro As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAutorizacionEstacionPorNro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nro", DbType.String, Nro)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarNroAutorizacionEstacion(IdNroAutorizacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarNroAutorizacionEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.Int32, IdNroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarNrosAutorizacionEstacion() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNrosAutorizacionEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Creditos Consumo Peru"

    Public Function RecuperarReciboPorFacturacion(ByVal consecutivoFacturacion As String) As Long
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboFacturacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdVentaFacturacion", DbType.Int32, CInt(consecutivoFacturacion))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTiposIdentificacion() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposIdentificacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTiposIdentificacionVehiculo() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposIdentificacionVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTiposIncremento() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposIncremento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTiposCredito() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub IngresarTarjetaACreditoConsumo(ByVal idCredito As Integer, ByVal Numero As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "IngresarTarjetaACreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub IngresarVehiculoACreditoConsumo(ByVal idCredito As Int32, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "IngresarVehiculoACreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarTarjetaEnCreditoConsumo(ByVal idCredito As Int32, ByVal IdTarjetaConsumo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTarjetaEnCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "IdTarjetaConsumo", DbType.Int32, IdTarjetaConsumo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarVehiculoEnCreditoConsumo(ByVal idCredito As Int32, ByVal idVehiculo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarVehiculoEnCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Function RecuperarTarjetaCreditoConsumo(ByVal idCredito As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTarjetaCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarVehiculosCreditoConsumo(ByVal idCredito As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculosCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarTarjetaEnCreditoConsumo(ByVal idCredito As Int32, ByVal idTarjetaConsumo As Int32, ByVal esActivado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTarjetaEnCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "IdTarjetaConsumo", DbType.Int32, idTarjetaConsumo)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, esActivado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVehiculoEnCreditoConsumo(ByVal idCredito As Int32, ByVal idVehiculo As Int32, ByVal esActivado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVehiculoEnCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int32, idVehiculo)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarCreditoConsumoPorNumero(ByVal numeroCredito As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditoConsumoPorNumero"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditosConsumoPorRUC(ByVal RUC As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosConsumoPorRUC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ManejaCupoTipoCredito(ByVal idTipoCredito As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaCupoTipoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean


        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, idTipoCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ManejaCreditoConCupo(ByVal Placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaCreditoConCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function ManejaCreditoConCupo(ByVal Identificador As String, ByVal idTipoIdentificador As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaCreditoConCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, Identificador)
        DB.AddInParameter(DatabaseCommand, "IdTipoIdentificador", DbType.Int32, idTipoIdentificador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function InsertarCreditoConsumo(ByVal RUC As String, ByVal cupo As Decimal, ByVal idTipoCredito As Int32, ByVal numeroCredito As String, ByVal fecha As DateTime, ByVal esActivado As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdCredito As Int32

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, idTipoCredito)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)
        DB.AddOutParameter(DatabaseCommand, "IdCredito", DbType.Int32, CInt(IdCredito))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCredito"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function InsertarCreditoConsumoFullStation(ByVal RUC As String, ByVal cupo As Decimal, ByVal idTipoCredito As Int32, ByVal numeroCredito As String, ByVal fecha As DateTime, ByVal esActivado As Boolean, ByVal IdTiposIdentificacionCredito As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdCredito As Int32

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, idTipoCredito)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)
        DB.AddInParameter(DatabaseCommand, "IdTiposIdentificacionCredito", DbType.Int32, IdTiposIdentificacionCredito)
        DB.AddOutParameter(DatabaseCommand, "IdCredito", DbType.Int32, CInt(IdCredito))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCredito"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function InsertarCreditoConsumoFullStation(ByVal RUC As String, ByVal cupo As Decimal, ByVal idTipoCredito As Int32, ByVal numeroCredito As String, ByVal fecha As DateTime, ByVal esActivado As Boolean, ByVal IdTiposIdentificacionCredito As Int32, NroLetra As String, ValorLetra As Nullable(Of Decimal), NroOrden As Nullable(Of Int32)) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdCredito As Int32

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, idTipoCredito)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)
        DB.AddInParameter(DatabaseCommand, "IdTiposIdentificacionCredito", DbType.Int32, IdTiposIdentificacionCredito)
        DB.AddOutParameter(DatabaseCommand, "IdCredito", DbType.Int32, CInt(IdCredito))
        DB.AddInParameter(DatabaseCommand, "NroLetra", DbType.String, NroLetra)
        DB.AddInParameter(DatabaseCommand, "ValorLetra", DbType.Decimal, ValorLetra)
        DB.AddInParameter(DatabaseCommand, "NroOrden", DbType.Int32, NroOrden)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCredito"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarCreditoConsumoFullStation(ByVal idCredito As Int32, ByVal RUC As String, ByVal cupo As Decimal, ByVal idTipoCredito As Int32, ByVal numeroCredito As String, ByVal fecha As DateTime, ByVal esActivado As Boolean, ByVal IdTiposIdentificacionCredito As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, idTipoCredito)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)
        DB.AddInParameter(DatabaseCommand, "IdTiposIdentificacionCredito", DbType.Int32, IdTiposIdentificacionCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarCreditoConsumoFullStation(ByVal idCredito As Int32, ByVal RUC As String, ByVal cupo As Decimal, ByVal idTipoCredito As Int32, ByVal numeroCredito As String, ByVal fecha As DateTime, ByVal esActivado As Boolean, ByVal IdTiposIdentificacionCredito As Int32, NroLetra As String, ValorLetra As Nullable(Of Decimal), NroOrden As Nullable(Of Int32))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, idTipoCredito)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)
        DB.AddInParameter(DatabaseCommand, "IdTiposIdentificacionCredito", DbType.Int32, IdTiposIdentificacionCredito)
        DB.AddInParameter(DatabaseCommand, "NroLetra", DbType.String, NroLetra)
        DB.AddInParameter(DatabaseCommand, "ValorLetra", DbType.Decimal, ValorLetra)
        DB.AddInParameter(DatabaseCommand, "NroOrden", DbType.Int32, NroOrden)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarCreditoConsumo(ByVal idCredito As Int32, ByVal RUC As String, ByVal cupo As Decimal, ByVal idTipoCredito As Int32, ByVal numeroCredito As String, ByVal fecha As DateTime, ByVal esActivado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, idCredito)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Cupo", DbType.Decimal, cupo)
        DB.AddInParameter(DatabaseCommand, "IdTipoCredito", DbType.Int32, idTipoCredito)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarVentasNoFacturadas(ByVal RUC As String, ByVal numeroCredito As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasNoFacturadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarVentasNoFacturadasCredito(ByVal RUC As String, ByVal numeroCredito As String, ByVal Finicial As DateTime, ByVal FFinal As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasNoFacturadasCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, Finicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FFinal)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasNoFacturadasCredito(ByVal RUC As String, ByVal numeroCredito As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasNoFacturadasCredito2"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasNoFacturadasCredito2(ByVal RUC As String, ByVal numeroCredito As String, ByVal Finicial As DateTime, ByVal FFinal As DateTime) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasNoFacturadasCredito2"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, Finicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FFinal)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturasCredito(ByVal RUC As String, ByVal numeroCredito As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturasCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function FacturarVentasCredito(ByVal RUC As String, ByVal numeroCredito As String, ByVal Finicial As DateTime, ByVal FFinal As DateTime) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FacturarVentasCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdFactura As Int32

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "FInicial", DbType.DateTime, Finicial)
        DB.AddInParameter(DatabaseCommand, "FFinal", DbType.DateTime, FFinal)
        DB.AddOutParameter(DatabaseCommand, "IdFactura", DbType.Int32, CInt(IdFactura))
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdFactura"))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarEstadoFacturaCredito(ByVal RUC As String, ByVal numeroCredito As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoFacturaCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub FacturarVentasCreditoConsumoTmp(ByVal idVentaFacturacion As Int64, ByVal factura As String, ByVal numeroCredito As String, ByVal EsVentaCanastilla As Boolean, ByVal borrarTemporal As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FacturarVentasCreditoConsumoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdVentaFacturacion", DbType.Int64, idVentaFacturacion)
        DB.AddInParameter(DatabaseCommand, "Factura", DbType.String, factura)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)
        DB.AddInParameter(DatabaseCommand, "BorrarTemporal", DbType.Boolean, borrarTemporal)
        DB.AddInParameter(DatabaseCommand, "EsVentaCanastilla", DbType.Boolean, EsVentaCanastilla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub FacturarVentasCreditoConsumo(ByVal RUC As String, ByVal factura As String, ByVal numeroCredito As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FacturarVentasCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Factura", DbType.String, factura)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub FacturarVentasCreditoConsumoSinRecaudo(ByVal RUC As String, ByVal factura As String, ByVal numeroCredito As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FacturarVentasCreditoConsumoSinRecaudo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Factura", DbType.String, factura)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, numeroCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarClientePorRUC(ByVal RUC As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClienteLocalPorRUC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarClienteLocalPorRUC(ByVal RUC As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClienteLocalPorRUC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ActualizarVentaCreditoChile(ByVal Recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVentaCreditoManualCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub


    Public Sub AutorizarVentaCreditoConsumoPeru(ByVal RUC As String, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AutorizarVentaCreditoConsumo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Sub AutorizacionVentaCredito(ByVal TipoIdentificacion As Integer, ByVal Documento As String, ByVal DocumentoAux As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AutorizacionVentaCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, DocumentoAux)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub



    Public Sub AutorizacionVentaCredito(ByVal TipoIdentificacion As Integer, ByVal Documento As String, ByVal DocumentoAux As String, ByVal Nit As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AutorizacionVentaCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, TipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "IdentificacionAux", DbType.String, DocumentoAux)
        DB.AddInParameter(DatabaseCommand, "RucCliente", DbType.String, Nit)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

#End Region

#Region "Generador"
    ' Revisado Con Manejo eficiente del Pool de Conexion
    Public Sub CargarRazonSocial(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "CargarRazonSocial"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

                connection.Close()
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Sub

    Public Function RecuperarReportesPeru() As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReportes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim TablaDataSet As DataSet
        Dim TablaDataTable As DataTable
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                TablaDataSet = DB.ExecuteDataSet(DatabaseCommand)
                TablaDataTable = TablaDataSet.Tables(0)
                Return TablaDataTable
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "Densidad Gazel"
    Public Function ExistenProtocolosPumpControl() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExistenProtocolosPumpControl"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarHistoricoDensidad(ByVal densidad As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarHistoricoDensidad"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Densidad", DbType.Decimal, densidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Terpel Ecuador"
    Public Function RecuperarTanque() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTanque(ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVentasFacturar(ByVal FechaInicial As String, ByVal FechaFinal As String, _
                                            ByVal Placa As String, ByVal Documento As String) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasFacturar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.String, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.String, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)


            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
#End Region

#Region "SRE"
    Public Sub ActualizarCondicionesPorServicio(ByVal idServicio As Int32, ByVal minTanqueoPorDia As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCondicionesPorServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, idServicio)
        DB.AddInParameter(DatabaseCommand, "MinTanqueoPorDia", DbType.Decimal, minTanqueoPorDia)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarCondicionesPorServicio(ByVal idServicio As Int32) As IDataReader

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCondicionesPorServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdServicio", DbType.Int32, idServicio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function
#End Region

#Region "Medios Pago Venta"
    Public Function RecuperarMedioPagoNoAutorizadoPorRecibo(ByVal recibo As Long, ByVal documento As String, ByVal medioPago As Short) As DataTable

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMedioPagoNoAutorizadoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdMedioPago", DbType.Int16, medioPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarMediosPagoTemp(ByVal Recibo As Double, ByVal IdFormaPago As Int16, ByVal Documento As String, ByVal Valor As Double, ByVal saldo As Decimal, ByVal EsAutorizado As Boolean, ByVal IdTipoLectura As Int32, ByVal NroConfirmacion As String, ByVal MontoReal As Double, ByVal esMedioPagoEspecial As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMediosPagoTemp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdMedioPago As Int64

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago ", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Double, Valor)
        DB.AddInParameter(DatabaseCommand, "Saldo", DbType.Decimal, saldo)
        DB.AddInParameter(DatabaseCommand, "EsAutorizado", DbType.Boolean, EsAutorizado)
        DB.AddInParameter(DatabaseCommand, "IdTipoLectura", DbType.Int32, IdTipoLectura)
        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, NroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "EsMedioPagoEspecial", DbType.Boolean, esMedioPagoEspecial)
        DB.AddInParameter(DatabaseCommand, "MontoReal", DbType.Decimal, MontoReal)

        DB.AddOutParameter(DatabaseCommand, "IdMedioPago", DbType.Int64, CInt(IdMedioPago))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CLng(DB.GetParameterValue(DatabaseCommand, "IdMedioPago"))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarMediosPagoTemp(ByVal IdMedioPago As Int64, ByVal valor As Double, ByVal Saldo As Double, ByVal MontoReal As Double, ByVal EsAutorizado As Boolean)

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarMediosPagoTemp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMedioPago", DbType.Int64, IdMedioPago)
        DB.AddInParameter(DatabaseCommand, "EsAutorizado", DbType.Boolean, EsAutorizado)
        DB.AddInParameter(DatabaseCommand, "MontoReal", DbType.Decimal, MontoReal)
        DB.AddInParameter(DatabaseCommand, "Saldo", DbType.Decimal, Saldo)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarMediosPago(ByVal recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMediosPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarMedioPagoTemp(ByVal IdMedioPago As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMedioPagoTemp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMedioPago", DbType.Int64, IdMedioPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarMediosPagoTemporales(ByVal Recibo As Long, ByVal IdFormaPago As Integer, ByVal NroTarjeta As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMediosPagoTemporales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, NroTarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return (DB.ExecuteReader(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarEstadoVenta(ByVal Recibo As Int64, ByVal IdEstado As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstado", DbType.Int32, IdEstado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstadoTransmisionVenta(ByVal Recibo As Int64, ByVal IdEstado As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoTransmisionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstado", DbType.Int32, IdEstado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstadoRecaudo(ByVal IdRecaudo As Int32, ByVal IdEstado As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoRecaudo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "IdEstado", DbType.Int32, IdEstado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarEstadoRecaudo(ByVal IdRecaudo As Int32, ByVal IdEstado As Int32, ByVal IdEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoRecaudo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRecaudo", DbType.Int32, IdRecaudo)
        DB.AddInParameter(DatabaseCommand, "IdEstado", DbType.Int32, IdEstado)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarEstadoVenta(ByVal Recibo As Long) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstadoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEstadoVenta(ByVal Recibo As Long, ByVal idEstacion As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstadoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteMedioPagoEnVenta(ByVal Recibo As Long, ByVal IdFormaPago As Integer, ByVal NroTarjeta As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteMedioPagoEnVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, NroTarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteMediosPagosEspecialesAutorizados(ByVal Recibo As Int64) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteMediosPagosEspecialesAutorizados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ExisteSaldoTarjeta(ByVal NroTarjeta As String, ByVal valor As Double) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteSaldoTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, NroTarjeta)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSaldoCupo(ByVal NroTarjeta As String) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaldoCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, NroTarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDbl(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSaldoCupoVenta(ByVal Recibo As Int64) As Double
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaldoCupoVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDbl(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Slogans Mexico"
    Public Function RecuperarSlogansPorContrato(ByVal contrato As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSlogansPorContrato"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Contrato", DbType.String, contrato)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Aforos"
    Public Sub CargarAforos(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarAforos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Dispositivos de Medicin    "
    Public Function RecuperarTanquesActivosPorDispositivo(ByVal idDispositivo As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesActivosPorDispositivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int32, idDispositivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTanquesActivosPorDispositivo(ByVal idDispositivo As Int32, ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesActivosPorDispositivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int32, idDispositivo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDispositivosMedicionActivos() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivosMedicionActivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarDispositivosMedicionActivos(ByVal IdEstacion As Short) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivosMedicionActivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDispositivosMedicion(ByVal IdEstacion As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivosMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        'DatabaseCommand.CommandTimeout = 90
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarDispositivosMedicion() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivosMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        'DatabaseCommand.CommandTimeout = 90
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    'Public Sub InsertarDispositivoMedicion(ByVal Nombre As String, ByVal EsActivo As Boolean, ByVal IdPuerto As Int16)
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "InsertarDispositivoMedicion"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

    '    DatabaseCommand.CommandTimeout = 90

    '    DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
    '    DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
    '    DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, IdPuerto)

    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()
    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            DB.ExecuteNonQuery(DatabaseCommand)
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Sub

    'Public Sub ModificarDispositivoMedicion(ByVal IdDispositivo As Int16, ByVal Nombre As String, ByVal EsActivo As Boolean, ByVal IdPuerto As Int16)
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "ModificarDispositivoMedicion"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

    '    DatabaseCommand.CommandTimeout = 90

    '    DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)
    '    DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
    '    DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
    '    DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, IdPuerto)

    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()
    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            DB.ExecuteNonQuery(DatabaseCommand)
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Sub

    Public Sub InsertarDispositivoMedicion(ByVal Nombre As String, ByVal EsActivo As Boolean, ByVal IdPuerto As Int16, ByVal TipoComunicacion As Int16, ByVal IP As String, ByVal PuertoIP As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDispositivoMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, IdPuerto)
        DB.AddInParameter(DatabaseCommand, "TipoComunicacion", DbType.Int16, TipoComunicacion)
        DB.AddInParameter(DatabaseCommand, "IP", DbType.String, IP)
        DB.AddInParameter(DatabaseCommand, "PuertoIP", DbType.String, PuertoIP)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub InsertarDispositivoMedicion(ByVal Nombre As String, ByVal EsActivo As Boolean, ByVal IdPuerto As Int16, ByVal TipoComunicacion As Int16, ByVal IP As String, ByVal PuertoIP As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDispositivoMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, IdPuerto)
        DB.AddInParameter(DatabaseCommand, "TipoComunicacion", DbType.Int16, TipoComunicacion)
        DB.AddInParameter(DatabaseCommand, "IP", DbType.String, IP)
        DB.AddInParameter(DatabaseCommand, "PuertoIP", DbType.String, PuertoIP)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ModificarDispositivoMedicion(ByVal IdDispositivo As Int16, ByVal Nombre As String, ByVal EsActivo As Boolean, ByVal IdPuerto As Int16, ByVal TipoComunicacion As Int16, ByVal IP As String, ByVal PuertoIP As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ModificarDispositivoMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, IdPuerto)
        DB.AddInParameter(DatabaseCommand, "TipoComunicacion", DbType.Int16, TipoComunicacion)
        DB.AddInParameter(DatabaseCommand, "IP", DbType.String, IP)
        DB.AddInParameter(DatabaseCommand, "PuertoIP", DbType.String, PuertoIP)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Sub ModificarDispositivoMedicion(ByVal IdDispositivo As Int16, ByVal Nombre As String, ByVal EsActivo As Boolean, ByVal IdPuerto As Int16, ByVal TipoComunicacion As Int16, ByVal IP As String, ByVal PuertoIP As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ModificarDispositivoMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int16, IdPuerto)
        DB.AddInParameter(DatabaseCommand, "TipoComunicacion", DbType.Int16, TipoComunicacion)
        DB.AddInParameter(DatabaseCommand, "IP", DbType.String, IP)
        DB.AddInParameter(DatabaseCommand, "PuertoIP", DbType.String, PuertoIP)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarDispositivoMedicion(ByVal IdDispositivo As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarDispositivoMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarDispositivoMedicionPorID(ByVal IdDispositivo As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDispositivoMedicionPorID"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTipoComunicacionDispositivo() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoComunicacionDispositivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "Pedidos de Combustible"
    Public Sub CargarPedidosCombustible(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarPedidosCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarPedidoCombustible(ByVal documento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarPedidoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Tanques"
    Public Function EsTanqueConectadoPorSifon(ByVal codigo As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsTanqueConectadoPorSifon"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function EsTanqueConectadoPorSifon(ByVal codigo As String, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsTanqueConectadoPorSifon"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTanquesHijoYPadreConectadosPorSifon(ByVal codigo As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesHijoYPadreConectadosPorSifon"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTanquesHijoYPadreConectadosPorSifon(ByVal codigo As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesHijoYPadreConectadosPorSifon"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codigo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDiasParaAjustarStocks() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDiasParaAjustarStocks"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDiasParaAjustarStocks(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDiasParaAjustarStocks"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTanquesConectados() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesConectados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function






    Public Function RecuperarTanquesConectados(ByVal IdEstacion As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesConectados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarTiposTanquesConectados() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposTanquesConectados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTanques() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanques"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTanquesDataTable() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesAll"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarTanquesDataTable(ByVal IdEstacion As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesAll"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarTanquePorId(ByVal IdTanque As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquePorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdDispositivoporTanque(ByVal Tanque As String) As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDispositivoporTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CShort(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTanquesPorIdDispositivo(ByVal IdDispositivo As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesPorIdDispositivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarStockTurno(ByVal idTurno As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarStockTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimasVariablesPorTanque(ByVal codigo As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimasVariablesPorTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimasVariablesMedicionTurno(ByVal idTurno As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimasVariablesMedicionTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturacionCombustibleTerpel(ByVal idDocumento As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturacionCombustibleTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int32, idDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFacturacionCanastillaTerpel(ByVal idDocumento As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturacionCanastillaTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int32, idDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDetalleFacturacionCombustibleTerpel(ByVal idDocumento As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleFacturacionCombustibleTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int32, idDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDetalleFacturacionCanastillaTerpel(ByVal idDocumento As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleFacturacionCanastillaTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int32, idDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarTanque(ByVal Descripcion As String, ByVal Nombre As String, ByVal Codigo As String, ByVal Capacidad As Decimal, ByVal Stock As Decimal, ByVal EsActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)
        DB.AddInParameter(DatabaseCommand, "Stock", DbType.Decimal, Stock)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




 
    Public Sub InsertarTanquesConectados(ByVal TanquePrincipal As Integer, ByVal TanqueHijo As Integer, ByVal Tipo As Byte)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanquesConectados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TanquePrincipal", DbType.Int32, TanquePrincipal)
        DB.AddInParameter(DatabaseCommand, "TanqueHijo", DbType.Int32, TanqueHijo)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Byte, Tipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTanquesConectados(ByVal TanquePrincipal As Integer, ByVal TanqueHijo As Integer, ByVal Tipo As Byte, ByVal IdEstacion As Short)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanquesConectados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TanquePrincipal", DbType.Int32, TanquePrincipal)
        DB.AddInParameter(DatabaseCommand, "TanqueHijo", DbType.Int32, TanqueHijo)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Byte, Tipo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarTanquesConectados(ByVal TanquePrincipal As Integer, ByVal TanqueHijo As Integer, ByVal Tipo As Byte)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTanquesConectados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TanquePrincipal", DbType.Int32, TanquePrincipal)
        DB.AddInParameter(DatabaseCommand, "TanqueHijo", DbType.Int32, TanqueHijo)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Byte, Tipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub EliminarTanquesConectados(ByVal TanquePrincipal As Integer, ByVal TanqueHijo As Integer, ByVal Tipo As Byte, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTanquesConectados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TanquePrincipal", DbType.Int32, TanquePrincipal)
        DB.AddInParameter(DatabaseCommand, "TanqueHijo", DbType.Int32, TanqueHijo)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Byte, Tipo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ModificarTanque(ByVal idTanque As Int16, ByVal Descripcion As String, ByVal Nombre As String, ByVal Codigo As String, ByVal Capacidad As Decimal, ByVal Stock As Decimal, ByVal IdDispositivo As System.Nullable(Of Int16), ByVal EsActivo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ModificarTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, idTanque)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)
        DB.AddInParameter(DatabaseCommand, "Stock", DbType.Decimal, Stock)
        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub ModificarTanque(ByVal idTanque As Int16, ByVal Descripcion As String, ByVal Nombre As String, ByVal Codigo As String, ByVal Capacidad As Decimal, ByVal Stock As Decimal, ByVal IdDispositivo As System.Nullable(Of Int16), ByVal EsActivo As Boolean, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ModificarTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, idTanque)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)
        DB.AddInParameter(DatabaseCommand, "Capacidad", DbType.Decimal, Capacidad)
        DB.AddInParameter(DatabaseCommand, "Stock", DbType.Decimal, Stock)
        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int16, IdDispositivo)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarTanqueProducto() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanqueProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTanqueProducto(ByVal IdEstacion As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanqueProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTanqueProductoPorTanque(ByVal IdTanque As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanqueProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarTanqueProducto(ByVal IdTanque As Int16, ByVal IdProducto As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanqueProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarTanqueProducto(ByVal IdTanque As Int16, ByVal IdProducto As Int16, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanqueProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarTanqueProducto(ByVal IdTanque As Int16, ByVal IdProducto As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTanqueProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region

#Region "   Logueo de Alarmas   "

    Public Sub InsertaAlarmaMedicion(ByVal IdTipoAlarma As Int16, ByVal IdDispositivoMedicion As Int16, ByVal IdTurno As Int64, ByVal IdTanque As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertaAlarmaMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoAlarma", DbType.Int16, IdTipoAlarma)
        DB.AddInParameter(DatabaseCommand, "IdDispositivoMedicion", DbType.Int16, IdDispositivoMedicion)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int16, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)
        'DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertaAlarmaMedicion(ByVal IdTipoAlarma As Int16, ByVal IdDispositivoMedicion As Int16, ByVal IdTurno As Int64, ByVal IdTanque As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertaAlarmaMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoAlarma", DbType.Int16, IdTipoAlarma)
        DB.AddInParameter(DatabaseCommand, "IdDispositivoMedicion", DbType.Int16, IdDispositivoMedicion)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int16, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        'DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertaVariableMedicion(ByVal IdTipoVariable As Int16, ByVal IdDispositivoMedicion As Int16, ByVal IdTurno As Int64, ByVal idTanque As Int16, ByVal Valor As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertaVariableMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoVariable", DbType.Int16, IdTipoVariable)
        DB.AddInParameter(DatabaseCommand, "IdDispositivoMedicion", DbType.Int16, IdDispositivoMedicion)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int16, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, idTanque)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertaVariableMedicion(ByVal IdTipoVariable As Int16, ByVal IdDispositivoMedicion As Int16, ByVal IdTurno As Int64, ByVal idTanque As Int16, ByVal Valor As Decimal, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertaVariableMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoVariable", DbType.Int16, IdTipoVariable)
        DB.AddInParameter(DatabaseCommand, "IdDispositivoMedicion", DbType.Int16, IdDispositivoMedicion)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int16, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, idTanque)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarAlarmaMedicion(ByVal IdTipoAlarma As Int16, ByVal CodTanque As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAlarmaMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoAlarmaMedicion", DbType.Int32, IdTipoAlarma)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarAlarmaMedicion(ByVal IdTipoAlarma As Int16, ByVal CodTanque As String, ByVal idestacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAlarmaMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoAlarmaMedicion", DbType.Int32, IdTipoAlarma)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idestacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVariableMedicion(ByVal IdTipoVariable As Int16, ByVal Valor As Decimal, ByVal CodTanque As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVariableMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoVariable", DbType.Int32, IdTipoVariable)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarVariableMedicion(ByVal IdTipoVariable As Int16, ByVal Valor As Decimal, ByVal CodTanque As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVariableMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTipoVariable", DbType.Int32, IdTipoVariable)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Motivos Calibracion"
    Public Function RecuperarMotivosCalibracion() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMotivosCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Turnos"
    Public Function ValidarTurnoAbierto(ByVal empleado As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTurnoAbierto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalPorTipoFormaPago(ByVal idTipoFormaPago As Int16) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalPorTipoFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Decimal

        DB.AddInParameter(DatabaseCommand, "IdTipoFormaPago", DbType.Int16, idTipoFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CDec(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
#End Region

#Region "Empleados"
    Public Function EsEmpleadoAdministrador(ByVal empleado As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsEmpleadoAdministrador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Ajustes Por Baja    "

    Public Function InsertarPorAjusteBajaCombustible(ByVal Producto As Int32, ByVal Tanque As String, ByVal Cantidad As Decimal, ByVal Fecha As DateTime) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPorAjusteBaja"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, Producto)
        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarPorAjusteBajaCanastilla(ByVal codigoProducto As Int32, ByVal Cantidad As Int32, ByVal Fecha As DateTime) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPorAjusteBajaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int32, codigoProducto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, Cantidad)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString()
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "Calibraciones"
    Public Function InsertarCalibracion(ByVal idCara As Int16, ByVal idManguera As Int16, ByVal idMotivo As Int32, ByVal valor As Decimal, ByVal cantidad As Decimal, ByVal idProducto As Int32, ByVal lecturaFinal As Decimal, ByVal precio As Decimal) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdMotivoCalibracion", DbType.Int32, idMotivo)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)

        Dim IdCalibracion As Int32
        DB.AddOutParameter(DatabaseCommand, "IdCalibracion", DbType.Int32, CInt(IdCalibracion))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCalibracion"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarCalibracion(ByVal idCara As Int16, ByVal idManguera As Int16, ByVal idMotivo As Int32, ByVal valor As Decimal, ByVal cantidad As Decimal, ByVal idProducto As Int32, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal IdEmpleadoAdministrador As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdMotivoCalibracion", DbType.Int32, idMotivo)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "IdEmpleadoAdministrador", DbType.Decimal, IdEmpleadoAdministrador)

        Dim IdCalibracion As Int32
        DB.AddOutParameter(DatabaseCommand, "IdCalibracion", DbType.Int32, CInt(IdCalibracion))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCalibracion"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function InsertarCalibracion(ByVal idCara As Int16, ByVal idManguera As Int16, ByVal idMotivo As Int32, ByVal valor As Decimal, ByVal cantidad As Decimal, ByVal idProducto As Int32, ByVal lecturaFinal As Decimal, ByVal precio As Decimal, ByVal IdEstacion As Integer) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, idCara)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, lecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdMotivoCalibracion", DbType.Int32, idMotivo)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Dim IdCalibracion As Int32
        DB.AddOutParameter(DatabaseCommand, "IdCalibracion", DbType.Int32, CInt(IdCalibracion))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdCalibracion"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCalibracion(ByVal idCalibracion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdCalibracion", DbType.Int32, idCalibracion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarCalibracion(ByVal idCalibracion As Int32, ByVal IdEstacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdCalibracion", DbType.Int32, idCalibracion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarCalibracionesPorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCalibracionesPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCalibracionesPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCalibracionesPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarDatosCalibracion(ByVal Manguera As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarDatosCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int32, Manguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function ValidarCredencialesCalibracion(ByVal empleado As String, ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesCalibracion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    'Verificada Uso de Pool de Conexiones
    Public Function ExisteTurnoAbiertoEnManguera(ByVal idManguera As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteTurnoAbiertoEnManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
#End Region

#Region "Resoluciones Canastilla"
    Public Function ExisteResolucionValida() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteResolucionValida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarResolucionActivaCanastilla() As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarResolucionActivaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarMovimientoDetalle(ByVal IdMovimiento As Integer, ByVal IdProducto As Integer, ByVal Cantidad As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMovimientoDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMovimiento", DbType.Int32, IdMovimiento)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, Cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Consumos Internos"
    Public Function ValidarCredencialesConsumoInterno(ByVal empleado As String, ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesConsumoInterno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   ManagmentKardex     "

    Public Function RecuperarManguerasActualizarProducto(ByVal Manguera As Short) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasActualizarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, Manguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarManguerasActualizarProducto(ByVal Manguera As Short, ByVal IdEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasActualizarProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, Manguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManguerasCambioPrecioReciboCombustible(ByVal Documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasCambioPrecioReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarManguerasCambioPrecioReciboCombustible(ByVal Documento As String, ByVal IdEstacion As Short) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasCambioPrecioReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarTransferenciadeCombustibles(ByVal Tanque As String, ByVal Cantidad As Decimal, ByVal EstacionReceptora As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSalidaTrasladoKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodigoEstacion", DbType.String, EstacionReceptora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarTransferenciadeCombustibles(ByVal Tanque As String, ByVal Cantidad As Decimal, ByVal EstacionReceptora As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSalidaTrasladoKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodigoEstacion", DbType.String, EstacionReceptora)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarSaldoTanque(ByVal CodigoTanque As String, ByVal IdProducto As Int16) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaldosTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, CodigoTanque)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Decimal, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarSaldoTanque(ByVal CodigoTanque As String, ByVal IdProducto As Int16, ByVal IdEstacion As Integer) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaldosTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, CodigoTanque)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Decimal, IdProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarRemarcacionKardex(ByVal Tanque As String, ByVal ProductoB As Int16, ByVal cantidad As Decimal, ByVal TanqueA As String, ByVal ProductoA As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRemarcacionKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "TanqueAlta", DbType.String, TanqueA)
        DB.AddInParameter(DatabaseCommand, "ProductoBaja", DbType.Int16, ProductoB)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "ProductoAlta", DbType.Int16, ProductoA)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarRemarcacionKardex(ByVal Tanque As String, ByVal ProductoB As Int16, ByVal cantidad As Decimal, ByVal TanqueA As String, ByVal ProductoA As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRemarcacionKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "TanqueAlta", DbType.String, TanqueA)
        DB.AddInParameter(DatabaseCommand, "ProductoBaja", DbType.Int16, ProductoB)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "ProductoAlta", DbType.Int16, ProductoA)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarIdTanqueStock(ByVal Nombre As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdTanqueStock"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosTanque(ByVal tanque As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, tanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosCombustible() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosCombustiblePedido(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosCombustiblePedido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarProductosCombustiblePedido(ByVal documento As String, ByVal Tanque As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosCombustiblePedido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperaProductosPorCodigoTanque(ByVal Codigo As String, ByVal Documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperaProductosPorCodigoTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperaProductosPorCodigoTanque(ByVal Codigo As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperaProductosPorCodigoTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosTipoPedidoCombustible(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosTipoPedidoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarProductosCombustiblePedidoChile(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosCombustiblePedido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Sub InsertarReciboCombustibleTmp(ByVal documento As String, ByVal CodProducto As Integer, ByVal CodTanque As String, ByVal EsLeyFrontera As Nullable(Of Boolean), ByVal Cantidad As Decimal, ByVal Estado As Integer, ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarReciboCombustibleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, CodProducto)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, EsLeyFrontera)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, Estado)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarReciboCombustibleTmp(ByVal documento As String, ByVal EsLeyFrontera As Nullable(Of Boolean), ByVal Estado As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarReciboCombustibleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, EsLeyFrontera)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Int32, Estado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ExisteDocumentoReciboTmp(ByVal documento As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteDocumentoReciboTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ExisteHojaRutaDocumentoReciboTmp(ByVal documento As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteHojaRutaDocumentoReciboTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarReciboCombustibleTmp(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCombustibleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarReciboCombustibleChileTmp(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCombustibleChileTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManejaLeyFrontera() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManejaLeyFrontera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarAjustePorTipoMotivo(ByVal Tanque As String, ByVal Producto As Int16, ByVal Cantidad As Decimal, ByVal TipoMotivo As Short)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAjustePorTipoMotivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int16, Producto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "TipoMotivo", DbType.String, TipoMotivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarAjustePorOperacion(ByVal Tanque As String, ByVal Cantidad As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAjustePorOperacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTanqueo(ByVal Volumen As Decimal, ByVal Stock As Decimal, ByVal Placa As String, ByVal NumRemision As String, ByVal IdTanque As Integer, ByVal Costo As Decimal, ByVal IdProducto As Integer, ByVal EsLeyFrontera As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanqueoLeyFrontera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Volumen", DbType.Decimal, Volumen)
        DB.AddInParameter(DatabaseCommand, "Stock", DbType.Decimal, Stock)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Now.Date)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "NumRemision", DbType.String, NumRemision)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, IdTanque)
        DB.AddInParameter(DatabaseCommand, "Costo", DbType.Decimal, Costo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, EsLeyFrontera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTanqueo(ByVal Volumen As Decimal, ByVal Stock As Decimal, ByVal Placa As String, ByVal NumRemision As String, ByVal IdTanque As Integer, ByVal Costo As Decimal, ByVal IdProducto As Integer, ByVal EsLeyFrontera As Boolean, ByVal Ruc As String, ByVal GuiaDespacho As String, ByVal TipoCombustible As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanqueoLeyFrontera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Volumen", DbType.Decimal, Volumen)
        DB.AddInParameter(DatabaseCommand, "Stock", DbType.Decimal, Stock)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Now.Date)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "NumRemision", DbType.String, NumRemision)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, IdTanque)
        DB.AddInParameter(DatabaseCommand, "Costo", DbType.Decimal, Costo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, EsLeyFrontera)
        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "GuiaDespacho", DbType.String, GuiaDespacho)
        DB.AddInParameter(DatabaseCommand, "IdTipoCombustible", DbType.Int32, TipoCombustible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub InsertarTanqueo(ByVal Volumen As Decimal, ByVal Stock As Decimal, ByVal Placa As String, ByVal NumRemision As String, ByVal IdTanque As Integer, ByVal Costo As Decimal, ByVal IdProducto As Integer, ByVal EsLeyFrontera As Boolean, ByVal Ruc As String, ByVal GuiaDespacho As String, ByVal TipoCombustible As Integer, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTanqueoLeyFrontera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Volumen", DbType.Decimal, Volumen)
        DB.AddInParameter(DatabaseCommand, "Stock", DbType.Decimal, Stock)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Now.Date)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "NumRemision", DbType.String, NumRemision)
        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, IdTanque)
        DB.AddInParameter(DatabaseCommand, "Costo", DbType.Decimal, Costo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, EsLeyFrontera)
        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "GuiaDespacho", DbType.String, GuiaDespacho)
        DB.AddInParameter(DatabaseCommand, "IdTipoCombustible", DbType.Int32, TipoCombustible)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarLeyFronteraPedidoCombustible(ByVal Documento As String, ByVal Codigo As Integer) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLeyFronteraPedidoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarAforoTanque(ByVal IdTanque As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAforoTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, IdTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarAforoTanque(ByVal IdTanque As Int32, ByVal IdAforo As Nullable(Of Int32), ByVal Altura As Decimal, ByVal Cantidad As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarAforoTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int32, IdTanque)
        DB.AddInParameter(DatabaseCommand, "IdAforo", DbType.Int32, IdAforo)
        DB.AddInParameter(DatabaseCommand, "Altura", DbType.Decimal, Altura)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarAforoTanque(ByVal IdAforo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarAforoTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAforo", DbType.Int32, IdAforo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub EliminarVentasPorFechaPlaca(FechaInicial As DateTime, FechaFinal As DateTime, Placa As String)

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarVentasPorFechaPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarUnidadMedida(ByVal nombre As String, ByVal IdUnidad As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarUnidadMedida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "IdUnidad", DbType.Int32, IdUnidad)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarUnidadMedida(ByVal nombre As String, Optional ByVal CodigoMenoCash As String = Nothing)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarUnidadMedida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)
        DB.AddInParameter(DatabaseCommand, "CodigoMenoCash", DbType.String, CodigoMenoCash)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarUnidadMedida(ByVal IdUnidad As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarUnidadMedida"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdUnidad", DbType.Int32, IdUnidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarCantidadporAforo(ByVal Tanque As String, ByVal alturaMax As Decimal, ByVal alturaAgua As Decimal) As Decimal
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCantidadporAforo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "AlturaMaxima", DbType.Decimal, alturaMax)
        DB.AddInParameter(DatabaseCommand, "AlturaAgua", DbType.Decimal, alturaAgua)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ValidarAforoTanque(ByVal Tanque As String, ByVal Altura As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarAforoTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, Tanque)
        DB.AddInParameter(DatabaseCommand, "Altura", DbType.Decimal, Altura)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarCombinacionManguera(ByVal IdManguera As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCombinacionManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int16, IdManguera)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarCombinacionManguera(ByVal IdManguera As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarCombinacionManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Manguera", DbType.Int16, IdManguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region

#Region "Movimientos de Combustible"
    Public Function ValidarCredencialesTraslado(ByVal empleado As String, ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesTraslado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, empleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarCambioTanqueBypass(ByVal tanque As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCambioTanqueBypass"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoTanque", DbType.String, tanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RealizarCambioTanqueBypass(ByVal codTanque As String, ByVal cedula As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RealizarCambioTanqueBypass"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoTanque", DbType.String, codTanque)
        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarPedidoCombustibleTmp(ByVal documento As String, ByVal codProducto As Integer, ByVal cantidad As Decimal, ByVal esLeyFrontera As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPedidoCombustibleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, codProducto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, esLeyFrontera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarPedidoCombustibleTmp(ByVal Documento As String, ByVal codProducto As Integer, ByVal cantidad As Decimal, ByVal esLeyFrontera As Boolean, ByVal Hoja As String, ByVal Nit As String, ByVal NroAutorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPedidoCombustibleTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, codProducto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, esLeyFrontera)

        DB.AddInParameter(DatabaseCommand, "Hoja", DbType.String, Hoja)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.String, NroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarPedidoCombustible(ByVal documento As String, ByVal Rut As String, ByVal Guia As String, ByVal IdTipoCombustible As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPedidoCombustibleChile"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Rut", DbType.String, Rut)
        DB.AddInParameter(DatabaseCommand, "Guia", DbType.String, Guia)
        DB.AddInParameter(DatabaseCommand, "IdTipoCombustible", DbType.Int32, IdTipoCombustible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarPedidoCombustible(ByVal documento As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPedidoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Sub InsertarPedidoCombustible(ByVal documento As String, ByVal Nit As String, ByVal Hoja As String, ByVal NroAutorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPedidoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "Hoja", DbType.String, Hoja)
        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.String, NroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Function RecuperarMovimientosCombustiblePorTurno(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMovimientosCombustiblePorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarMovimientosCombustiblePorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMovimientosCombustiblePorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManguerasDescolgadasPorTanque(ByVal tanques As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasDescolgadasPorTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanques", DbType.String, tanques)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ModificarEstadoManguerasPorTanque(ByVal codTanque As String, ByVal esActivado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ModificarEstadoManguerasPorTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codTanque)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ModificarEstadoManguerasPorTanque(ByVal codTanque As String, ByVal esActivado As Boolean, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ModificarEstadoManguerasPorTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codTanque)
        DB.AddInParameter(DatabaseCommand, "EsActivado", DbType.Boolean, esActivado)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ValidarProductoEnTanque(ByVal CodTanque As String, ByVal Cantidad As Decimal, ByVal CodProducto As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarProductoEnTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.String, CodProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function ValidarProductoEnTanqueRemarcacion(ByVal CodTanque As String, ByVal Cantidad As Decimal, ByVal CodProducto As Integer, ByVal EsPorBaja As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarProductoEnTanqueRemarcacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.String, CodProducto)
        DB.AddInParameter(DatabaseCommand, "EsPorBaja", DbType.Boolean, EsPorBaja)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarProductoEnTanqueRemarcacionPeru(ByVal CodTanque As String, ByVal Cantidad As Decimal, ByVal CodProducto As Integer, ByVal EsPorBaja As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarProductoEnTanqueRemarcacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.String, CodProducto)
        DB.AddInParameter(DatabaseCommand, "TipoOperacion", DbType.Boolean, EsPorBaja)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function ValidarProductoEnTanqueAjustes(ByVal CodTanque As String, ByVal Cantidad As Decimal, ByVal CodProducto As Integer, ByVal TipoOperacion As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarProductoEnTanqueAjustes"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, CodTanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.String, CodProducto)
        DB.AddInParameter(DatabaseCommand, "TipoOperacion", DbType.Int32, TipoOperacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTanquesSinDispositivoMedicion(ByVal Tanques As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTanquesSinDispositivoMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tanques", DbType.String, Tanques)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarRemarcacionCanastilla(ByVal Codigo As Integer, ByVal Cantidad As Integer) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRemarcacionCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32, Cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RemarcacionCanastilla(ByVal CodBaja As Integer, ByVal Cantidad As Double, ByVal CodAlta As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RemarcacionCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoBaja", DbType.Int32, CodBaja)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodigoAlta", DbType.Int32, CodAlta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RemarcacionCanastilla(ByVal CodBaja As Integer, ByVal Cantidad As Double, ByVal CodAlta As Integer, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RemarcacionCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodigoBaja", DbType.Int32, CodBaja)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Double, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodigoAlta", DbType.Int32, CodAlta)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Productos de combustible"
    Public Function ESInformacionCombustible(ByVal tipoInformacion As Int16, ByVal valor As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESInformacionCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "TipoInformacion", DbType.Int16, tipoInformacion)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function EsVentaPrepago(ByVal Recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsVentaPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function


    Public Function ESCaraCombustible(ByVal cara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCaraCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function
    Public Function ESCaraCombustible(ByVal cara As Int16, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ESCaraCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarCodigoProductoCombustible(ByVal idProducto As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoProductoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCodigoProductoCombustible(ByVal idProducto As Int32, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoProductoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCodigoProductoCanastilla(ByVal idProducto As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoProductoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarCodigoProductoCanastilla(ByVal idProducto As Int32, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoProductoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function SolicitaLecturaChip(ByVal idProducto As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SolicitaLecturaChip"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function


    Public Function SolicitaLecturaChip(ByVal idProducto As Int32, ByVal IdEstacion As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SolicitaLecturaChip"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function




#End Region

#Region "   Tanqueos Simultaneos    "

    Public Function ValidarTanqueoSimultaneo(ByVal Rom As String) As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTanqueoSimultaneo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return Int16.Parse(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ValidarTanqueoSimultaneo(ByVal Rom As String, ByVal idEstacion As Int16) As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTanqueoSimultaneo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return Int16.Parse(DB.ExecuteScalar(DatabaseCommand).ToString())
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarTanqueoSimultaneoPorPlaca(ByVal placa As String) As Int16
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTanqueoSimultaneoPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CShort(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Resolucion de Factura   "

    Public Function InsertaResolucion(ByVal IdConsecutivo As Int64, ByVal NoResolucionFactura As String, ByVal Prefijo As String, ByVal NumeroInicial As Int64, ByVal NumeroFinal As Int64, _
                                     ByVal FechaInicialResFactura As DateTime, ByVal FechaFinalResFactura As DateTime, ByVal NoResolGContribuyente As String, _
                                     ByVal FechaResGContribuyente As DateTime, ByVal NoResAutoRetenedor As String, ByVal FechaNoResAutoRetenedor As DateTime) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertaResolucion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdConsecutivo", DbType.Int64, IdConsecutivo)
        DB.AddInParameter(DatabaseCommand, "NoResolucionFactura", DbType.String, NoResolucionFactura)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "NumeroInicial", DbType.Int32, NumeroInicial)
        DB.AddInParameter(DatabaseCommand, "NumeroFinal", DbType.Int32, NumeroFinal)
        DB.AddInParameter(DatabaseCommand, "FechaInicialResFactura", DbType.DateTime, FechaInicialResFactura)
        DB.AddInParameter(DatabaseCommand, "FechaFinalResFactura", DbType.DateTime, FechaFinalResFactura)
        DB.AddInParameter(DatabaseCommand, "NoResolGContribuyente", DbType.String, NoResolGContribuyente)
        DB.AddInParameter(DatabaseCommand, "FechaResGContribuyente", DbType.DateTime, FechaResGContribuyente)
        DB.AddInParameter(DatabaseCommand, "NoResAutoRetenedor", DbType.String, NoResAutoRetenedor)
        DB.AddInParameter(DatabaseCommand, "FechaNoResAutoRetenedor", DbType.Date, FechaNoResAutoRetenedor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarResolucionGrid() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarResolucionGrid"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarResolucionGrid(ByVal IdEstacion As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarResolucionGrid"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ActualizarConsecutivoActualResolucionActiva(ByVal NumeroActual As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarConsecutivoActualResolucionActiva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, NumeroActual)

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteScalar(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Cambios de Precios"
    Public Sub ReportarCambioPrecioFallido(ByVal IdManguera As Int16, ByVal precio As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ReportarCambioPrecioFallido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ReportarCambioPrecioFallido(ByVal IdManguera As Int16, ByVal precio As Decimal, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ReportarCambioPrecioFallido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)
        DB.AddInParameter(DatabaseCommand, "Precio", DbType.Decimal, precio)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Financiera Terpel"

    Public Function RecuperarParametrosCDC(ByVal Nombre As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarParametrosCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarParametrosCDC(ByVal Nombre As String, ByVal idEstacion As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarParametrosCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "IDEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteRecibo(ByVal Recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExisteReciboCanastilla(ByVal Recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteReciboCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub IngresarFacturaVentaCombustible(ByVal Recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaReciboVentaCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub IngresarFacturaVentaCombustible(ByVal Recibo As Int64, ByVal EsLeyFrontera As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaReciboVentaCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, EsLeyFrontera)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub IngresarFacturaVentaCombustible(ByVal Recibo As Int64, ByVal EsLeyFrontera As Boolean, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaReciboVentaCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "EsLeyFrontera", DbType.Boolean, EsLeyFrontera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function InsertarFacturaReciboVentaCanastilla(ByVal Recibo As Int64) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaReciboVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarFacturaReciboVentaCanastilla(ByVal Recibo As Int64, ByVal idEstacion As Int16) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaReciboVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormaPagoEfectivo() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoEfectivo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarCheque(ByVal NumeroAutorizacion As Int64, ByVal ValorCheque As Decimal, ByVal Recibo As Long) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.Int64, NumeroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "ValorCheque", DbType.Decimal, ValorCheque)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarCambioCheque(ByVal NumeroAutorizacion As Int64, ByVal Valor As Decimal, ByVal IdTurno As Int32, ByVal Recibo As Int64, ByVal IdCara As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCambioCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.Int64, NumeroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub






    Public Sub InsertarCambioChequeMr(ByVal NumeroAutorizacion As Int64, ByVal Valor As Decimal, ByVal IdTurno As Int32, ByVal Recibo As Int64, ByVal IdCara As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCambioChequeMR"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.Int64, NumeroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarCambioCheque(ByVal NumeroAutorizacion As Int64, ByVal Valor As Decimal, ByVal IdTurno As Int32, ByVal Recibo As Int64, ByVal IdCara As Int16, ByVal idEstacion As Int16)

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarCambioCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.Int64, NumeroAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, IdCara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarNumeroCheque(ByVal NumeroAutorizacion As Int64) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumeroCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.Int64, NumeroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSurtidorporCara(ByVal IdCara As Int16) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidorporCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   Consignacion de Sobres  "
    Public Function InsertarSobre(ByVal Turno As Int32, ByVal IdTipoTurno As Int16, ByVal TipoConsignacion As Int16, ByVal Cantidad As Decimal) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, TipoConsignacion)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarSobre(ByVal Turno As Int32, ByVal IdTipoTurno As Int16, ByVal TipoConsignacion As Int16, ByVal Cantidad As Decimal, ByVal TipoMoneda As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, TipoConsignacion)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "IdTipoMoneda", DbType.Int32, TipoMoneda)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsignaciondeSobresTurno(ByVal Turno As Int64, ByVal IdTipoTurno As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsignaciondeSobres"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, Turno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarConsignaciondeSobresTurno(ByVal Turno As Int64, ByVal IdTipoTurno As Int16, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsignaciondeSobres"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, Turno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsignaciondeSobresTurnoTrabajo(ByVal Turno As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsignaciondeSobresTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarConsignaciondeSobresTurnoTrabajo(ByVal Turno As Int64, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsignaciondeSobresTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoPorCredenciales(ByVal Empleado As String, ByVal Clave As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorCredenciales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoPorCredencialesTable(ByVal Empleado As String, ByVal Clave As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorCredenciales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarTurnoPorCredencialesTable(ByVal Empleado As String, ByVal Clave As String, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorCredenciales"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoCredencialesPorTipo(ByVal Empleado As String, ByVal Clave As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoCredencialesPorTipo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoConsignaciones(ByVal Empleado As String, ByVal Clave As String, ByVal esTurnoCombustible As Boolean) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoConsignaciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddInParameter(DatabaseCommand, "EsTurnoCombustible", DbType.Boolean, esTurnoCombustible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsTurnoTrabajo(ByVal Empleado As String, ByVal Clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsTurnoAutoServicio(ByVal cara As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsTurnoAutoServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function EsTurnoAutoServicio(ByVal cara As Int16, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsTurnoAutoServicio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsFinalizaConsignacionSobreTurno(ByVal idTurno As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsFinalizaConsignacionSobreTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.String, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

   

    Public Sub InsertarSobre(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16, ByVal IdTipoconsignacion As Int16, ByVal Cantidad As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobreLote"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try

                    DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
                    DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
                    DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, IdTipoconsignacion)
                    DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)

                    'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                    DB.ExecuteNonQuery(DatabaseCommand)





                Catch ex As Exception
                    Throw
                End Try

            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarSobreLote(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16, ByVal Sobres As Dictionary(Of Short, Decimal))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobreLote"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    For Each IdItem As Int16 In Sobres.Keys
                        'DB.SetParameterValue(DatabaseCommand, "IdTipoConsignacion", IdItem)
                        'DB.SetParameterValue(DatabaseCommand, "Valor", Sobres(IdItem))

                        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, IdItem)
                        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Sobres(IdItem))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                        DatabaseCommand.Parameters.Clear()

                    Next
                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw 
                End Try

            Catch ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Sub InsertarSobreLote(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16, ByVal Sobres As List(Of ConsignacionSobre))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobreLote"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    For Each IdItem As ConsignacionSobre In Sobres
                        'DB.SetParameterValue(DatabaseCommand, "IdTipoConsignacion", IdItem)
                        'DB.SetParameterValue(DatabaseCommand, "Valor", Sobres(IdItem))

                        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, IdItem.TipoConsignacion)
                        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, IdItem.Cantidad)
                        DB.AddInParameter(DatabaseCommand, "TipoMoneda", DbType.Int32, IdItem.TipoMoneda)

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                        DatabaseCommand.Parameters.Clear()

                    Next
                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarSobreLote(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16, ByVal Sobres As Dictionary(Of Short, Decimal), ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobreLote"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    For Each IdItem As Int16 In Sobres.Keys
                        'DB.SetParameterValue(DatabaseCommand, "IdTipoConsignacion", IdItem)
                        'DB.SetParameterValue(DatabaseCommand, "Valor", Sobres(IdItem))

                        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, IdItem)
                        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Sobres(IdItem))
                        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                        DatabaseCommand.Parameters.Clear()

                    Next
                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw
                End Try

            Catch ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarSobreLoteTurnoTrabajo(ByVal IdTurno As Int32, ByVal Sobres As Dictionary(Of Short, Decimal))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobreLoteTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    For Each IdItem As Int16 In Sobres.Keys
                        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, IdItem)
                        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Sobres(IdItem))

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                        DatabaseCommand.Parameters.Clear()
                    Next
                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw 
                End Try

            Catch ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub InsertarSobreLoteTurnoTrabajo(ByVal IdTurno As Int32, ByVal Sobres As Dictionary(Of Short, Decimal), ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobreLoteTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Transaccion As System.Data.Common.DbTransaction = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            Try
                connection.Open()

                Try
                    Transaccion = connection.BeginTransaction

                    For Each IdItem As Int16 In Sobres.Keys
                        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
                        DB.AddInParameter(DatabaseCommand, "IdTipoConsignacion", DbType.Int16, IdItem)
                        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Sobres(IdItem))
                        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

                        'Ejecuta el procedimiento Almacenado InsertarVentaFormaPago
                        DB.ExecuteNonQuery(DatabaseCommand)
                        DatabaseCommand.Parameters.Clear()
                    Next
                    Transaccion.Commit()

                Catch ex As Exception
                    If Not Transaccion Is Nothing Then
                        Transaccion.Rollback()
                    End If

                    Throw 
                End Try

            Catch ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarEmpleadoPorTurno(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEmpleadoPorTurno(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarTurnoConsignacionSobre(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTurnoConsignacionSobre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarTurnoConsignacionSobre(ByVal IdTurno As Int64, ByVal IdTipoTurno As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTurnoConsignacionSobre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarTurnoTrabajoConsignacionSobre(ByVal IdTurno As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTurnoTrabajoConsignacionSobre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarTurnoTrabajoConsignacionSobre(ByVal IdTurno As Int32, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTurnoTrabajoConsignacionSobre"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Cambio de Cheque  "
    Public Function RecuperarNumeroChequePorTurno(ByVal Turno As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumeroChequePorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarNumeroChequePorTurno(ByVal Turno As Int32, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumeroChequePorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCambiosChequePorTurno(ByVal Turno As Int32, ByVal NumeroCheque As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCambiosChequePorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "NumeroCheque", DbType.String, NumeroCheque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Manejo de Documentos(Factura Combustible)   "

    Public Function RecuperarReciboPorNumeroFactura(ByVal Prefijo As String, ByVal consecutivo As Int64) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboPorNumeroFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdDocumentoPorRecibo(ByVal Recibo As Int32) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarIdDocumentoPorNumeroFactura(ByVal Prefijo As String, ByVal consecutivo As Int64) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorNumeroFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdDocumentoPorNumeroFactura(ByVal Prefijo As String, ByVal consecutivo As Int64, ByVal IdEstacion As Int16) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorNumeroFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, consecutivo)

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdDocumentoPorNumeroFacturaCanastilla(ByVal Prefijo As String, ByVal consecutivo As Int64, ByVal EsConsolidada As Boolean) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorNumeroFacturaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, consecutivo)
        DB.AddInParameter(DatabaseCommand, "EsConsolidada", DbType.Boolean, EsConsolidada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdDocumentoPorNumeroFacturaCanastilla(ByVal Prefijo As String, ByVal consecutivo As Int64, ByVal EsConsolidada As Boolean, ByVal idEstacion As Int16) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorNumeroFacturaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, consecutivo)
        DB.AddInParameter(DatabaseCommand, "EsConsolidada", DbType.Boolean, EsConsolidada)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEncabezadoFactura(ByVal IdDocumento As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, IdDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEncabezadoFactura(ByVal IdDocumento As Int64, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, IdDocumento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEncabezadoFacturaCanastilla(ByVal IdDocumento As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoFacturaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, IdDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEncabezadoFacturaCanastilla(ByVal IdDocumento As Int64, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoFacturaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, IdDocumento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDetalleFactura(ByVal IdDocumento As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, IdDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDetalleFactura(ByVal IdDocumento As Int64, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int64, IdDocumento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdDocumentoPorRecibo(ByVal Recibo As Int64) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdDocumentoPorReciboDataTable(ByVal Recibo As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIdDocumentoPorReciboDataTable(ByVal Recibo As Int64, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdDocumentoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsVentaLeydeFrontera(ByVal Recibo As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsVentaLeydeFrontera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   TaskManagement Terpel   "

    Public Function InsertarFacturaConsolidadaVentaCombustible(ByVal Hora As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaConsolidadaVentaCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Hora", DbType.String, Hora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarFacturaConsolidadaVentaCombustibleTable(ByVal Hora As String, Optional TimeOut As Integer = 800) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaConsolidadaVentaCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DatabaseCommand.CommandTimeout = TimeOut

        DB.AddInParameter(DatabaseCommand, "Hora", DbType.String, Hora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarFacturaConsolidadaVentaCanastilla(ByVal Hora As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaConsolidadaVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Hora", DbType.String, Hora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region



#Region "Ventas fuera del sistema"
    Public Function RecuperarVentasRecuperadas(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasRecuperadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarVentasRecuperadas(ByVal idTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasRecuperadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFallosDeSistema(ByVal idTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFallosDeSistema"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub HabilitarMangueraConVentasFueraDelSistema(ByVal idManguera As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "HabilitarMangueraConVentasFueraDelSistema"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub HabilitarMangueraConVentasFueraDelSistemaFullStation(ByVal idManguera As Int16, ByVal IdBloqueo As Integer, ByVal EsFallaTecnica As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "HabilitarMangueraConVentasFueraDelSistemaFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdBloqueo", DbType.Int16, IdBloqueo)
        DB.AddInParameter(DatabaseCommand, "EsFallaTecnica", DbType.Boolean, EsFallaTecnica)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub HabilitarMangueraConVentasFueraDelSistema(ByVal idManguera As Int16, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "HabilitarMangueraConVentasFueraDelSistema"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarDifLecturaActualVsVentasPorBloqueo(ByVal idManguera As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDifLecturaActualVsVentasPorBloqueo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarVehiculoCredito(ByVal Placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVehiculoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function VerificarBonoSodexo(ByVal NroConfirmacion As String, ByVal IdFormaPago As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "VerificarBonoSodexo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NroConfirmacion", DbType.String, NroConfirmacion)
        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int32, IdFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function ValidarVehiculoCredito(ByVal Placa As String, ByVal Ruc As String, ByVal NumeroCredito As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVehiculoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "NumeroCredito", DbType.String, NumeroCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoPorCara(ByVal Cara As Int32, ByVal Placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int32, Cara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return (DB.ExecuteReader(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function TieneCreditoSuspendidoVehiculo(ByVal Placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "TieneCreditoSuspendidoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function TieneCreditoSuspendidoVehiculo(ByVal Placa As String, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "TieneCreditoSuspendidoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Sub ValidacionEstadoCreditoVehiculo(ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidacionEstadoCreditoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarManguerasBloqueadasFueraDelSistema() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasConVentasFueraDelSistema"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarManguerasBloqueadasFueraDelSistema(ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasConVentasFueraDelSistema"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Registro Sobrante y Faltantes de Turno  "

    Public Function RecuperarTurnoFechaSurtidorHorario(ByVal Fecha As String, ByVal TurnoHorario As Int16, ByVal Surtidor As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoFechaSurtidorHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
        DB.AddInParameter(DatabaseCommand, "IdTurnoHorario", DbType.Int16, TurnoHorario)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, Surtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarSobranteTurno(ByVal IdTurno As Int32, ByVal IdEmpleado As Int32, ByVal IdSurtidor As Int32, ByVal Fecha As String, ByVal Valor As Decimal, ByVal IdTipoTurno As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSobranteTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int32, IdSurtidor)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int32, IdTipoTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarIsleros() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIsleros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIslerosConSaldo() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslerosConSaldo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarSobranteEmpleado(ByVal IdEmpleado As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSobranteEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSobranteFaltanteTurno(ByVal IdTurno As Int32, ByVal IdTipoTurno As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSobranteFaltanteTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarSobranteFaltanteTurno(ByVal IdTurno As Int32, ByVal IdTipoTurno As Int16, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSobranteFaltanteTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSobranteFaltanteTurnoTrabajo(ByVal IdTurno As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSobranteFaltanteTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarSobranteFaltanteTurnoTrabajo(ByVal IdTurno As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSobranteFaltanteTurnoTrabajo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleadoporNumeroDocumento(ByVal Numero As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoporNumeroDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleadoPorCedula(ByVal cedula As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorCedula"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEmpleadoPorCedula(ByVal cedula As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoPorCedula"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, cedula)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarFaltanteEmpleadoValor(ByVal IdEmpleado As Int32, ByVal Fecha As String, ByVal Valor As Decimal) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFaltanteEmpleadoValor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
        DB.AddInParameter(DatabaseCommand, "valor", DbType.Decimal, Valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ExistenFaltantesParaCruzar(ByVal IdEmpleado As Int32, ByVal Fecha As String, ByVal Valor As Decimal) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExistenFaltantesParaCruzar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
        DB.AddInParameter(DatabaseCommand, "valor", DbType.Decimal, Valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarConciliacion(ByVal IdSobrante As Int32, ByVal IdFaltante As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarConciliacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSobrante", DbType.Int32, IdSobrante)
        DB.AddInParameter(DatabaseCommand, "IdFaltante", DbType.Int32, IdFaltante)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarConciliacion(ByVal IdSobrante As Int32, ByVal NroCuenta As String, ByVal Banco As String, ByVal FechaConsignacion As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarConciliacionCuenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdSobrante", DbType.Int32, IdSobrante)
        DB.AddInParameter(DatabaseCommand, "NroCuenta", DbType.String, NroCuenta)
        DB.AddInParameter(DatabaseCommand, "Banco", DbType.String, Banco)
        DB.AddInParameter(DatabaseCommand, "FechaConsignacion", DbType.DateTime, FechaConsignacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarVehiculoConductor(ByVal Placa As String, ByVal Dni As String, Pais As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVehiculoConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "dni", DbType.String, Dni)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region " CHEQUES TERPEL "

    Public Function RecuperarCodigoBancoEmisor() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoBancoEmisor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarNombreEntidadAutorizadora() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNombreEntidadAutorizadora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarEmpleadoAutorizacionCheque(ByVal numAutorizacion As Long) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEmpleadoAutorizacionCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumAutorizacion", DbType.Int64, numAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarClientesIdentificados() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClientesIdentificados"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosClienteIdentificado(ByVal TipoBusqueda As Short, ByVal DatoBusqueda As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosClienteIdentificado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, TipoBusqueda)
        DB.AddInParameter(DatabaseCommand, "Dato", DbType.String, DatoBusqueda)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarVehiculosPorPrecioCliente(ByVal IdPrecio As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculosPorPrecioCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPrecio", DbType.Int32, IdPrecio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculosPorClienteIdentificado(ByVal IdCliente As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculosPorClienteIdentificado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarVehiculosPorClienteIdentificadoSinPrecio(ByVal IdCliente As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculosPorClienteIdentificadoSinPrecio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosPorPrecioClienteCredito(ByVal IdPrecio As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorPrecioClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPrecio", DbType.Int32, IdPrecio)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosPorPrecioClienteCreditoSinPrecio() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorPrecioClienteCreditoSinPrecio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarClienteCheque(ByVal IdCliente As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClienteCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Function InsertarAutorizacionCheque(ByVal IdCliente As Integer, ByVal CodigoBanco As String, ByVal NumeroCheque As String, ByVal Entidad As String, _
        ByVal AutorizacionEntidad As Long, ByVal ValorCheque As Decimal, ByVal ValorSuministro As Decimal, ByVal Placa As String, ByVal Valor As String) As Long
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAutorizacionCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)
        DB.AddInParameter(DatabaseCommand, "CodigoBanco", DbType.String, CodigoBanco)
        DB.AddInParameter(DatabaseCommand, "NumeroCheque", DbType.String, NumeroCheque)
        DB.AddInParameter(DatabaseCommand, "Entidad", DbType.String, Entidad)
        DB.AddInParameter(DatabaseCommand, "AutorizacionEntidad", DbType.Int64, AutorizacionEntidad)
        DB.AddInParameter(DatabaseCommand, "ValorCheque", DbType.Decimal, ValorCheque)
        DB.AddInParameter(DatabaseCommand, "ValorSuministro", DbType.Decimal, ValorSuministro)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, Valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function InsertarAutorizacionChequeChile(ByVal NumeroCheque As String, ByVal NumeroValidacion As Long, ByVal ValorCheque As Decimal, ByVal ValorSuministro As Decimal, ByVal Placa As String, ByVal Valor As String, ByVal Rut As String) As Long
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAutorizacionChequeChile"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroCheque", DbType.Int32, NumeroCheque)
        DB.AddInParameter(DatabaseCommand, "NumeroValidacion", DbType.Int64, NumeroValidacion)
        DB.AddInParameter(DatabaseCommand, "ValorCheque", DbType.Decimal, ValorCheque)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, Valor)
        DB.AddInParameter(DatabaseCommand, "ValorSuministro", DbType.Decimal, ValorSuministro)
        DB.AddInParameter(DatabaseCommand, "Rut", DbType.String, Rut)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function ValidarNumeroAutorizacionPlaca(ByVal numAutorizacion As Long, ByVal placa As String) As IDataReader

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarNumeroAutorizacionPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumAutorizacion", DbType.Int64, numAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarVehiculoCliente(ByVal NumeroDocumento As String, ByVal placa As String, ByVal NroCupon As String) As IDataReader

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVehiculoCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroDocumento", DbType.String, NumeroDocumento)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "NroCupon", DbType.String, NroCupon)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarVehiculoVale(ByVal NroVale As String, ByVal placa As String) As IDataReader

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVehiculoVale"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NroVale", DbType.String, NroVale)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ExisteDocumentoStorage(ByVal Documento As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteDocumentoStorage"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "GuiaDespacho", DbType.String, Documento)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ValidarTipodeVentaChile(ByVal Recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTipodeVentaChile"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarValorChequePorCodigo(ByVal numAutorizacion As String) As Decimal

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorChequePorCodigo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroAutorizacion", DbType.Int64, CLng(numAutorizacion))


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function







    Public Function RecuperarValorChequePorPlaca(ByVal placa As String, ByVal numAutorizacion As String) As Decimal

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumAutorizacion", DbType.Int64, CLng(numAutorizacion))
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    'Creado por: Christian GAlvis
    Public Function RecuperarValorChequePorPlaca(ByVal placa As String, ByVal numAutorizacion As String, ByVal idEstacion As Int16) As Decimal

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumAutorizacion", DbType.Int64, CLng(numAutorizacion))
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarChequePlaca(ByVal placa As String, ByVal recibo As Long) As Boolean

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarChequePlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTiposFormaPago(ByVal IdFormaPago As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTiposFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormaPagoTerpel(ByVal Recibo As Long) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarFormaPagoTerpelEstacionAfiliada(ByVal Recibo As Long) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoTerpelEstacionAfiliada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarFormaPagoCanastilla() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormaPagoCanastillaPrepago() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarFormaPagoAbonoExtraGazel() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoAbonoGazel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function





    Public Sub ActualizarChequeVenta(ByVal numAutorizacion As Long, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarChequeVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumAutorizacion", DbType.Int64, numAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    'Public Sub ActualizarChequeVentaChile(ByVal Recibo As Long, ByVal placa As String, ByVal ValorCheque As Decimal, ByVal Rut As String, ByVal NumeroValidacion As Integer, ByVal NumeroCheque As String)
    '    'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
    '    Dim DB As Database = DatabaseFactory.CreateDatabase()
    '    'Crea un sqlComand a partir del nombre del procedimiento almacenado
    '    Dim SqlCommand As String = "ActualizarChequeVenta"
    '    Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


    '    DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
    '    DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
    '    DB.AddInParameter(DatabaseCommand, "Rut", DbType.String, Rut)
    '    DB.AddInParameter(DatabaseCommand, "NumeroValidacion", DbType.Int64, NumeroValidacion)
    '    DB.AddInParameter(DatabaseCommand, "NumeroCheque", DbType.String, NumeroCheque)
    '    DB.AddInParameter(DatabaseCommand, "ValorCheque", DbType.Decimal, ValorCheque)
    '    Using connection As DbConnection = DB.CreateConnection()
    '        connection.Open()

    '        Try
    '            'Ejecuta el Procedimiento Almacenado
    '            DB.ExecuteNonQuery(DatabaseCommand)
    '        Catch
    '            Throw
    '        Finally
    '            connection.Close()
    '        End Try
    '    End Using
    'End Sub

    Public Function RecuperarInformacionMovimientoKardex(ByVal IdKardex As Long) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionMovimientoKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdKardex", DbType.Int64, IdKardex)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionVentaCanastillaFomplus(ByVal Recibo As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionVentaCanastillaFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarInformacionNotaCreditoCanastillaFomplus(ByVal IdNotaCredito As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionNotaCreditoCanastillaFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdNotaCredito", DbType.Int32, IdNotaCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionFacturaConsolidadaFomplus(ByVal Recibo As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDetalleFacturaConsolidada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionGeneralFacturaConsolidadaFomplus(ByVal IdDocumento As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionGeneralFacturaConsolidadaFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int32, IdDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionVentaCombustibleFomplus(ByVal Recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionVentaCombustibleFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionInvCombustibleFomplus(ByVal IdKardex As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionInvCombustibleFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdKardex", DbType.Int64, IdKardex)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionInvCanastillaFomplus(ByVal IdMovimiento As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionInvCanastillaFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMovimiento", DbType.Int32, IdMovimiento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarPagoFomplus(ByVal Cedula As Integer, ByVal PrefijoFactura As String, ByVal NumeroFactura As String, ByVal Valor As Double, ByVal TipoMovimiento As Int16, ByVal FechaFactura As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPagoFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "PrefijoFacturaFomplus", DbType.String, PrefijoFactura)
        DB.AddInParameter(DatabaseCommand, "NumeroFacturaFomplus", DbType.String, NumeroFactura)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "TipoMovimiento", DbType.Int16, TipoMovimiento)
        DB.AddInParameter(DatabaseCommand, "FechaFactura", DbType.DateTime, FechaFactura)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Function RecuperarInformacionCierreDia(ByVal Dia As Date) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionCierreDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Dia", DbType.Date, Dia)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarInformacionCierreDia(ByVal Dia As Date, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionCierreDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Dia", DbType.Date, Dia)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionNotificacionKardex(ByVal IdNotificacion As Long) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionNotificacionKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdNotificacion", DbType.Int64, IdNotificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionCambioPrecioFallido(ByVal IdHistoricoFallido As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionCambioPrecioFallido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdHistoricoFallido", DbType.Int32, IdHistoricoFallido)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionCheque(ByVal IdCheque As Long) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCheque", DbType.Int64, IdCheque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionTrasladoCombustible(ByVal IdTraslado As Long) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionTrasladoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTraslado", DbType.Int32, IdTraslado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionReciboCombustible(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarInformacionReciboCombustible(ByVal documento As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosReciboCombustible(ByVal documento As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarProductosReciboCombustible(ByVal documento As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionTrasladoCanastilla(ByVal IdTraslado As Long) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionTrasladoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTraslado", DbType.Int32, IdTraslado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionDetalleTrasladoCombustible(ByVal IdTraslado As Long) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionDetalleTrasladoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTraslado", DbType.Int32, IdTraslado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionDetalleReciboCombustible(ByVal documento As String, ByVal idProducto As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionDetalleReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarInformacionDetalleReciboCombustible(ByVal documento As String, ByVal idProducto As Int32, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionDetalleReciboCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, idProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarDistribucionCombustible(ByVal documento As String, ByVal codTanque As String, ByVal CodProducto As Int32, ByVal cantidadDocumento As Nullable(Of Decimal), ByVal cantidadPorOperacion As Nullable(Of Decimal), ByVal cantidadPorRecibo As Nullable(Of Decimal))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDistribucionCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codTanque)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, CodProducto)
        DB.AddInParameter(DatabaseCommand, "CantidadDocumento", DbType.Decimal, cantidadDocumento)
        DB.AddInParameter(DatabaseCommand, "CantidadPorOperacion", DbType.Decimal, cantidadPorOperacion)
        DB.AddInParameter(DatabaseCommand, "CantidadPorRecibo", DbType.Decimal, cantidadPorRecibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub ActualizarDistribucionCombustible(ByVal documento As String, ByVal codTanque As String, ByVal CodProducto As Int32, ByVal cantidadDocumento As Nullable(Of Decimal), ByVal cantidadPorOperacion As Nullable(Of Decimal), ByVal cantidadPorRecibo As Nullable(Of Decimal), ByVal cantidadPorVentas As Nullable(Of Decimal))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDistribucionCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codTanque)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, CodProducto)
        DB.AddInParameter(DatabaseCommand, "CantidadDocumento", DbType.Decimal, cantidadDocumento)
        DB.AddInParameter(DatabaseCommand, "CantidadPorOperacion", DbType.Decimal, cantidadPorOperacion)
        DB.AddInParameter(DatabaseCommand, "CantidadPorRecibo", DbType.Decimal, cantidadPorRecibo)
        DB.AddInParameter(DatabaseCommand, "CantidadPorVentas", DbType.Decimal, cantidadPorVentas)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Sub ActualizarDistribucionCombustible(ByVal documento As String, ByVal codTanque As String, ByVal CodProducto As Int32, ByVal cantidadDocumento As Nullable(Of Decimal), ByVal cantidadPorOperacion As Nullable(Of Decimal), ByVal cantidadPorRecibo As Nullable(Of Decimal), ByVal cantidadPorVentas As Nullable(Of Decimal), ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDistribucionCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, documento)
        DB.AddInParameter(DatabaseCommand, "CodTanque", DbType.String, codTanque)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, CodProducto)
        DB.AddInParameter(DatabaseCommand, "CantidadDocumento", DbType.Decimal, cantidadDocumento)
        DB.AddInParameter(DatabaseCommand, "CantidadPorOperacion", DbType.Decimal, cantidadPorOperacion)
        DB.AddInParameter(DatabaseCommand, "CantidadPorRecibo", DbType.Decimal, cantidadPorRecibo)
        DB.AddInParameter(DatabaseCommand, "CantidadPorVentas", DbType.Decimal, cantidadPorVentas)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarInformacionDetalleTrasladoCanastilla(ByVal IdTraslado As Long) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionDetalleTrasladoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTraslado", DbType.Int32, IdTraslado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarAlarmaSobreTasa(ByVal IdAlarma As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAlarmaSobreTasa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAlarma", DbType.Int32, IdAlarma)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarAlarmaVeederRoot(ByVal IdAlarma As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAlarmaMedicion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAlarma", DbType.Int32, IdAlarma)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Productos Autorizados"
    Public Function EsEstacionAfiliada() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsEstacionAfiliada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function EsEstacionAfiliada(ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsEstacionAfiliada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function EsEstacionPropia() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EsEstacionPropia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Boolean

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Public Function FueUtilizadaClaveCambioPrecios(ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FueUtilizadaClaveCambioPrecios"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ClaveAutorizacion", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Canastilla Identificado     "
    Public Function ValidarVentaCanastilla(ByVal TipoAutorizacion As Short, ByVal NumeroIdentificacion As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int16, TipoAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, NumeroIdentificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ValidarVentaCanastilla(ByVal TipoAutorizacion As Short, ByVal NumeroIdentificacion As String, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int16, TipoAutorizacion)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, NumeroIdentificacion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidaRestriccionesCanastilla(ByVal Placa As String, ByVal CodProducto As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaRestriccionesCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, CodProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidaRestriccionesCanastilla(ByVal rom As String, ByVal CodProducto As Integer, ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaRestriccionesCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, rom)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, CodProducto)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarVentaCanastillaDetalle(ByVal IdVenta As Int32, ByVal oItems As List(Of DetalleItem))
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaCanastillaDetalle"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        For Each oFila As DetalleItem In oItems
            DB.AddInParameter(DatabaseCommand, "IdVentaCanastilla", DbType.Int32, IdVenta)
            DB.AddInParameter(DatabaseCommand, "Producto", DbType.Int16, oFila.Codigo)
            DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, oFila.Cantidad)

            Using connection As DbConnection = DB.CreateConnection()
                connection.Open()

                Try
                    'Ejecuta el Procedimiento Almacenado
                    DB.ExecuteNonQuery(DatabaseCommand)
                Catch
                    Throw
                Finally
                    connection.Close()
                End Try
            End Using
        Next
    End Sub

    Public Sub InsertarVentaCanastillaFormaPago(ByVal Idventa As Int32, ByVal idFormaPago As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaCanastillaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdVentaCanastilla", DbType.Int32, Idventa)
        DB.AddInParameter(DatabaseCommand, "FormaPago", DbType.Int16, idFormaPago)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarEncabezadoCanastillaEmpleado(ByVal Cara As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoCanastillaEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarEncabezadoCanastillaEmpleado(ByVal Cara As Int16, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoCanastillaEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDatosProducto(ByVal Codigo As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int16, Codigo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarDatosProducto(ByVal Codigo As Int16, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int16, Codigo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "       Pedidos de Canastilla       "
    Public Sub CargarPedidosCanastilla(ByVal ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarPedidosCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region


#Region "   Consignacion de Transportadora  "

    Public Function RecuperarSobresParaConsignar() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSobresParaConsignar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTransportadoras() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTransportadoras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarBancos() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarBancos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ExisteRemesa(ByVal Remesa As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteRemesa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Remesa", DbType.Int32, Remesa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTransportadorasDataAdmin() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTodasTransportadoras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTransportadoraPorId(ByVal idTransportadora As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTransportadoraPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTransportadora", DbType.Int32, idTransportadora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarTransportadora(ByVal idTransportadora As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTransportadora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTransportadora", DbType.Int32, idTransportadora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ActualizarTransportadora(ByVal idTransportadora As Nullable(Of Int32), ByVal Nombre As String, ByVal Nit As String, ByVal EsActiva As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTransportadora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTransportadora", DbType.Int32, idTransportadora)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
        DB.AddInParameter(DatabaseCommand, "Activa", DbType.Boolean, EsActiva)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ActualizarResolucion(ByVal IdResolucion As Nullable(Of Int32), ByVal NroResolucion As String, ByVal Prefijo As String, ByVal NroInicial As Int32, ByVal NroFinal As Int32, ByVal FechaExpedicion As DateTime, ByVal FechaVencimiento As DateTime, ByVal NroResolucionGContribuyente As String, ByVal FechaResolucionGContribuyente As DateTime, ByVal NroResolucionAutoretenedor As String, ByVal FechaResolucionAutoretenedor As DateTime) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarResolucion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdResolucion", DbType.Int32, IdResolucion)
        DB.AddInParameter(DatabaseCommand, "NroResolucion", DbType.String, NroResolucion)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "NroInicial", DbType.Int32, NroInicial)
        DB.AddInParameter(DatabaseCommand, "NroFinal", DbType.Int32, NroFinal)
        DB.AddInParameter(DatabaseCommand, "FechaExpedicion", DbType.DateTime, FechaExpedicion)
        DB.AddInParameter(DatabaseCommand, "FechaVencimiento", DbType.DateTime, FechaVencimiento)
        DB.AddInParameter(DatabaseCommand, "NroResolucionGContribuyente", DbType.String, NroResolucionGContribuyente)
        DB.AddInParameter(DatabaseCommand, "FechaResolucionGContribuyente", DbType.DateTime, FechaResolucionGContribuyente)
        DB.AddInParameter(DatabaseCommand, "NroResolucionAutoretenedor", DbType.String, NroResolucionAutoretenedor)
        DB.AddInParameter(DatabaseCommand, "FechaResolucionAutoretenedor", DbType.DateTime, FechaResolucionAutoretenedor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarResolucion(ByVal idResolucion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarResolucion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idResolucion", DbType.Int32, idResolucion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarResolucionesDataAdmin() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarResoluciones"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarResolucionPorId(ByVal idResolucion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarResolucionPorId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idResolucion", DbType.Int32, idResolucion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function InsertarConsignacionTransportadora(ByVal Fecha As String, ByVal NoPicos As Int32, ByVal ValorPicos As Decimal, _
                ByVal NoSobres As Int32, ByVal ValorSobres As Decimal, ByVal IdTransportadora As Int32, ByVal Consignaciones As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarConsignacionTransportadora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
        DB.AddInParameter(DatabaseCommand, "NoPicos", DbType.Int32, NoPicos)
        DB.AddInParameter(DatabaseCommand, "ValorPicos", DbType.Decimal, ValorPicos)
        DB.AddInParameter(DatabaseCommand, "NoSobres", DbType.Int32, NoSobres)
        DB.AddInParameter(DatabaseCommand, "ValorSobres", DbType.Decimal, ValorSobres)
        DB.AddInParameter(DatabaseCommand, "IdTransportadora", DbType.Int32, IdTransportadora)
        DB.AddInParameter(DatabaseCommand, "Consignaciones", DbType.String, Consignaciones)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarConsignacionTransportadoraMoneda(ByVal Fecha As String, ByVal NoPicos As Int32, ByVal ValorPicos As Decimal, _
                ByVal NoSobres As Int32, ByVal ValorSobres As Decimal, ByVal IdTransportadora As Int32, ByVal Consignaciones As String, _
                ByVal IdBanco As Int16, ByVal Remesa As Int32, ByVal IdMoneda As Int16) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarConsignacionTransportadoraMoneda"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
        DB.AddInParameter(DatabaseCommand, "NoPicos", DbType.Int32, NoPicos)
        DB.AddInParameter(DatabaseCommand, "ValorPicos", DbType.Decimal, ValorPicos)
        DB.AddInParameter(DatabaseCommand, "NoSobres", DbType.Int32, NoSobres)
        DB.AddInParameter(DatabaseCommand, "ValorSobres", DbType.Decimal, ValorSobres)
        If IdTransportadora > 0 Then
            DB.AddInParameter(DatabaseCommand, "IdTransportadora", DbType.Int32, IdTransportadora)
        End If
        DB.AddInParameter(DatabaseCommand, "Consignaciones", DbType.String, Consignaciones)
        If IdBanco > 0 Then
            DB.AddInParameter(DatabaseCommand, "IdBanco", DbType.Int16, IdBanco)
        End If
        DB.AddInParameter(DatabaseCommand, "Remesa", DbType.Int32, Remesa)
        DB.AddInParameter(DatabaseCommand, "IdMoneda", DbType.Int16, IdMoneda)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarConsignacionTransportadora(ByVal Fecha As String, ByVal NoPicos As Int32, ByVal ValorPicos As Decimal, _
                ByVal NoSobres As Int32, ByVal ValorSobres As Decimal, ByVal IdTransportadora As Int32, ByVal Consignaciones As String, ByVal Cheques As String) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarConsignacionTransportadora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)
        DB.AddInParameter(DatabaseCommand, "NoPicos", DbType.Int32, NoPicos)
        DB.AddInParameter(DatabaseCommand, "ValorPicos", DbType.Decimal, ValorPicos)
        DB.AddInParameter(DatabaseCommand, "NoSobres", DbType.Int32, NoSobres)
        DB.AddInParameter(DatabaseCommand, "ValorSobres", DbType.Decimal, ValorSobres)
        DB.AddInParameter(DatabaseCommand, "IdTransportadora", DbType.Int32, IdTransportadora)
        DB.AddInParameter(DatabaseCommand, "Consignaciones", DbType.String, Consignaciones)
        DB.AddInParameter(DatabaseCommand, "Cheques", DbType.String, Cheques)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdConsignacion() As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdConsignacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsigancionSobreIdConsignacion(ByVal IdConsignacion As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsigancionSobreIdConsignacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdConsignacion", DbType.Int64, IdConsignacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosConsigancionId(ByVal IdConsignacion As Int64) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosConsigancionId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdConsignacion", DbType.Int64, IdConsignacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "    Devolucion de Factura Canastilla Terpel     "

    Public Function AnularDocumento(ByVal Prefijo As String, ByVal Numero As Int64, ByVal Empleado As String, ByVal Clave As String) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AnularDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, Numero)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function AnularDocumento(ByVal Prefijo As String, ByVal Numero As Int64, ByVal Empleado As String, ByVal Clave As String, ByVal idEstacion As Int16) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AnularDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.Int64, Numero)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "       Registrar Gerenciamiento Canastilla Combustible     "
    Public Sub InsertarVentaGerenciamientoCanastila(ByVal IdAutorizacion As String, ByVal IdVenta As Int64, ByVal EsCanastilla As Boolean, ByVal EsLocal As Boolean, ByVal EsSobreGiro As Boolean, ByVal IdExtraCupo As Long, ByVal Rom As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaCanastillaGerenciada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.String, IdAutorizacion)
        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int64, IdVenta)
        DB.AddInParameter(DatabaseCommand, "EsCanastilla", DbType.Boolean, EsCanastilla)
        DB.AddInParameter(DatabaseCommand, "EsLocal", DbType.Boolean, EsLocal)
        DB.AddInParameter(DatabaseCommand, "EsSobreGiro", DbType.Boolean, EsSobreGiro)
        DB.AddInParameter(DatabaseCommand, "IdExtraCupo", DbType.Int32, IdExtraCupo)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaGerenciamientoCanastila(ByVal IdAutorizacion As String, ByVal IdVenta As Int64, ByVal EsCanastilla As Boolean, ByVal EsLocal As Boolean, ByVal EsSobreGiro As Boolean, ByVal IdExtraCupo As Long, ByVal Rom As String, ByVal Contrato As String, ByVal CodigoCentroCosto As String, ByVal NombreCentroCosto As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaCanastillaGerenciada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.String, IdAutorizacion)
        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int64, IdVenta)
        DB.AddInParameter(DatabaseCommand, "EsCanastilla", DbType.Boolean, EsCanastilla)
        DB.AddInParameter(DatabaseCommand, "EsLocal", DbType.Boolean, EsLocal)
        DB.AddInParameter(DatabaseCommand, "EsSobreGiro", DbType.Boolean, EsSobreGiro)
        DB.AddInParameter(DatabaseCommand, "IdExtraCupo", DbType.Int32, IdExtraCupo)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "Contrato", DbType.String, Contrato)
        DB.AddInParameter(DatabaseCommand, "CodigoCentroCosto", DbType.String, CodigoCentroCosto)
        DB.AddInParameter(DatabaseCommand, "NombreCentroCosto", DbType.String, NombreCentroCosto)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVentaGerenciamientoCanastila(ByVal IdAutorizacion As String, ByVal IdVenta As Int64, ByVal EsCanastilla As Boolean, ByVal EsLocal As Boolean, ByVal EsSobreGiro As Boolean, ByVal IdExtraCupo As Long, ByVal Rom As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaCanastillaGerenciada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.String, IdAutorizacion)
        DB.AddInParameter(DatabaseCommand, "IdVenta", DbType.Int64, IdVenta)
        DB.AddInParameter(DatabaseCommand, "EsCanastilla", DbType.Boolean, EsCanastilla)
        DB.AddInParameter(DatabaseCommand, "EsLocal", DbType.Boolean, EsLocal)
        DB.AddInParameter(DatabaseCommand, "EsSobreGiro", DbType.Boolean, EsSobreGiro)
        DB.AddInParameter(DatabaseCommand, "IdExtraCupo", DbType.Int32, IdExtraCupo)
        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Informacin de TaskManager  "
    Public Function RecuperarFechaUltimaGeneracionFactura() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFechaUltimaGeneracionFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Carga Inicial de Datos    "

    Public Function RecuperarSurtidoresPorIdIsla(ByVal IdIsla As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSurtidoresPorIdIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, IdIsla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarManguerasPorIdSurtidor(ByVal IdSurtidor As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarManguerasPorIdSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, IdSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasPorIdManguera(ByVal IdManguera As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorIdManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarStockPorIdTanque(ByVal IdTanque As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarStockPorIdTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdTanque", DbType.Int16, IdTanque)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   Tipo Vehiculo   "

    Public Function RecuperarTipoVehiculo() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarRestriccionTipoVehiculoEnIsla(ByVal cara As Short) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRestriccionTipoVehiculoEnIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarRestriccionTipoVehiculoNoIdentificadoEnIsla(ByVal cara As Short) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRestriccionTipoVehiculoNoIdentificadoEnIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ValidarRestriccionTipoVehiculoNoIdentificadoEnIsla(ByVal cara As Short, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRestriccionTipoVehiculoNoIdentificadoEnIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdEsatcion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarRestriccionTipoVehiculoIdentificadoEnIsla(ByVal cara As Short, ByVal placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRestriccionTipoVehiculoIdentificadoEnIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ValidarRestriccionTipoVehiculoIdentificadoEnIsla(ByVal cara As Short, ByVal placa As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarRestriccionTipoVehiculoIdentificadoEnIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region

#Region "   Recepcion de Productos de Canastilla    "

    Public Sub InsertarMovimientoDetalleCostoTmp(ByVal NombreEquipo As String, ByVal Producto As Int16, ByVal Cantidad As Int16, ByVal CodProveedor As String, ByVal Costo As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMovimientoDetalleCostoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, NombreEquipo)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int16, Producto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int16, Cantidad)
        DB.AddInParameter(DatabaseCommand, "CodProveedor", DbType.String, CodProveedor)
        DB.AddInParameter(DatabaseCommand, "Costo", DbType.Decimal, Costo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarProveedores() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProveedores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosProveedor(ByVal Codigo As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosProveedor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarMovimientoDetalleCostoTmp(ByVal NombreEquipo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMovimientoDetalleCostoTmp"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NombrePC", DbType.String, NombreEquipo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarMovimientoCostoCargaInicial(ByVal numeroDocumento As String, ByVal idEstacionOrigen As Int16, ByVal idEstacionDestino As Int16, ByVal idTipoMovimiento As Int32, ByVal observaciones As String, ByVal NombreEquipo As String, ByVal idTipoDocumento As Int32, ByVal EsCombustible As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMovimientoCosto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroDocumento", DbType.String, numeroDocumento)
        DB.AddInParameter(DatabaseCommand, "IdEstacionOrigen", DbType.Int16, idEstacionOrigen)
        DB.AddInParameter(DatabaseCommand, "IdEstacionDestino", DbType.Int16, idEstacionDestino)
        DB.AddInParameter(DatabaseCommand, "IdTipoMovimientoDetalle", DbType.Int32, idTipoMovimiento)
        DB.AddInParameter(DatabaseCommand, "Observaciones", DbType.String, observaciones)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumento", DbType.Int32, idTipoDocumento)
        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, NombreEquipo)
        DB.AddOutParameter(DatabaseCommand, "IdMovimiento", DbType.Int32, 4)
        DB.AddInParameter(DatabaseCommand, "EsCombustible", DbType.Boolean, EsCombustible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function InsertarMovimientoCosto(ByVal numeroDocumento As String, ByVal idEstacionOrigen As Int16, ByVal idEstacionDestino As Int16, ByVal idTipoMovimiento As Int32, ByVal observaciones As String, ByVal NombreEquipo As String, ByVal idTipoDocumento As Int32, ByVal EsCombustible As Boolean) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMovimientoCosto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroDocumento", DbType.String, numeroDocumento)
        DB.AddInParameter(DatabaseCommand, "IdEstacionOrigen", DbType.Int16, idEstacionOrigen)
        DB.AddInParameter(DatabaseCommand, "IdEstacionDestino", DbType.Int16, idEstacionDestino)
        DB.AddInParameter(DatabaseCommand, "IdTipoMovimientoDetalle", DbType.Int32, idTipoMovimiento)
        DB.AddInParameter(DatabaseCommand, "Observaciones", DbType.String, observaciones)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumento", DbType.Int32, idTipoDocumento)
        DB.AddInParameter(DatabaseCommand, "NomEquipo", DbType.String, NombreEquipo)
        DB.AddOutParameter(DatabaseCommand, "IdMovimiento", DbType.Int32, 4)
        DB.AddInParameter(DatabaseCommand, "EsCombustible", DbType.Boolean, EsCombustible)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.GetParameterValue(DatabaseCommand, "IdMovimiento"))

            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub RecuperarValidacionCostoArticulo(ByVal Codigo As String, ByVal ValorUnitario As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValidacionCostoArticulo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)
        DB.AddInParameter(DatabaseCommand, "VU", DbType.Decimal, ValorUnitario)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region

#Region "    CANASTILLA ELKIN Y MENDOZA     "
    Public Function RecuperarReciboCanastillaPorDocumento(ByVal IdDocumento As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboCanastillaPorDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int32, IdDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsumoDisponiblePorRestriccion(ByVal Placa As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsumoDisponiblePorRestriccion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsumoDisponiblePorRestriccion(ByVal ROM As String, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsumoDisponiblePorRestriccion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ManejaContrato(ByVal placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaContrato"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function ManejaContrato(ByVal placa As String, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ManejaContrato"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function EsEmpresaInfoTaxi(ByVal IdEmpresa As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiEmpresaEsInfotaxi"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function EsEmpresaInfoTaxi(ByVal IdEmpresa As Integer, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiEmpresaEsInfotaxi"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarConsumoDisponiblePorCupo(ByVal placa As String, ByVal Codigo As Integer) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsumoDisponiblePorCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarConsumoDisponiblePorCupo(ByVal placa As String, ByVal Codigo As Integer, ByVal idEstacion As Int16) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsumoDisponiblePorCupo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function PoseeRestriccionBasicaActiva(ByVal Placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "PoseeRestriccionBasicaActiva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function PoseeRestriccionBasicaActiva(ByVal ROM As String, ByVal idEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "PoseeRestriccionBasicaActiva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "ROM", DbType.String, ROM)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdVentaCanastillaPorRecibo(ByVal recibo As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdVentaCanastillaPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function
#End Region

#Region "   Descuentos Promocionales por tarjeta    "

    Public Function ValidarInformacionDescuentoPromocion(ByVal CodigoTarjeta As String, ByVal Cantidad As Decimal, ByVal Valor As Decimal) As Long
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarInformacionDescuentoPromocion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim IdDescPromoAUtilizar As Long

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, CodigoTarjeta)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddOutParameter(DatabaseCommand, "IdDescPromoAUtilizar", DbType.Int64, CInt(IdDescPromoAUtilizar))

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado

                DB.ExecuteNonQuery(DatabaseCommand)
                If DB.GetParameterValue(DatabaseCommand, "IdDescPromoAUtilizar") Is System.DBNull.Value Then
                    Return -1
                Else
                    Return CLng(DB.GetParameterValue(DatabaseCommand, "IdDescPromoAUtilizar"))
                End If

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionEmpleadoCara(ByVal Cara As Short) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionEmpleadoCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Solicitud de Consecutivo Factura HO     "

    Public Function RecuperarConsecutivoFacturaParaHO(ByVal HostCliente As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsecutivoFacturaParaHO"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "HostCliente", DbType.String, HostCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   Liberar Cupo en Reserva     "

    Public Sub LiberarCupoenReserva(ByVal Cara As Short, ByVal Placa As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "LiberarCupoenReserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub LiberarCupoenReserva(ByVal Cara As Short, ByVal Placa As String, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "LiberarCupoenReserva"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#End Region

#Region "  Envio Recibos Contenidos en una Factura de Venta  "
    Public Function RecuperarVentasAsociadasaFactura(ByVal IdDocumento As Int64, ByVal EsCanastilla As Boolean) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasAsociadasaFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = 90

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int64, IdDocumento)
        DB.AddInParameter(DatabaseCommand, "EsCanastilla", DbType.Boolean, EsCanastilla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "Venta Millonaria"
    Public Function RecuperarInformacionVentaMillonariaCDC(ByVal recibo As Int64) As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionVentaMillonariaCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionCreditoVentaMillonariaCDC(ByVal recibo As Int64) As System.Data.DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionCreditoVentaMillonariaCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub AutorizarAjusteVenta(ByVal Recibo As Int64, ByVal LecturaInicial As Decimal, ByVal LecturaFinal As Decimal, ByVal Cantidad As Decimal, ByVal Abonocredito As Decimal, ByVal Valor As Decimal)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AjustarVentaMillonariaCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "LecturaInicial", DbType.Decimal, LecturaInicial)
        DB.AddInParameter(DatabaseCommand, "LecturaFinal", DbType.Decimal, LecturaFinal)
        DB.AddInParameter(DatabaseCommand, "Cantidad ", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "Abonocredito ", DbType.Decimal, Abonocredito)
        DB.AddInParameter(DatabaseCommand, "Valor ", DbType.Decimal, Valor)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub AutorizarAjusteVentaCredito(ByVal Recibo As Int64)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AjustarCreditoVentaMillonariaCDC "
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


#End Region

#Region "Fidelizacion"
    Public Sub ActualizarFormaPagoVentaBonoFidelizacion(ByVal recibo As Int64, ByVal valor As Decimal, ByVal nroTarjeta As String, ByVal nroAutorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPagoVentaBonoFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "ValorBono", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, nroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarFormaPagoVentaBonoFidelizacion(ByVal recibo As Int64, ByVal valor As Decimal, ByVal nroTarjeta As String, ByVal nroAutorizacion As String, ByRef anulado As Int64, ByRef nuevo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFormaPagoVentaBonoFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "ValorBono", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, nroAutorizacion)

        DB.AddOutParameter(DatabaseCommand, "DocumentoAnulacion", DbType.Int64, 0)
        DB.AddOutParameter(DatabaseCommand, "DocumentoNuevo", DbType.Int64, 0)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
                anulado = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoAnulacion"))
                nuevo = CLng(DB.GetParameterValue(DatabaseCommand, "DocumentoNuevo"))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarIntentoFallidoPagoBonoFidelizacion(ByVal recibo As Int64, ByVal valor As Decimal, ByVal nroTarjeta As String, ByVal nroAutorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarIntentoFallidoPagoBonoFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "ValorBono", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, nroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    

    Public Function ValidarPagoConBonoFidelizacion(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPagoConBonoFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarPagoConBonoFidelizacionDirecta(ByVal recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPagoConBonoFidelizacionDirecta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarDocumentoPorRecibo(ByVal recibo As Int64, ByVal TipoDocumentoConsecutivo As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarDocumentoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "TipoDocumentoConsecutivo", DbType.Int16, TipoDocumentoConsecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarVentaPagaBonoFidelizacion(ByVal recibo As Int64, ByVal valor As Decimal, ByVal nroTarjeta As String, ByVal nroAutorizacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarVentaPagaBonoFidelizacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "ValorBono", DbType.Decimal, valor)
        DB.AddInParameter(DatabaseCommand, "NroTarjeta", DbType.String, nroTarjeta)
        DB.AddInParameter(DatabaseCommand, "NroAutorizacion", DbType.String, nroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function ValidarImpresionDescuentoPromocional(ByVal recibo As Int64) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarImpresionDescuentoPromocional"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Dim Respuesta As Boolean = CBool(DB.ExecuteScalar(DatabaseCommand))
                Return Respuesta
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Notificacin Autorizacin Utilizada     "
    Public Function RecuperarAutorizacionUtilizada(ByVal NumeroAutorizacion As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarAutorizacionUtilizada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdAutorizacion", DbType.String, NumeroAutorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region " AUTOSERVICIO "

    Public Function ActivarDesactivarEmpleadoTurno(ByVal idEmpleado As String, ByVal clave As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActivarDesactivarEmpleadoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CedulaEmpleado", DbType.String, idEmpleado)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, clave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarInformacionSesionesActivas(ByVal puerto As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionSesionesActivas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Puerto", DbType.String, puerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using

    End Function

#End Region

#Region "DB Tuning"
    Public Sub EjecutarReconstruccionIndicesHadi(ByVal tiempoEspera As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ReconstruirIndices"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = tiempoEspera

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EjecutarReconstruccionIndicesMandino(ByVal tiempoEspera As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ReconstruirIndices"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = tiempoEspera

        Using connection As DbConnection = DB.CreateConnection()
            connection.ConnectionString = System.Configuration.ConfigurationManager.ConnectionStrings("MandinoDataBase").ConnectionString
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EjecutarActualizacionEstadisticasHadi(ByVal tiempoEspera As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadisticas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = tiempoEspera

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EjecutarActualizacionEstadisticasMandino(ByVal tiempoEspera As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadisticas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = tiempoEspera

        Using connection As DbConnection = DB.CreateConnection()
            connection.ConnectionString = System.Configuration.ConfigurationManager.ConnectionStrings("MandinoDataBase").ConnectionString
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "OperadoresGasocentro PGN"
    Public Sub CrearOperadorGasocentroPGN(ByVal Ruc As String, ByVal Nombre As String, ByVal Codigo As String, ByVal RazonSocial As String, ByVal EsActivo As Boolean)

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarOperadorGasocentro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub ActualizarOperadorGasocentroPGN(ByVal Ruc As String, ByVal Nombre As String, ByVal Codigo As String, ByVal RazonSocial As String, ByVal IdOperador As Int32, ByVal EsActivo As Boolean)

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarOperadorGasocentro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "IdOperador", DbType.Int32, IdOperador)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, EsActivo)




        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarVehiculoOperadorPGN(ByVal RazonSocial As String, ByVal Placa As String, ByVal Estado As Boolean)


        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AlmacenarVehiculoOperadorGas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "EsActivo", DbType.Boolean, Estado)




        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarOperadoresGasocentroPGN(ByVal Ruc As String, ByVal RazonSocial As String, ByVal nombre As String) As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarOperadoresGasocentroPGN"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarRazonSocialGasocentroPGN() As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRazonSocialGasocentroPGN"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarVehiculosPGN() As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVehiculosPGN"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarDatosVehiculoGasoCentroPGN(ByVal IdOperador As Integer, ByVal Placa As String) As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoGasoCentroPGN"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdOperador", DbType.Int32, IdOperador)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosVehiculoGasoCentroPGN(ByVal Operador As String, ByVal Placa As String) As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosVehiculoGasoCentroPorOperador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, Operador)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

    Public Sub ActualizarIslaImpresora(ByVal idIsla As Int16, ByVal idImpresora As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIslaImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, idIsla)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarIslasImpresoras() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslasImpresoras"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarIslaImpresora(ByVal idIsla As Int16, ByVal idImpresora As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarIslaImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int16, idIsla)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, idImpresora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarRazonSocialPorNombreRuc(ByVal Razonsocial As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRazonSocialPorNombreRuc"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Razonsocial)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarValorIvaImpresionFacturaClienteTerpel(ByVal Recibo As Double) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorIvaImpresionFacturaCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Double, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarValorIvaImpresionFacturaClienteTerpel(ByVal Recibo As Double, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorIvaImpresionFacturaCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Double, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarFormasPagoAbonoPorTurno(ByVal IdTurno As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormasPagoAbonoPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function








    Public Function RecuperarValorIvaImpresionFacturaId(ByVal IdDocumento As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorIvaImpresionFacturaId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int64, IdDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarValorIvaImpresionFacturaId(ByVal IdDocumento As Int64, ByVal idEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarValorIvaImpresionFacturaId"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDocumento", DbType.Int64, IdDocumento)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function ValidarMediosPagosCanatillaGazel() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarMediosPagosCanatilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ValidarMediosPagosAbonoExtraGazel() As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarMediosPagosAbonoExtraGazel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function









    Public Sub CancelarVentaGerenciada(ByVal cara As Byte)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CancelarVentaGerenciada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub CancelarVentaGerenciada(ByVal cara As Byte, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CancelarVentaGerenciada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


#Region "MensajesPeru"
    Public Sub InsertarMensajePeru(ByVal idMensaje As Int32, ByVal texto As String, ByVal desde As Date, ByVal hasta As Date, ByVal tipo As Int32, ByVal idCliente As Nullable(Of Int32), ByVal estado As Boolean, ByVal Orden As Int32, Optional ByVal Placa As String = Nothing)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarSloganEDSPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMensaje", DbType.Int32, idMensaje)
        DB.AddInParameter(DatabaseCommand, "Texto", DbType.String, texto)
        DB.AddInParameter(DatabaseCommand, "Desde", DbType.Date, desde)
        DB.AddInParameter(DatabaseCommand, "Hasta", DbType.Date, hasta)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int32, tipo)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, estado)
        DB.AddInParameter(DatabaseCommand, "Orden", DbType.Int32, Orden)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub EliminarMensajeEDSPeru(ByVal IdMensaje As Int32)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMensajeEDSPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdMensaje", DbType.Int32, IdMensaje)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Function RecuperarRucClienteMensaje(ByVal RUC As String) As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRucClienteMensaje"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionClienteSlogan(ByVal Ruc As String) As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionClienteSlogan"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, Ruc)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMensajePorCliente(ByVal IdCliente As Int32) As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajePorCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarMensajePorPlaca(ByVal Placa As String) As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajePorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoIdMensaje() As Int32
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoIdMensaje"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

    Public Function RecuperarMensajePorEstacion() As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajePorEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function



    Public Function RecuperarMensajePorTurnos() As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMensajePorTurnos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

#Region "Promociones Peru"

    Public Sub InsertarPromocionVentaPremio(ByVal Consecutivo As Integer, ByVal IdTipoPromocion As Integer, ByVal NumeroVentas As Int64, ByVal FechaInicio As DateTime, ByVal FechaFin As DateTime, ByVal Estado As Boolean, ByVal Descripcion As String)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPromocionVentaPremio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "NumeroVentas", DbType.Int64, NumeroVentas)
        DB.AddInParameter(DatabaseCommand, "FechaInicio", DbType.DateTime, FechaInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFin)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "IdTipoPromocion", DbType.Int32, IdTipoPromocion)
        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.Int32, Consecutivo)




        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub InsertarPromocionVentaPremio(ByVal IdTipoPromocion As Integer, ByVal NumeroVentas As Int64, ByVal FechaInicio As DateTime, ByVal FechaFin As DateTime, ByVal Estado As Boolean, ByVal Descripcion As String, ByVal Cantidad As Decimal)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarPromocionVentaPremio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "NumeroVentas", DbType.Int64, NumeroVentas)
        DB.AddInParameter(DatabaseCommand, "FechaInicio", DbType.DateTime, FechaInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFin)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "IdTipoPromocion", DbType.Int32, IdTipoPromocion)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)





        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub





    Public Sub RecalcularPremioVenta(ByVal Recibo As Int64)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecalcularPremioVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarNumeroVentasNV(ByVal Recibo As Int64) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNumeroVentasNV"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ValidarReciboPorNumeroVentas(ByVal Recibo As Int64) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarReciboPorNumeroVentas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ValidarPremioPorVentas(ByVal Recibo As Int64) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPremioPorVentas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub RedimirVentaPremio(ByVal Recibo As Int64, ByVal Fecha As DateTime)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RedimirVentaPremio"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)



        Using connection As DbConnection = DB.CreateConnection()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarVentaPremiosPorFecha(ByVal FechaIncial As DateTime, ByVal FechaFinal As DateTime, ByVal Placa As String) As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaPremiosPorFecha"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "FechaIncial", DbType.DateTime, FechaIncial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal ", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "Placa ", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function


    Public Function RecuperarTipoPromocionesGST() As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoPromocionesGST"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function








    Public Sub ActualizarPromocionNV(ByVal IdPromocion As Int32, ByVal NumeroVentas As Int32, ByVal FechaInicio As DateTime, ByVal FechaFin As DateTime, ByVal Estado As Boolean, ByVal Cantidad As Decimal, Optional ByVal Comentario As String = Nothing)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarPromocionNV"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdPromocion", DbType.Int32, IdPromocion)
        DB.AddInParameter(DatabaseCommand, "FechaInicio", DbType.DateTime, FechaInicio)
        DB.AddInParameter(DatabaseCommand, "FechaFin ", DbType.DateTime, FechaFin)
        DB.AddInParameter(DatabaseCommand, "NumeroVentas ", DbType.Int32, NumeroVentas)
        DB.AddInParameter(DatabaseCommand, "Estado", DbType.Boolean, Estado)
        DB.AddInParameter(DatabaseCommand, "Comentario", DbType.String, Comentario)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarRedencionNV(ByVal Serie As String, ByVal consecutivo As String, ByVal FechaRedencion As DateTime, Optional ByVal Comentario As String = Nothing)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRedencionNV"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Serie", DbType.String, Serie)
        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.String, consecutivo)
        DB.AddInParameter(DatabaseCommand, "FechaRedencion", DbType.DateTime, FechaRedencion)
        DB.AddInParameter(DatabaseCommand, "Comentario", DbType.String, Comentario)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function RecuperarPromocionesNVPeru() As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPromocionesNVPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarRedencionesNVPeru() As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedencionesNV"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function


    Public Function RecuperarRedencionesNVPeru(ByVal Prefijo As String, ByVal Numero As String) As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRedencionesNVPorDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function


    Public Sub ValidarTanqueoGasocentroCerrado(ByVal Placa As String)

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVehiculoTanquoGasocentro"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Function RecuperarVentaPremiosPorRecibo(ByVal serie As String, ByVal Consecutivo As String) As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaPremiosPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Serial", DbType.String, serie)
        DB.AddInParameter(DatabaseCommand, "Consecutivo", DbType.String, Consecutivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Function

    Public Function RecuperarVentasCredito(ByVal recibo As Nullable(Of Int64), ByVal placa As String, ByVal fecha As DateTime) As DataSet
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, placa)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ModificarKilometrajeVenta(ByVal recibo As Int64, ByVal kilometraje As Int32)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ModificarKilometrajeVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "Kilometraje", DbType.Int32, kilometraje)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

    Public Function RecuperarPredeterminacionDescuentoPrecio(ByVal Placa As String, ByVal Valor As Decimal, ByVal VentaFidelizada As Boolean) As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarPromocionVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "EsVentaFidelizada", DbType.Boolean, VentaFidelizada)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPredeterminacionDescuentoPrecio(ByVal RUC As String, ByVal Placa As String, ByVal Valor As Decimal) As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPredeterminacionClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarTotalOperacionesTurnos(ByVal Turno As Int32) As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalOperacionesTurnos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, Turno)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function






    Public Function RecuperarUrlEmpresaPgnSRE(ByVal IdEmpresa As Int32) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUrlEmpresa"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpresa", DbType.Int32, IdEmpresa)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarDatosDataTrack(ByVal Recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosDataTrack"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarEstadoEnvioVenta(ByVal Recibo As Int64) As Int32
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEstadoTransmisionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Sub InsertarAnulacionDocumento(ByVal Recibo As Int64, ByVal IdEstadoTransmision As Integer)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAnulacionDocumento"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstadoTransmision", DbType.Int32, IdEstadoTransmision)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarEstadoTransmisionDeAnulacion(ByVal Recibo As Int64, ByVal IdEstadoTransmision As Integer)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoTransmisionDeAnulacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstadoTransmision", DbType.Int32, IdEstadoTransmision)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function RecuperarDocumentosAnuladosPgn() As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDocumentosAnuladoPgn"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarUltimoDocumentoAnuladoPGN() As Integer
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimoDocumentoAnuladoPGN"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#Region "Usuarios Activos Gazel"
    Public Sub ValidarCredencialesIslero(ByVal Empleado As String, ByVal clave As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesIslero"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave ", DbType.String, clave)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function ValidarCredencialesUsuarioVentaCreditoManual(ByVal Empleado As String, ByVal clave As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesUsuarioCreditoManual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave ", DbType.String, clave)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool((DB.ExecuteScalar(DatabaseCommand)))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Sub ValidarCredencialesUsuarioAdministrador(ByVal Empleado As String, ByVal clave As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesUsuarioAdministrador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave ", DbType.String, clave)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Public Sub ValidarCredencialesUsuarioAdministrador(ByVal Empleado As String, ByVal clave As String, ByVal IdEstacion As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCredencialesUsuarioAdministrador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "Clave ", DbType.String, clave)
        DB.AddInParameter(DatabaseCommand, "IdEstacion ", DbType.Int32, IdEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function RecuperarIslerosDisponibles() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslerosDisponibles"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarIslerosDisponibles(ByVal IdEstacion As Int16) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslerosDisponibles"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Mezcladores     "

    Public Function RecuperarMezcladores() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMezcladores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarMezclador(ByVal Descripcion As String, ByVal Activo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, Activo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMezclador(ByVal IdMezclador As Int16, ByVal Descripcion As String, ByVal Activo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, Activo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarMezclador(ByVal Descripcion As String, ByVal Activo As Boolean, ByVal IdSurtidor As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, Activo)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, IdSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ActualizarMezclador(ByVal IdMezclador As Int16, ByVal Descripcion As String, ByVal Activo As Boolean, ByVal IdSurtidor As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)
        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Descripcion)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, Activo)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, IdSurtidor)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarMezclador(ByVal IdMezclador As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub EliminarRelacionMezcladorTanque(ByVal IdRelacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarRelacionMezcladorTanque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRelacion", DbType.Int32, IdRelacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarRelacionMezclador(ByVal IdRelacion As Int16, ByVal IdMezclador As Int16, ByVal IdTanqueUno As Int16, ByVal PTanqueUno As Decimal, ByVal IdTanqueDos As Int16, ByVal PTanqueDos As Decimal, ByVal IdSurtidor As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRelacionMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRelacion", DbType.Int16, IdRelacion)
        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)
        DB.AddInParameter(DatabaseCommand, "IdTanqueUno", DbType.Int16, IdTanqueUno)
        DB.AddInParameter(DatabaseCommand, "IdTanqueDos", DbType.Int16, IdTanqueDos)
        DB.AddInParameter(DatabaseCommand, "IdSurtidor", DbType.Int16, IdSurtidor)
        DB.AddInParameter(DatabaseCommand, "PTanqueUno", DbType.Decimal, PTanqueUno)
        DB.AddInParameter(DatabaseCommand, "PTanqueDos", DbType.Decimal, PTanqueDos)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarRelacionMezclador(ByVal IdRelacion As Int16, ByVal IdMezclador As Int16, ByVal IdTanqueUno As Int16, ByVal PTanqueUno As Decimal, ByVal IdTanqueDos As Int16, ByVal PTanqueDos As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRelacionMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdRelacion", DbType.Int16, IdRelacion)
        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)
        DB.AddInParameter(DatabaseCommand, "IdTanqueUno", DbType.Int16, IdTanqueUno)
        DB.AddInParameter(DatabaseCommand, "IdTanqueDos", DbType.Int16, IdTanqueDos)
        DB.AddInParameter(DatabaseCommand, "PTanqueUno", DbType.Decimal, PTanqueUno)
        DB.AddInParameter(DatabaseCommand, "PTanqueDos", DbType.Decimal, PTanqueDos)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperaRelacionMezcladores() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperaRelacionMezcladores"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarMezcladorManguera(ByVal IdMezclador As Int16, ByVal IdManguera As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarMezcladorManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)
        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarMangueraPorIdMezclador(ByVal IdMezclador As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMangueraPorIdMezclador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarMezcladorManguera() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarMezcladorManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarMezcladorManguera(ByVal IdMezclador As Int16, ByVal IdManguera As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarMezcladorManguera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdMezclador", DbType.Int16, IdMezclador)
        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, IdManguera)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Tarjeta Bonos   "
    Public Function ValidarNumeroTarjeta(ByVal Numero As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarNumeroTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteScalar(DatabaseCommand).ToString
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

#Region "   Consignacion de Cheques a Transportadoras   "
    Public Function RecuperarChequesConsignar() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarChequesConsignar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region "   Carga Planos Suic   "
    Public Sub InsertarInformacionSuic(ByVal Placa As String, ByVal IdRom As String, ByVal Distribuidora As String, _
    ByVal Taller As String, ByVal Certificadora As String, ByVal Convertido As String, _
    ByVal UltRevision As String, ByVal ProxRevision As String, ByVal EstadoRom As String, _
    ByVal CiudadTaller As String, ByVal Inspector As String, ByVal Archivo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarInformacionSuic"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdRom", DbType.String, IdRom)
        DB.AddInParameter(DatabaseCommand, "Distribuidora", DbType.String, Distribuidora)
        DB.AddInParameter(DatabaseCommand, "Taller", DbType.String, Taller)
        DB.AddInParameter(DatabaseCommand, "Certificadora", DbType.String, Certificadora)
        DB.AddInParameter(DatabaseCommand, "Convertido", DbType.String, Convertido)
        DB.AddInParameter(DatabaseCommand, "UltRevision", DbType.String, UltRevision)
        DB.AddInParameter(DatabaseCommand, "ProxRevision", DbType.String, ProxRevision)
        DB.AddInParameter(DatabaseCommand, "EstadoRom", DbType.String, EstadoRom)
        DB.AddInParameter(DatabaseCommand, "CiudadTaller", DbType.String, CiudadTaller)
        DB.AddInParameter(DatabaseCommand, "Inspector", DbType.String, Inspector)
        DB.AddInParameter(DatabaseCommand, "Archivo", DbType.String, Archivo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CargarPlanoSuic(ByVal Ruta As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarPlanoSuic"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, Ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub CargarPlanoSuic(ByVal Ruta As String, ByVal TiempoDeEspera As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "CargarPlanoSuic"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DatabaseCommand.CommandTimeout = TiempoDeEspera

        DB.AddInParameter(DatabaseCommand, "Ruta", DbType.String, Ruta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Generacin de Impresion de Facturar Canastilla  "
    Public Function InsertarFacturaConsolidadaVentaCanastillaTable(ByVal Hora As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaConsolidadaVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Hora", DbType.String, Hora)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region " Documento Factura Fiscal de Chile "
    Public Function RecuperarEncabezadoDocumentoPorRecibo(ByVal Recibo As Long) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarEncabezadoDocumentoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.String, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region " Validar Venta en Curso "

    Public Sub ValidaVentaEnCursoPorCara(ByVal Cara As Short)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaVentaEnCursoPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ValidaVentaEnCursoPorCara(ByVal Cara As Short, ByVal idEstacion As Int16)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidaVentaEnCursoPorCara"

        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Cierre de Da   "
    Public Function RecuperarCierrediaPendiente() As Date
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCierrediaPendiente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDate(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub GenerarCierredeDia(ByVal Fecha As DateTime, ByVal FechaActual As DateTime)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "GenerarCierredeDia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)
        DB.AddInParameter(DatabaseCommand, "FechaActual", DbType.DateTime, FechaActual)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Empleado Medio Identificacin    "
    Public Function RecuperarIdentificadoresEmpleado(ByVal IdEmpleado As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdentificadoresEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarEstadoIdIdentificador(ByVal IdIdentificador As Int32, ByVal Activo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarEstadoIdIdentificador"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIdentificador", DbType.Int32, IdIdentificador)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, Activo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarIdentificadorEmpleado(ByVal IdEmpleado As Int32, ByVal Identificador As String, ByVal Tipo As Int16, ByVal Activo As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarIdentificadorEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)
        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.String, Identificador)
        DB.AddInParameter(DatabaseCommand, "Tipo", DbType.Int16, Tipo)
        DB.AddInParameter(DatabaseCommand, "Activo", DbType.Boolean, Activo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "   Descuento Cliente Credito   "
    Public Function AplicaDescuentoClienteCredito(ByVal Placa As String) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AplicaDescuentoClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    'Creado por: Christian Galvis
    Public Function AplicaDescuentoClienteCredito(ByVal Placa As String, ByVal IdEstacion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "AplicaDescuentoClienteCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, IdEstacion)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region

#Region " Impresion de Ventas Fidelizadas   "
    Public Function RecuperarInformacionFidelizacionEmpleadoTurno(ByVal Usuario As String, ByVal Clave As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionFidelizacionEmpleadoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Usuario", DbType.String, Usuario)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Function RecuperarInformacionFidelizacionEmpleadoTurno(ByVal Usuario As String, ByVal Clave As String, ByVal idEstacion As Int16) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionFidelizacionEmpleadoTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Usuario", DbType.String, Usuario)
        DB.AddInParameter(DatabaseCommand, "Clave", DbType.String, Clave)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int16, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region


#Region "Canastilla FullStation"
    Public Function ValidarVentasCanastillaenIsla(ByVal Codigo As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVentasCanastillaenIsla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.Int32, Codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarTurnoAbiertoVentaCanastilla(ByVal IdIsla As Integer, ByVal IdEmpleado As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTurnoAbiertoVentaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.String, IdEmpleado)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.String, IdIsla)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region

#Region "Ajustes por Notas credito desde HO"
    Public Sub RealizarAjustesInventarioPorNotaCredito(ByVal idManguera As Int16, ByVal codigoProducto As Int32, ByVal cantidad As Decimal, ByVal EsAjusteAlta As Boolean, ByVal EsAjusteCanastilla As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RealizarAjustesInventarioPorNotaCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int16, idManguera)
        DB.AddInParameter(DatabaseCommand, "CodProducto", DbType.Int32, codigoProducto)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)
        DB.AddInParameter(DatabaseCommand, "EsAjusteAlta", DbType.Boolean, EsAjusteAlta)
        DB.AddInParameter(DatabaseCommand, "EsAjusteCanastilla", DbType.Boolean, EsAjusteCanastilla)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
#End Region
#Region "Fomplus"

    Public Sub RegistrarInventarioProductoFomplus(ByVal codigoProductoContable As String, ByVal tipoMovimientoContable As String, ByVal numeroPedido As String, ByVal cantidad As Decimal)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RegistrarInventarioProductoFomplus"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CodProductoContable", DbType.String, codigoProductoContable)
        DB.AddInParameter(DatabaseCommand, "CodTipoMovimientoContable", DbType.String, tipoMovimientoContable)
        DB.AddInParameter(DatabaseCommand, "NroPedido", DbType.String, numeroPedido)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, cantidad)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

    End Sub

    Public Function InsertarOrdenPedido(ByVal Cedula As String, ByVal Observaciones As String, ByVal Fecha As String, ByVal Items As System.Collections.Generic.Dictionary(Of Int32, String)) As Int64

        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarOrdenPedido"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Dim Transaccion As System.Data.Common.DbTransaction = Nothing


        DB.AddInParameter(DatabaseCommand, "CedulaEmpleado", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "Observaciones", DbType.String, Observaciones)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.String, Fecha)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Transaccion = connection.BeginTransaction

            Try

                Dim IdOrden As Int64
                'Ejecuta el Procedimiento Almacenado
                IdOrden = CLng(DB.ExecuteScalar(DatabaseCommand))

                DatabaseCommand.CommandText = "InsertarOrdenPedidoDetalle"

                DatabaseCommand.Parameters.Clear()

                DB.AddInParameter(DatabaseCommand, "IdOrden", DbType.Int64)
                DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32)
                DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Int32)



                For Each oItem As String In Items.Values
                    Dim Posiciones() As String = oItem.Split(CChar("|"))

                    DB.SetParameterValue(DatabaseCommand, "IdOrden", IdOrden)
                    DB.SetParameterValue(DatabaseCommand, "IdProducto", CLng(Posiciones(0)))
                    DB.SetParameterValue(DatabaseCommand, "Cantidad", CLng(Posiciones(1)))

                    'Ejecuta el procedimiento Almacenado InsertarPagoExtraordinarioMedioPago
                    DB.ExecuteNonQuery(DatabaseCommand)
                Next

                'Hacemos el Commit
                Transaccion.Commit()

                Return IdOrden
            Catch
                'Si se presenta algn error se hace Rollback
                If Not Transaccion Is Nothing Then
                    Transaccion.Rollback()
                End If
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


#End Region

#Region "Nuevos metodos multiestacion"
    Public Sub ActualizarSincronizacion(ByVal tabla As String, ByVal valor As String, ByVal CDC As Integer, ByVal idEstacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "ActualizarSincronizacion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Tabla", DbType.String, tabla)
                DB.AddInParameter(DatabaseCommand, "Valor", DbType.String, valor)
                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarInformacionVentaComunicadorTerpel(ByVal recibo As Int64, ByVal esVentaRegistrada As Boolean, ByVal idEstacion As Int32) As InformacionVenta
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosRecibo As IDataReader = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaComunicador"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "EsVentaRegistrada", DbType.Boolean, esVentaRegistrada)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                DatosRecibo = DB.ExecuteReader(DatabaseCommand)
                If DatosRecibo.Read Then
                    Dim oInfo As New InformacionVenta
                    oInfo.IdFormaPago = CShort(DatosRecibo("IdFormaPago"))
                    oInfo.IdProducto = CShort(DatosRecibo("IdProducto"))
                    oInfo.Placa = DatosRecibo("Placa").ToString
                    oInfo.IdClienteCDC = CInt(DatosRecibo("IdClienteCDC"))
                    oInfo.IdCliente = DatosRecibo("IdCliente").ToString
                    oInfo.CodEstacion = DatosRecibo("CodEstacion").ToString
                    oInfo.Recibo = CLng(DatosRecibo("Recibo"))
                    oInfo.FechaTurno = DatosRecibo("FechaTurno").ToString
                    oInfo.Fecha = DatosRecibo("Fecha").ToString
                    oInfo.Hora = DatosRecibo("Hora").ToString
                    oInfo.IdTurno = CInt(DatosRecibo("IdTurno").ToString)
                    oInfo.HoraInicio = DatosRecibo("HoraInicio").ToString
                    oInfo.HoraFin = DatosRecibo("HoraFin").ToString
                    oInfo.LecturaInicial = DatosRecibo("LecturaInicial").ToString
                    oInfo.LecturaFinal = DatosRecibo("LecturaFinal").ToString
                    oInfo.Total = CStr(DatosRecibo("Total").ToString)
                    oInfo.Valor = CStr(DatosRecibo("Valor").ToString)
                    oInfo.AbonoCredito = CStr(DatosRecibo("AbonoCredito").ToString)
                    oInfo.Cantidad = DatosRecibo("Cantidad").ToString
                    oInfo.Precio = DatosRecibo("Precio").ToString
                    oInfo.Isla = CShort(DatosRecibo("Isla"))
                    oInfo.Manguera = CShort(DatosRecibo("Manguera"))
                    oInfo.Descuento = DatosRecibo("Descuento").ToString()
                    oInfo.Manejo = CDec(DatosRecibo("Manejo"))
                    oInfo.Surtidor = CShort(DatosRecibo("IdSurtidor"))
                    oInfo.Guid = DatosRecibo("GuidVenta").ToString()
                    oInfo.Rom = DatosRecibo("Rom").ToString()
                    oInfo.Cedula = DatosRecibo("Cedula").ToString()
                    oInfo.Iva = DatosRecibo("Iva").ToString
                    oInfo.PresionLLenado = CDec(DatosRecibo("PresionLLenado").ToString)
                    oInfo.NroAutorizacionCheque = DatosRecibo("NroAutorizacionCheque").ToString
                    oInfo.NroAutorizacionCHEQUECDC = CInt(DatosRecibo("NroAutorizacionChequeCDC"))
                    oInfo.EsVentaRecuperada = CBool(DatosRecibo("EsRecuperada"))
                    oInfo.IdTipoVehiculoCDC = CInt(DatosRecibo("IdTipoVehiculoCDC"))
                    oInfo.ValorSobreTasa = CDec(DatosRecibo("ValorSobreTasa"))
                    oInfo.PorcentajeSobreTasa = CDec(DatosRecibo("SobreTasa"))
                    oInfo.NumeroTurno = CInt(DatosRecibo("NumeroTurno"))
                    oInfo.Kilometraje = CStr(DatosRecibo("Kilometraje"))
                    oInfo.Iva = CStr(DatosRecibo("Iva"))

                    If Not DatosRecibo("NroTarjeta") Is System.DBNull.Value Then
                        oInfo.NroTarjeta = DatosRecibo("NroTarjeta").ToString
                        oInfo.TipoLectura = CInt(DatosRecibo("TipoLectura"))
                        If Not DatosRecibo("NroSeguridad") Is System.DBNull.Value Then
                            oInfo.NroSeguridad = DatosRecibo("NroSeguridad").ToString
                        Else
                            oInfo.NroSeguridad = "0"
                        End If
                    Else
                        oInfo.NroTarjeta = String.Empty
                    End If

                    If Not DatosRecibo("CodTanque") Is System.DBNull.Value Then
                        oInfo.CodTanque = DatosRecibo("CodTanque").ToString
                    End If

                    DatosRecibo.Close()
                    connection.Close()
                    Return oInfo
                Else
                    DatosRecibo.Close()
                End If
            Catch ex As Exception
                If Not DatosRecibo Is Nothing Then
                    If Not DatosRecibo.IsClosed Then
                        DatosRecibo.Close()
                        DatosRecibo = Nothing
                    End If
                End If

                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoCheque(ByVal idEstacion As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoCheque"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarInformacionCheque(ByVal IdCheque As Long, ByVal idEstacion As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInformacionCheque"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCheque", DbType.Int64, IdCheque)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarInformacionPago(ByVal pago As Int32, ByVal idEstacion As Int32) As InformacionPago
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Dim SqlCommand As String = "RecuperarPagoExtraOrdinario"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Pago", DbType.Int32, pago)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Dim DatosPago As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If DatosPago.Read Then
                    Dim oInfo As New InformacionPago
                    oInfo.FechaTurno = DatosPago("FechaTurno").ToString
                    oInfo.Fecha = DatosPago("Fecha").ToString
                    oInfo.IdTurno = CInt(DatosPago("IdTurno").ToString)
                    oInfo.Codigo = DatosPago("Codigo").ToString
                    oInfo.Placa = DatosPago("Placa").ToString
                    oInfo.Valor = DatosPago("Valor").ToString
                    oInfo.CodEstacion = DatosPago("CodEstacion").ToString
                    oInfo.GUIDPago = DatosPago("GUIDPago").ToString
                    oInfo.CedulaEmpleado = DatosPago("Cedula").ToString
                    oInfo.EsAnulado = Convert.ToBoolean(DatosPago("EsAnulado"))
                    oInfo.EstadoPagoExtraordinario = Convert.ToByte(DatosPago("Estado"))

                    If DatosPago("IdCredito") Is System.DBNull.Value Then
                        oInfo.IdCredito = String.Empty
                    Else
                        oInfo.IdCredito = DatosPago("IdCredito").ToString
                    End If

                    DatosPago.Close()
                    connection.Close()
                    Return oInfo
                End If
                DatosPago.Close()
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoPagoExtraordinario(ByVal idEstacion As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoPagoExtraordinario"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarUltimaReversion(ByVal CDC As Int32, ByVal idEstacion As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimaReversion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Integer

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using

        Return Resultado
    End Function

    Function RecuperarInformacionReversion(ByVal recibo As Int64, ByVal idEstacion As Int32) As InformacionReversion
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarReversion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                Dim DatosReversion As IDataReader = DB.ExecuteReader(DatabaseCommand)

                If DatosReversion.Read Then
                    Dim oInfo As New InformacionReversion
                    oInfo.CodEstacion = DatosReversion("CodEstacion").ToString
                    oInfo.FechaTurno = DatosReversion("FechaTurno").ToString()
                    oInfo.FechaAbono = DatosReversion("FechaAbono").ToString()
                    oInfo.Recibo = CInt(DatosReversion("Recibo"))
                    oInfo.IdTurno = CInt(DatosReversion("IdTurno"))
                    oInfo.Codigo = DatosReversion("Codigo").ToString
                    oInfo.Valor = DatosReversion("Valor").ToString
                    oInfo.GuidVenta = DatosReversion("GuidVenta").ToString
                    oInfo.CedulaEmpleado = DatosReversion("Cedula").ToString
                    DatosReversion.Close()
                    connection.Close()
                    Return oInfo
                End If
                DatosReversion.Close()
            Catch
                Throw
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoGerenciamiento(ByVal idEstacion As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try

                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoGerenciamiento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarInformacionGerenciamientoTerpel(ByVal idGerenciamiento As Long, ByVal idEstacion As Int32) As InformacionGerenciamiento
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim DatosNotificacion As IDataReader = Nothing
        Dim oInfo As InformacionGerenciamiento = Nothing

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarVentaGerenciamiento"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdGerenciamiento", DbType.Int64, idGerenciamiento)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                DatosNotificacion = DB.ExecuteReader(DatabaseCommand)

                If DatosNotificacion.Read Then
                    oInfo = New InformacionGerenciamiento
                    oInfo.GUID = DatosNotificacion.Item("GUIDVenta").ToString
                    oInfo.Recibo = CLng(DatosNotificacion.Item("Recibo"))
                    oInfo.Valor = CDec(DatosNotificacion.Item("Valor"))
                    oInfo.CodEstacion = DatosNotificacion.Item("CodEstacion").ToString
                    oInfo.Autorizacion = CInt(DatosNotificacion.Item("Autorizacion"))
                    oInfo.CodigoContrato = DatosNotificacion.Item("CodigoContrato").ToString
                    oInfo.EsAutorizacionLocal = CBool(DatosNotificacion.Item("EsAutorizacionLocal").ToString)
                    oInfo.PosicionContrato = DatosNotificacion.Item("PosicionContrato").ToString
                    oInfo.Placa = DatosNotificacion.Item("Placa").ToString
                    oInfo.Kilometraje = CStr(DatosNotificacion.Item("Kilometraje"))
                    oInfo.EsCanastilla = CBool(DatosNotificacion.Item("EsCanastilla"))

                    If (Not DatosNotificacion.Item("IdExtraCupo") Is System.DBNull.Value) And oInfo.EsAutorizacionLocal Then
                        oInfo.IdExtraCupo = CInt(DatosNotificacion.Item("IdExtraCupo"))
                    Else
                        oInfo.IdExtraCupo = Nothing
                    End If

                    oInfo.EsSobreGiro = CBool(DatosNotificacion.Item("EsSobreGiro"))

                    DatosNotificacion.Close()
                    'connection.Close()
                Else
                    DatosNotificacion.Close()
                End If
                Return oInfo
            Catch ex As Exception
                If Not DatosNotificacion Is Nothing Then
                    If Not DatosNotificacion.IsClosed Then
                        DatosNotificacion.Close()
                        DatosNotificacion = Nothing
                    End If
                End If
                Throw 
            Finally
                If Not connection Is Nothing Then
                    connection.Close()
                End If
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoIdModificacion(ByVal idEstacion As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoIdModificacion"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarReciboPorIdModificacionVenta(ByVal IdModificacion As Int32, ByVal idEstacion As Int32) As Int64
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarReciboPorIdModificacionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim Resultado As Int64

        DB.AddInParameter(DatabaseCommand, "IdModificacion", DbType.Int32, IdModificacion)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Resultado = CLng(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Function RecuperarVentaFormaPago(ByVal recibo As Int64, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarGUID(ByVal recibo As Int64, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarGUID"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarRastroCDC(ByVal identificador As Int64, ByVal tipoIdentificador As Char, ByVal falla As String, ByVal idEstacion As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarRastroCDC"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificador", DbType.Int64, identificador)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificador", DbType.String, tipoIdentificador)
        DB.AddInParameter(DatabaseCommand, "Falla", DbType.String, falla)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarVentasCanastillaModificadas(ByVal CDC As Int32, ByVal idEstacion As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentasCanastillaModificadas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarGUIDCanastilla(ByVal recibo As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarGUIDCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarVentaCanastillaFormaPago(ByVal recibo As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarVentaCanastillaFormaPago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, recibo)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimaLectura(ByVal CDC As Int32, ByVal idEstacion As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimaLectura"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "CDC", DbType.Int32, CDC)
                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function TieneStocksTurnoHorario(ByVal IdTurno As Int32, ByVal idEstacion As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "TieneStocksTurnoHorario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function FinalizoConsignacionesSobres(ByVal IdTurno As Int32, ByVal idEstacion As Int32) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "FinalizoConsignacionesSobres"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarProductosPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarProductosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarLecturasPorMangueraTurno(ByVal idTurno As Int32, ByVal idManguera As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLecturasPorMangueraTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdManguera", DbType.Int32, idManguera)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCambiosChequeEnTurno(ByVal idTurno As Int32, ByVal idEstacion As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCambiosChequeEnTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimasVariablesMedicionTurno(ByVal idTurno As Int32, ByVal idEstacion As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarUltimasVariablesMedicionTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarStockTurno(ByVal idTurno As Int32, ByVal idEstacion As Int32) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarStockTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch Ex As Exception
                Throw 
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesTurnoFormaPagoProducto(ByVal idTurno As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesTurnoFormaPagoProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesMediosPagoTurnoTerpel(ByVal idTurno As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesMediosPagoPorTurnoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesTurnoFormaPagoProductoCanastilla(ByVal idTurno As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesTurnoFormaPagoProductoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesComplementariosPorTurno(ByVal idTurno As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesComplementariosPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarUltimoTurnoTrabajo(ByVal idEstacion As Int32) As Int32
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim Resultado As Integer

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarUltimoTurnoTrabajo"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

                'Ejecuta el Procedimiento Almacenado
                Resultado = CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
        Return Resultado
    End Function

    Public Function RecuperarTotalesTurnoTrabajoFormaPagoProducto(ByVal idTurno As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesTurnoTrabajoFormaPagoProducto"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTotalesMediosPagoTurnoTrabajoTerpel(ByVal idTurno As Int32, ByVal idEstacion As Int32) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTotalesMediosPagoTurnoTrabajoTerpel"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)
        DB.AddInParameter(DatabaseCommand, "IdEstacion", DbType.Int32, idEstacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
#End Region


    Public Function RecuperarTurnosConSaltodeLectura(ByVal Fecha As Date) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarTurnosConSaltodeLectura"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarMediosPagosVentasFueradeSistemas() As DataTable
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarMediosPagosVentasFueradeSistemas"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function








    Public Sub RecuperarsaldoDisponiblePorNitYPlaca(ByVal Nit As String, ByVal Placa As String)
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarsaldoDisponiblePorNitYPlaca"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)
                DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub GuardarClienteCleque(ByVal Nuip As String, ByVal Monto As Decimal, ByVal Porcentaje As Decimal)
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "GuardarClienteCleque"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, Nuip)
                DB.AddInParameter(DatabaseCommand, "Monto", DbType.Decimal, Monto)
                DB.AddInParameter(DatabaseCommand, "Porcentaje", DbType.Decimal, Porcentaje)

                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarFormaPagoPorNumeroCredito(ByVal Credito As String) As Integer
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarFormaPagoPorNumeroCredito"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


                DB.AddInParameter(DatabaseCommand, "Credito", DbType.String, Credito)

                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function






    Function RecuperarFormaPagoPorPlaca(ByVal Placa As String) As Integer
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarFormaPagoPorPlaca"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


                DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Function RecuperarFormaPagoPorId(ByVal IdFormaPago As Int16) As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Crea un sqlComand a partir del nombre del procedimiento almacenado
                Dim SqlCommand As String = "RecuperarFormaPagoPorId"
                Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

                DB.AddInParameter(DatabaseCommand, "IdFormaPago", DbType.Int16, IdFormaPago)

                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub InsertarVentaEnKardex(ByVal Recibo As Double)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVentaEnKardex"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Double, Recibo)
        DatabaseCommand.CommandTimeout = 300
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Function RecuperarCopiasPorFormaCanastilla(ByVal recibo As Long) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCopiasPorFormaCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, recibo)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIdTarjetaPorNumero(ByVal tarjeta As String) As Integer
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdTarjetaPorNumero"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, tarjeta)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ValidarTarjetaCosumoEnCredito(ByVal IdTarjeta As Integer) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarTarjetaCosumoEnCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTarjeta", DbType.Int32, IdTarjeta)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ValidarSiVehiculoEsCredito(ByVal Rom As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiVehiculoEsCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ValidarSiVehiculoTieneCredito(ByVal Rom As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiVehiculoTieneCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ValidarSiVehiculoEsCreditoGerenciado(ByVal Rom As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiVehiculoEsCreditoGerenciado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ValidarSiVehiculoEsCreditoGerenciadoPorTarjeta(ByVal tarjeta As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiVehiculoEsCreditoGerenciadoPorTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tarjeta", DbType.String, tarjeta)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarSiguiente(ByVal Menu As Int16, ByVal Seleccion As Int16) As Siguiente
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("DTIConexcion")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSiguienteMenu"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim result As New Siguiente

        DB.AddInParameter(DatabaseCommand, "IdMenu", DbType.Int32, Menu)
        DB.AddInParameter(DatabaseCommand, "Seleccion", DbType.Int32, Seleccion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oReader As IDataReader = DB.ExecuteReader(DatabaseCommand)

                While oReader.Read()
                    result.Menu = CShort(oReader("NuevoMenu"))
                    result.EsMenu = CBool(oReader("EsMenu"))
                    result.Comando = CStr(oReader("Comando"))
                End While
                oReader.Close()
                Return result
            Catch Ex As Exception
                'LogIt.Loguear(ex
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function ExisteMenu(ByVal Menu As Int16, ByVal Seleccion As Int16) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("DTIConexcion")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ExisteMenu"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim result As New Siguiente

        DB.AddInParameter(DatabaseCommand, "IdMenu", DbType.Int32, Menu)
        DB.AddInParameter(DatabaseCommand, "Seleccion", DbType.Int32, Seleccion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch Ex As Exception
                'LogIt.Loguear(ex
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarLimitesMenu(ByVal Menu As Int16) As LimiteMenu
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("DTIConexcion")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarLimitesMenu"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        Dim result As New LimiteMenu

        DB.AddInParameter(DatabaseCommand, "IdMenu", DbType.Int32, Menu)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Dim oReader As IDataReader = DB.ExecuteReader(DatabaseCommand)
                While oReader.Read()
                    result.Desde = CInt(oReader("Desde").ToString)
                    result.Hasta = CInt(oReader("Hasta").ToString)
                End While
                oReader.Close()
                Return result
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarPaginas() As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("DTIConexcion")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPaginas"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarComandoPorOpcion(ByVal IdMenu As Int32, ByVal Opcion As Int32) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("DTIConexcion")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarComandoPorOpcionDigitada"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "OpcionDigitada", DbType.Int32, Opcion)
        DB.AddInParameter(DatabaseCommand, "UltimoMenuDigitado", DbType.Int32, IdMenu)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarIdMenuPrincipal() As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase("DTIConexcion")
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdMenuPrincipal"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand).ToString)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarFinanciera(ByVal Nombre As String, ByVal IdFinanciera As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "IdFinanciera", DbType.Int32, IdFinanciera)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub InsertarFinanciera(ByVal Nombre As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Nombre)
     

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Sub InsertarBanco(ByVal Nombre As String, ByVal Codigo As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarBanco"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Descripcion", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, Codigo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarDatoEntidadBancaria(ByVal EsFinaciera As Boolean) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatoEntidadBancaria"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "EsFinanciera", DbType.Boolean, EsFinaciera)
       

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Function RecuperarSaldosIsleros() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSaldosIsleros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub RealizarAbonoIsleros(ByVal IdIsleros As Integer, ByVal Abono As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RealizarAbonoIsleros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIslero", DbType.Int32, IdIsleros)
        DB.AddInParameter(DatabaseCommand, "Abono", DbType.Decimal, Abono)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarHistoricoSaldoIsleros(ByVal IdIslero As Int32) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHistoricoSaldoIsleros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIslero", DbType.Int32, IdIslero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarHistoricoSaldoIsleros(ByVal IdIslero As Int32, ByVal FechaIni As DateTime, ByVal FechaFin As DateTime) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarHistoricoSaldoIsleros"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdIslero", DbType.Int32, IdIslero)
        DB.AddInParameter(DatabaseCommand, "FechaInicio", DbType.DateTime, FechaIni)
        DB.AddInParameter(DatabaseCommand, "FechaFin", DbType.DateTime, FechaFin)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarIdturnoPorRecibo(ByVal Recibo As Integer) As Integer
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIdturnoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarDatosdeVentaPorRecibo(ByVal Recibo As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosdeVentaPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarFomaPagoTarjeta() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFormaPagoTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarFranquicias(ByVal TipoBusqueda As Integer) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFranquicias"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TodasFraquicias", DbType.Int32, TipoBusqueda)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Sub InsertarFranquicia(ByVal IdFranquicia As Integer, ByVal descripcion As String, ByVal idFormaPago As Short)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFranquicia"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdFranquicia", DbType.Int32, IdFranquicia)
        DB.AddInParameter(DatabaseCommand, "descripcion", DbType.String, descripcion)
        DB.AddInParameter(DatabaseCommand, "idFormaPago", DbType.Int16, idFormaPago)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Function ValidarCantidadEnDocumentoCombustible(ByVal Documento As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarCantidadEnDocumentoCombustible"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "Documento", DbType.String, Documento)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarProveedorPorNit(ByVal Nit As String)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarProveedorPorNit"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nit", DbType.String, Nit)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Sub InsertarLogeo(ByVal Cedula As String, ByVal tanque As String, ByVal Cantidad As Decimal, ByVal SaldoAnterior As Decimal, ByVal NuevoSaldo As Decimal)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLogueo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cedula", DbType.String, Cedula)
        DB.AddInParameter(DatabaseCommand, "Tanque", DbType.String, tanque)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "SaldoAnterior", DbType.Decimal, SaldoAnterior)
        DB.AddInParameter(DatabaseCommand, "NuevoSaldo", DbType.Decimal, NuevoSaldo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch Ex As Exception
                Throw Ex
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarTarjetaConsumoPorNumeroTarjeta(ByVal Numero As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTarjetaConsumoPorNumeroTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Tarjeta", DbType.String, Numero)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarPlacaPorTarjeta(ByVal Tarjeta As String) As String
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaPorTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "NumeroTarjeta", DbType.String, Tarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Sub EliminarBanco(ByVal codigo As String)
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarBanco"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Codigo", DbType.String, codigo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Function RecuperarNombreCliente(ByVal Identificacion As String) As String
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNombreCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Identificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarNombreConductor(ByVal Identificacion As String) As String
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarNombreConductor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Identificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function ValidarNombreCliente(ByVal Identificacion As String) As Boolean
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarNombreCliente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Identificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub EliminarFinanciera(ByVal Nombre As String)
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarFinanciera"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Financiera", DbType.String, Nombre)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function SolicitaKilometraje(ByVal Rom As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SolicitaKilometraje"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Rom", DbType.String, Rom)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function SolicitaKilometrajePlaca(ByVal Placa As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SolicitaKilometrajePorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function SolicitaKilometrajePorTarjeta(ByVal Tarjeta As String) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SolicitaKilometrajePorTarjeta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Tarjeta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ValidarProductoVehiculo(ByVal Numero As String, ByVal IdTipoIdentificacion As Int32, ByVal IdProducto As Int32)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarProductoVehiculo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)
        DB.AddInParameter(DatabaseCommand, "TipoIdentificacion", DbType.Int32, IdTipoIdentificacion)
        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

#Region "Crditos activos"
    Public Function RecuperarClientesCreditosActivos() As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlCommand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClientesCreditosActivos"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function InsertarClientesCreditosActivosFlota(ByVal Placa As String, ByVal IdCliente As Integer) As Integer
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarAutorizacionVentaClienteFlota"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                '                Return DB.ExecuteNonQuery(DatabaseCommand)
                Return CInt(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

#End Region

    Sub ValidarAutorizacionCodigoCredito(ByVal Autorizacion As Integer)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarAutorizacionCodigoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.Int32, Autorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarPlacaAutorizacionCodigoCredito(ByVal Autorizacion As Integer) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaAutorizacionCodigoCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.Int32, Autorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarReciboPorCara(ByVal Cara As Short) As Long
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function




    Public Sub ValidarFacturaUltimaVenta(ByVal Cara As Short)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarFacturaUltimaVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub



    Public Sub ValidarLecturasTurnoSurtidor(ByVal Cara As Short)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarLecturasTurnoSurtidor"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Sub ActualizarDatosDocumentoPeru(ByVal Recibo As Integer, ByVal Nombre As String, ByVal Identificacion As String, ByVal Placa As String, ByVal Pais As String, ByVal TipoEnvase As Integer, ByVal Autorizacion As String, ByVal DUI As String)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDatosDocumentoPeru"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Identificacion)
        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Pais ", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "TipoEnvase ", DbType.Int32, TipoEnvase)
        DB.AddInParameter(DatabaseCommand, "Autorizacion ", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "DUI", DbType.String, DUI)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Sub ActualizarClienteGerenciado(ByVal idCliente As Integer, ByVal RUC As String, ByVal RazonSocial As String, ByVal Apellido As String, ByVal IdClienteEstacion As Integer, ByVal idTipoDocumentoCliente As Integer)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarClienteGerenciado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "idCliente", DbType.Int32, idCliente)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "Apellido", DbType.String, Apellido)
        DB.AddInParameter(DatabaseCommand, "IdClienteEstacion ", DbType.Int32, IdClienteEstacion)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumentoCliente", DbType.Int32, idTipoDocumentoCliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarPaisPorCodigo(ByVal IdPais As Integer) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPaisPorCodigo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdPais", DbType.Int32, IdPais)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Function RecuperarListaPaises() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarListaPaises"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return (DB.ExecuteReader(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function SolicitaLectura(ByVal IdProducto As Integer) As Boolean
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "SolicitaLectura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.Int32, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Function DevolucionDocumentoCanastilla(ByVal Recibo As Integer) As Integer
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "DevolucionDocumentoCanastilla"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CInt(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Sub ValidarAutorizacionVentaTalonario(ByVal Placa As String, ByVal Ruc As String, ByVal Talonario As String)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarAutorizacionVentaTalonario"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "Ruc", DbType.String, Ruc)
        DB.AddInParameter(DatabaseCommand, "Talonario", DbType.String, Talonario)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

Function RecuperarTasasCambioVenta() As Decimal 
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTasasCambioVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

       
        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CDec(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
 End Function 

    Function RecuperarConsignaciondeSobresTurnoDolares(ByVal Turno As Long, ByVal IdTipoTurno As Short) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsignaciondeSobresDolares"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, Turno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarSobranteFaltanteMonedaExtranjeraTurno(ByVal IdTurno As Integer, ByVal IdTipoTurno As Short) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarSobranteFaltanteMonedaExtranjeraTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Function RecuperarInventarioCanastillaPorTurno(ByVal Turno As Integer, Isla As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarInventarioCanastillaPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Turno", DbType.Int32, Turno)
        DB.AddInParameter(DatabaseCommand, "Isla", DbType.Int32, Isla)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarConsignaciondeSobresImpresion(ByVal Turno As Long, ByVal IdTipoTurno As Short) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConsignaciondeSobresImpresion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int64, Turno)
        DB.AddInParameter(DatabaseCommand, "IdTipoTurno", DbType.Int16, IdTipoTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Sub ValidarImpresionVenta(ByVal Recibo As Long)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarImpresionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function ValidarImpresionTurnoPorLote(ByVal Idturno As Integer) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarImpresionTurnoPorLote"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Idturno", DbType.Int64, Idturno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Sub ActualizarTurnoImpreso(ByVal IdTurno As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTurnoImpreso"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Sub InsertarLLaveCodigoVerificacion(ByVal Llave As String, ByVal FechaInicial As Date, ByVal FechaFinal As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarLLaveCodigoVerificacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Llave", DbType.String, Llave)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub




    Sub ActualizarLLaveCodigoVerificacion(ByVal IdLLave As Integer, ByVal Llave As String, ByVal FechaInicial As Date, ByVal FechaFinal As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarLLaveCodigoVerificacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Llave", DbType.String, Llave)
        DB.AddInParameter(DatabaseCommand, "FechaInicial", DbType.DateTime, FechaInicial)
        DB.AddInParameter(DatabaseCommand, "FechaFinal", DbType.DateTime, FechaFinal)
        DB.AddInParameter(DatabaseCommand, "IdLlave", DbType.Int32, IdLLave)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarFidelizacionManual(ByVal Recibo As Int64, ByVal Numero As String, ByVal Valor As Decimal, ByVal Cantidad As Decimal, ByVal Idturno As Integer, ByVal Empleado As String, ByVal FechaVenta As Date)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFidelizacionManual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)
        DB.AddInParameter(DatabaseCommand, "Valor", DbType.Decimal, Valor)
        DB.AddInParameter(DatabaseCommand, "Cantidad", DbType.Decimal, Cantidad)
        DB.AddInParameter(DatabaseCommand, "Idturno", DbType.Int32, Idturno)
        DB.AddInParameter(DatabaseCommand, "Empleado", DbType.String, Empleado)
        DB.AddInParameter(DatabaseCommand, "FechaVenta", DbType.DateTime, FechaVenta)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarTipoEmpleado(ByVal TipoEmpleado As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarTipoEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoEmpleado", DbType.String, TipoEmpleado)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ActualizarTipoEmpleado(ByVal TipoEmpleado As String, ByVal IdEmpleado As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarTipoEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoEmpleado", DbType.String, TipoEmpleado)
        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarTipoEmpleado(ByVal TipoEmpleado As String) As DataTable
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTipoEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "TipoEmpleado", DbType.String, TipoEmpleado)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function



    Public Function RecuperarTipoImpresora() As DataTable

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarTipoImpresora"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                Return DB.ExecuteDataSet(DatabaseCommand).Tables(0)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Sub EliminarTipoEmpleado(ByVal IdEmpleado As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "EliminarTipoEmpleado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdEmpleado", DbType.Int32, IdEmpleado)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarConductorPorPlaca(ByVal Placa As String) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarConductorPorPlaca"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ValidarAutorizacionVentasPorCara(ByVal Cara As Short) As Boolean
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarAutorizacionVentasPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CBool(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarDatosAutorizacionVenta(ByVal Cara As Short) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarDatosAutorizacionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ValidarSiCaraManejaLectorUsb(ByVal Cara As Short) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarSiCaraManejaLectorUsb"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "Cara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarCodigoPCCSurtidorPorCara(ByVal Cara As Short) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoPCCSurtidorPorCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)


        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.Int16, Cara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch Ex As Exception
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarIslasImpresoraPrepago() As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarIslasImpresoraPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarIslaImpresoraPrepago(ByVal IdDispositivo As Nullable(Of Int32), ByVal IdIsla As Int32, ByVal IdImpresora As Int32, ByVal IdPuerto As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarIslaImpresoraPrepago"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdDispositivo", DbType.Int32, IdDispositivo)
        DB.AddInParameter(DatabaseCommand, "IdIsla", DbType.Int32, IdIsla)
        DB.AddInParameter(DatabaseCommand, "IdImpresora", DbType.Int32, IdImpresora)
        DB.AddInParameter(DatabaseCommand, "IdPuerto", DbType.Int32, IdPuerto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()
            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarPuertoImpresoraPrepagoPorRecibo(ByVal Recibo As String) As String
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPuertoImpresoraPrepagoPorRecibo"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.String, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub ActualizarNumeroDeImpresionesEnVenta(ByVal Recibo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarNumeroDeImpresionesEnVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub


    Public Sub ValidarNumeroDeImpresionesEnVenta(ByVal Recibo As Int32)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarNumeroDeImpresionesEnVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub ValidarVigenciaAutorizacionEstacion()
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarVigenciaAutorizacionEstacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarReciboPorNumeroCara(ByVal Consecutivo As String, ByVal Prefijo As String, ByVal Autorizacion As String) As Int64
        ' Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarReciboPorNumeroCara"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Consecutivo)
        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CLng(DB.ExecuteScalar(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub ActualizarDatosDelClienteEnFactura(ByVal Recibo As Int32, ByVal IdCliente As Int32, ByVal NumeroDePlaca As String, ByVal Identificacion As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDatosDelClienteEnFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int32, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)
        DB.AddInParameter(DatabaseCommand, "NumeroDePlaca", DbType.String, NumeroDePlaca)
        DB.AddInParameter(DatabaseCommand, "Identificacion", DbType.String, Identificacion)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)


            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Function RecuperarClienteEnFacturaDeVenta(ByVal Recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarClienteEnFacturaDeVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarPlacaEnFacturaDeVenta(ByVal Recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarPlacaEnFacturaDeVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub InsertarFacturaManual(ByVal Prefijo As String, ByVal Numero As String, ByVal SerialImpresora As String, ByVal Recibo As Int64, ByVal RucCliente As String, _
                                     ByVal EsAnulado As Boolean, ByVal IdFacturaManual As String, ByVal Pais As String, ByVal NumeroPlaca As String, ByVal Nombre As String, _
                                     ByVal Autorizacion As String, ByVal NroModificaciones As Integer, ByVal IdAutorizacionEstacion As Integer, ByVal Dui As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaManual"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Prefijo", DbType.String, Prefijo)
        DB.AddInParameter(DatabaseCommand, "Numero", DbType.String, Numero)
        DB.AddInParameter(DatabaseCommand, "SerialImpresora", DbType.String, SerialImpresora)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "RucCliente", DbType.String, RucCliente)
        DB.AddInParameter(DatabaseCommand, "EsAnulado", DbType.Boolean, EsAnulado)
        DB.AddInParameter(DatabaseCommand, "IdFacturaManual", DbType.String, IdFacturaManual)
        DB.AddInParameter(DatabaseCommand, "Pais", DbType.String, Pais)
        DB.AddInParameter(DatabaseCommand, "NumeroPlaca", DbType.String, NumeroPlaca)
        DB.AddInParameter(DatabaseCommand, "Nombre", DbType.String, Nombre)
        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        DB.AddInParameter(DatabaseCommand, "NroModificaciones", DbType.Int32, NroModificaciones)
        DB.AddInParameter(DatabaseCommand, "IdAutorizacionEstacion", DbType.Int32, IdAutorizacionEstacion)
        DB.AddInParameter(DatabaseCommand, "Dui", DbType.String, Dui)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarDatosDeFactura(ByVal Recibo As Int64) As IDataReader

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarDatosDeFactura"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub InsertarClienteFullStation(ByVal IdCliente As Integer, ByVal RazonSocial As String, ByVal RUC As String, IdClienteEstacion As Int32, _
                                          Apellido As String, IdTipoDocumento As Integer)


        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarClienteFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)
        DB.AddInParameter(DatabaseCommand, "RazonSocial", DbType.String, RazonSocial)
        DB.AddInParameter(DatabaseCommand, "RUC", DbType.String, RUC)
        DB.AddInParameter(DatabaseCommand, "IdClienteEstacion", DbType.Int32, IdClienteEstacion)
        DB.AddInParameter(DatabaseCommand, "Apellido", DbType.String, Apellido)
        DB.AddInParameter(DatabaseCommand, "IdTipoDocumento", DbType.Int32, IdTipoDocumento)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Sub InsertarVehiculoFullStation(ByVal Placa As String, ByVal IdVehiculoLocal As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarVehiculoFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.String, Placa)
        DB.AddInParameter(DatabaseCommand, "IdVehiculoLocal", DbType.String, IdVehiculoLocal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarClienteFullStation(ByVal Placa As String, ByVal IdCliente As String)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = " ActualizarClienteFullStation"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Placa", DbType.Int32, Placa)
        DB.AddInParameter(DatabaseCommand, "IdCliente", DbType.Int32, IdCliente)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)


            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Function ActualizarClienteEnFacturaDeVenta(ByVal Recibo As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarClienteEnFacturaDeVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function ActualizarDatosDelVehiculoGerenciado(ByVal Recibo As Int64, ByVal IdVehiculo As Int64, ByVal IdVehiculoLocal As Int64) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarDatosDelVehiculoGerenciado"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "IdVehiculo", DbType.Int64, IdVehiculo)
        DB.AddInParameter(DatabaseCommand, "IdVehiculoLocal", DbType.Int64, IdVehiculoLocal)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Function RecuperarFacturaPendientesPorEnviar() As IDataReader
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarFacturaPendientesPorEnviar"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return (DB.ExecuteReader(DatabaseCommand))

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function
    Public Sub InsertarFacturaPendiente(ByVal Recibo As Int64, ByVal Fecha As DateTime, ByVal EsEnviado As Boolean)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "InsertarFacturaPendiente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)
        DB.AddInParameter(DatabaseCommand, "Fecha", DbType.DateTime, Fecha)
        DB.AddInParameter(DatabaseCommand, "EsEnviado", DbType.Boolean, EsEnviado)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Sub ActualizarFacturaPendiente(ByVal EsEnviado As Boolean, ByVal Recibo As Int64)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ActualizarFacturaPendiente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "EsEnviado", DbType.Boolean, EsEnviado)
        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)



        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)


            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub
    Public Function RecuperarFacturaPendiente(ByVal Recibo As Int64) As IDataReader

        Dim DB As Database = DatabaseFactory.CreateDatabase()
        Dim SqlCommand As String = "RecuperarFacturaPendiente"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Recibo", DbType.Int64, Recibo)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)

            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function


    Public Sub ValidarNumeroAutorizacionVenta(ByVal Autorizacion As String)
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "ValidarNumeroAutorizacionVenta"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Autorizacion", DbType.String, Autorizacion)
        Using connection As DbConnection = DB.CreateConnection()

            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Public Function RecuperarCodigoProductoSatelite(IdProducto As String) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoProductoSatelite"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdProducto", DbType.String, IdProducto)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Function RecuperarCodigoSurtidorSatelite(IdCara As String) As String
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCodigoSurtidorSatelite"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCara", DbType.String, IdCara)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return CStr(DB.ExecuteScalar(DatabaseCommand))
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarCreditosParaRenovacion(ByVal Cliente As String) As DataSet
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarCreditosRenovacion"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "Nuip", DbType.String, Cliente)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteDataSet(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Sub RenovarCredito(ByVal IdCredito As Integer)
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RenovarCredito"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdCredito", DbType.Int32, IdCredito)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                DB.ExecuteNonQuery(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Sub

    Function RecuperarRecargasPrepagoPorTurno(idTurno As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarRecargasPrepagoPorTurno"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)

        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, idTurno)


        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

    Public Function RecuperarTurnoPagoFrecuencias(IdTurno As Integer) As IDataReader
        'Crea el objeto base de datos, esto representa la conexion a la base de datos indicada en el archivo de configuracion
        Dim DB As Database = DatabaseFactory.CreateDatabase()
        'Crea un sqlComand a partir del nombre del procedimiento almacenado
        Dim SqlCommand As String = "RecuperarTurnoPagoFrecuencias"
        Dim DatabaseCommand As DbCommand = DB.GetStoredProcCommand(SqlCommand)
        DB.AddInParameter(DatabaseCommand, "IdTurno", DbType.Int32, IdTurno)

        Using connection As DbConnection = DB.CreateConnection()
            connection.Open()

            Try
                'Ejecuta el Procedimiento Almacenado
                Return DB.ExecuteReader(DatabaseCommand)
            Catch
                Throw
            Finally
                connection.Close()
            End Try
        End Using
    End Function

End Class


Public Class Disposable
    Implements IDisposable

    Private _disposed As Boolean = False

    Public Property Disposed() As Boolean
        Get
            Return _disposed
        End Get
        Set(ByVal value As Boolean)
            _disposed = value
        End Set
    End Property

    Protected Overridable Sub Dispose(ByVal disposing As Boolean)
        If Not Me.Disposed Then
            If disposing Then
                ' Insert code to free unmanaged resources.
            End If
            ' Insert code to free shared resources.
        End If
        Me.Disposed = True
    End Sub

    Public Sub Dispose() Implements IDisposable.Dispose
        Dispose(True)
        GC.SuppressFinalize(Me)
    End Sub

    Protected Overrides Sub Finalize()
        Dispose(False)
        MyBase.Finalize()
    End Sub
End Class

Public Class InformacionRedencionBono
    Inherits Disposable

    Private _CodEstacion As String
    Public Property CodEstacion() As String
        Get
            Return _CodEstacion
        End Get
        Set(ByVal value As String)
            _CodEstacion = value
        End Set
    End Property

    Private _Tarjeta As String
    Public Property Tarjeta() As String
        Get
            Return _Tarjeta
        End Get
        Set(ByVal value As String)
            _Tarjeta = value
        End Set
    End Property

    Private _Recibo As String
    Public Property Recibo() As String
        Get
            Return _Recibo
        End Get
        Set(ByVal value As String)
            _Recibo = value
        End Set
    End Property

    Private _IdAutorizacionFidelizacion As Int64
    Public Property IdAutorizacionFidelizacion() As Int64
        Get
            Return _IdAutorizacionFidelizacion
        End Get
        Set(ByVal value As Int64)
            _IdAutorizacionFidelizacion = value
        End Set
    End Property


    Private _IdRedencionBono As Int64
    Public Property IdRedencionBono() As Int64
        Get
            Return _IdRedencionBono
        End Get
        Set(ByVal value As Int64)
            _IdRedencionBono = value
        End Set
    End Property

    Private _Valor As Decimal
    Public Property Valor() As Decimal
        Get
            Return _Valor
        End Get
        Set(ByVal value As Decimal)
            _Valor = value
        End Set
    End Property


End Class


Public Class InformacionVentaFidelizada
    Inherits Disposable

    Private IdProductoAux As Short
    Public Property IdProducto() As Short
        Get
            Return IdProductoAux
        End Get
        Set(ByVal value As Short)
            IdProductoAux = value
        End Set
    End Property

    Private PlacaAux As String
    Public Property Placa() As String
        Get
            Return PlacaAux
        End Get
        Set(ByVal value As String)
            PlacaAux = value
        End Set
    End Property

    Private CodEstacionAux As String
    Public Property CodEstacion() As String
        Get
            Return CodEstacionAux
        End Get
        Set(ByVal value As String)
            CodEstacionAux = value
        End Set
    End Property

    Private FechaAux As String
    Public Property Fecha() As String
        Get
            Return FechaAux
        End Get
        Set(ByVal value As String)
            FechaAux = value
        End Set
    End Property

    Private TotalAux As String
    Public Property Total() As String
        Get
            Return TotalAux
        End Get
        Set(ByVal value As String)
            TotalAux = value
        End Set
    End Property

    Private CantidadAux As String
    Public Property Cantidad() As String
        Get
            Return CantidadAux
        End Get
        Set(ByVal value As String)
            CantidadAux = value
        End Set
    End Property

    Private TarjetaAux As String
    Public Property Tarjeta() As String
        Get
            Return TarjetaAux
        End Get
        Set(ByVal value As String)
            TarjetaAux = value
        End Set
    End Property


    Private _Rut As String
    Public Property Rut() As String
        Get
            Return _Rut
        End Get
        Set(ByVal value As String)
            _Rut = value
        End Set
    End Property



End Class


Public Class InformacionVentaFidelizadaCanastilla
    Inherits Disposable

    Private IdProductoAux As Short
    Public Property IdProducto() As Short
        Get
            Return IdProductoAux
        End Get
        Set(ByVal value As Short)
            IdProductoAux = value
        End Set
    End Property

    Private PlacaAux As String
    Public Property Placa() As String
        Get
            Return PlacaAux
        End Get
        Set(ByVal value As String)
            PlacaAux = value
        End Set
    End Property

    Private CodEstacionAux As String
    Public Property CodEstacion() As String
        Get
            Return CodEstacionAux
        End Get
        Set(ByVal value As String)
            CodEstacionAux = value
        End Set
    End Property

    Private FechaAux As DateTime
    Public Property Fecha() As DateTime
        Get
            Return FechaAux
        End Get
        Set(ByVal value As DateTime)
            FechaAux = value
        End Set
    End Property

    Private TotalAux As String
    Public Property Total() As String
        Get
            Return TotalAux
        End Get
        Set(ByVal value As String)
            TotalAux = value
        End Set
    End Property

    Private CantidadAux As String
    Public Property Cantidad() As String
        Get
            Return CantidadAux
        End Get
        Set(ByVal value As String)
            CantidadAux = value
        End Set
    End Property

    Private TarjetaAux As String
    Public Property Tarjeta() As String
        Get
            Return TarjetaAux
        End Get
        Set(ByVal value As String)
            TarjetaAux = value
        End Set
    End Property


    Private _Rut As String
    Public Property Rut() As String
        Get
            Return _Rut
        End Get
        Set(ByVal value As String)
            _Rut = value
        End Set
    End Property



End Class


Public Class InformacionRestriccion
    Inherits Disposable

    Private _IdBloqueoRestriccion As Long
    Private _IdCausalBloqueo As Long
    Private _IdVehiculo As Long
    Private _FechaHora As DateTime
    Private _Tope As Long
    Private _Placa As String
    Private _CodEstacion As String

    Public Property IdBloqueoRestriccion() As Long
        Get
            Return _IdBloqueoRestriccion
        End Get
        Set(ByVal value As Long)
            _IdBloqueoRestriccion = value
        End Set
    End Property

    Public Property IdCausalBloqueo() As Long
        Get
            Return _IdCausalBloqueo
        End Get
        Set(ByVal value As Long)
            _IdCausalBloqueo = value
        End Set
    End Property
    Public Property IdVehiculo() As Long
        Get
            Return _IdVehiculo
        End Get
        Set(ByVal value As Long)
            _IdVehiculo = value
        End Set
    End Property
    Public Property FechaHora() As DateTime
        Get
            Return _FechaHora
        End Get
        Set(ByVal value As DateTime)
            _FechaHora = value
        End Set
    End Property
    Public Property Tope() As Long
        Get
            Return _Tope
        End Get
        Set(ByVal value As Long)
            _Tope = value
        End Set
    End Property
    Public Property Placa() As String
        Get
            Return _Placa
        End Get
        Set(ByVal value As String)
            _Placa = value
        End Set
    End Property

    Public Property CodEstacion() As String
        Get
            Return _CodEstacion
        End Get
        Set(ByVal value As String)
            _CodEstacion = value
        End Set
    End Property

End Class

Public Class InformacionGerenciamiento
    Inherits Disposable

    Private _GUID As String
    Private _Autorizacion As Integer
    Private _IdGerenciamiento As Long
    Private _Recibo As Long
    Private _Valor As Decimal
    Private _CodEstacion As String
    Private _EsCanastilla As Boolean
    Private _EsAutorizacionLocal As Boolean
    Private _CodigoContrato As String
    Private _PosicionContrato As String
    Private _Placa As String
    Private _Kilometraje As String
    Private _IdExtraCupo As Nullable(Of Int32)
    Private _EsSobreGiro As Boolean

    Public Property EsSobreGiro() As Boolean
        Get
            Return _EsSobreGiro
        End Get
        Set(ByVal value As Boolean)
            _EsSobreGiro = value
        End Set
    End Property

    Public Property IdExtraCupo() As Nullable(Of Int32)
        Get
            Return _IdExtraCupo
        End Get
        Set(ByVal value As Nullable(Of Int32))
            _IdExtraCupo = value
        End Set
    End Property

    Public Property Kilometraje() As String
        Get
            Return _Kilometraje
        End Get
        Set(ByVal value As String)
            _Kilometraje = value
        End Set
    End Property

    Public Property Placa() As String
        Get
            Return _Placa
        End Get
        Set(ByVal value As String)
            _Placa = value
        End Set
    End Property

    Public Property PosicionContrato() As String
        Get
            Return _PosicionContrato
        End Get
        Set(ByVal value As String)
            _PosicionContrato = value
        End Set
    End Property

    Public Property CodigoContrato() As String
        Get
            Return _CodigoContrato
        End Get
        Set(ByVal value As String)
            _CodigoContrato = value
        End Set
    End Property
    Public Property EsAutorizacionLocal() As Boolean
        Get
            Return _EsAutorizacionLocal
        End Get
        Set(ByVal value As Boolean)
            _EsAutorizacionLocal = value
        End Set
    End Property

    Public Property EsCanastilla() As Boolean
        Get
            Return _EsCanastilla
        End Get
        Set(ByVal value As Boolean)
            _EsCanastilla = value
        End Set
    End Property

    Public Property CodEstacion() As String
        Get
            Return _CodEstacion
        End Get
        Set(ByVal value As String)
            _CodEstacion = value
        End Set
    End Property

    Public Property GUID() As String
        Get
            Return _GUID
        End Get
        Set(ByVal value As String)
            _GUID = value
        End Set
    End Property
    Public Property Autorizacion() As Integer
        Get
            Return _Autorizacion
        End Get
        Set(ByVal value As Integer)
            _Autorizacion = value
        End Set
    End Property
    Public Property IdGerenciamiento() As Long
        Get
            Return _IdGerenciamiento
        End Get
        Set(ByVal value As Long)
            _IdGerenciamiento = value
        End Set
    End Property
    Public Property Recibo() As Long
        Get
            Return _Recibo
        End Get
        Set(ByVal value As Long)
            _Recibo = value
        End Set
    End Property
    Public Property Valor() As Decimal
        Get
            Return _Valor
        End Get
        Set(ByVal value As Decimal)
            _Valor = value
        End Set
    End Property

End Class

Public Class InformacionVenta
    Inherits Disposable

    Private _CedulaFidelizacion As String
    Private _TipoFidelizacion As Nullable(Of Int32)


    Private _TipoEnvase As String
    Public Property TipoEnvase() As String
        Get
            Return _TipoEnvase
        End Get
        Set(ByVal value As String)
            _TipoEnvase = value
        End Set
    End Property


    Private _CodigoControl As String
    Public Property CodigoControl() As String
        Get
            Return _CodigoControl
        End Get
        Set(ByVal value As String)
            _CodigoControl = value
        End Set
    End Property


    Public Property TipoFidelizacion() As Nullable(Of Int32)
        Get
            Return _TipoFidelizacion
        End Get
        Set(ByVal value As Nullable(Of Int32))
            _TipoFidelizacion = value
        End Set
    End Property

    Private _Manejo As Decimal
    Public Property Manejo() As Decimal
        Get
            Return _Manejo
        End Get
        Set(ByVal value As Decimal)
            _Manejo = value
        End Set
    End Property

    Public Property CedulaFidelizacion() As String
        Get
            Return _CedulaFidelizacion
        End Get
        Set(ByVal value As String)
            _CedulaFidelizacion = value
        End Set
    End Property

    Public NroAutorizacionCHEQUECDC As Integer

    Private _FechaVenta As DateTime
    Public Property FechaVenta() As DateTime
        Get
            Return _FechaVenta
        End Get
        Set(ByVal value As DateTime)
            _FechaVenta = value
        End Set
    End Property

    Private _EsVentaRecuperada As Boolean
    Public Property EsVentaRecuperada() As Boolean
        Get
            Return _EsVentaRecuperada
        End Get
        Set(ByVal value As Boolean)
            _EsVentaRecuperada = value
        End Set
    End Property

    Public _ValorSobreTasa As Decimal
    Public Property ValorSobreTasa() As Decimal
        Get
            Return _ValorSobreTasa
        End Get
        Set(ByVal value As Decimal)
            _ValorSobreTasa = value
        End Set
    End Property

    Public _PorcentajeSobreTasa As Decimal
    Public Property PorcentajeSobreTasa() As Decimal
        Get
            Return _PorcentajeSobreTasa
        End Get
        Set(ByVal value As Decimal)
            _PorcentajeSobreTasa = value
        End Set
    End Property


    Private _NroAutorizacionCheque As String
    Public Property NroAutorizacionCheque() As String
        Get
            Return _NroAutorizacionCheque
        End Get
        Set(ByVal value As String)
            _NroAutorizacionCheque = value
        End Set
    End Property


    Private _CodTanque As String
    Public Property CodTanque() As String
        Get
            Return _CodTanque
        End Get
        Set(ByVal value As String)
            _CodTanque = value
        End Set
    End Property

    Private _Valor As String
    Public Property Valor() As String
        Get
            Return _Valor
        End Get
        Set(ByVal value As String)
            _Valor = value
        End Set
    End Property

    Private _PresionLLenado As Decimal
    Public Property PresionLLenado() As Decimal
        Get
            Return _PresionLLenado
        End Get
        Set(ByVal value As Decimal)
            _PresionLLenado = value
        End Set
    End Property

    Private _Documento As String
    Public Property Documento() As String
        Get
            Return _Documento
        End Get
        Set(ByVal value As String)
            _Documento = value
        End Set
    End Property


    Private _Kilometraje As String
    Public Property Kilometraje() As String
        Get
            Return _Kilometraje
        End Get
        Set(ByVal value As String)
            _Kilometraje = value
        End Set
    End Property


    Private Guid_ As String
    Public Property Guid() As String
        Get
            Return Guid_
        End Get
        Set(ByVal value As String)
            Guid_ = value
        End Set
    End Property

    Private IdFormaPagoAux As Short
    Public Property IdFormaPago() As Short
        Get
            Return IdFormaPagoAux
        End Get
        Set(ByVal value As Short)
            IdFormaPagoAux = value
        End Set
    End Property

    Private RomAux As String
    Public Property Rom() As String
        Get
            Return RomAux
        End Get
        Set(ByVal value As String)
            RomAux = value
        End Set
    End Property

    Private IdProductoAux As Short
    Public Property IdProducto() As Short
        Get
            Return IdProductoAux
        End Get
        Set(ByVal value As Short)
            IdProductoAux = value
        End Set
    End Property

    Private _IdTipoVehiculoCDC As Integer
    Public Property IdTipoVehiculoCDC() As Integer
        Get
            Return _IdTipoVehiculoCDC
        End Get
        Set(ByVal value As Integer)
            _IdTipoVehiculoCDC = value
        End Set
    End Property


    Private _IdClienteCDC As Integer
    Public Property IdClienteCDC() As Integer
        Get
            Return _IdClienteCDC
        End Get
        Set(ByVal value As Integer)
            _IdClienteCDC = value
        End Set
    End Property

    Private PlacaAux As String
    Public Property Placa() As String
        Get
            Return PlacaAux
        End Get
        Set(ByVal value As String)
            PlacaAux = value
        End Set
    End Property

    Private IdClienteAux As String
    Public Property IdCliente() As String
        Get
            Return IdClienteAux
        End Get
        Set(ByVal value As String)
            IdClienteAux = value
        End Set
    End Property

    Private CodEstacionAux As String
    Public Property CodEstacion() As String
        Get
            Return CodEstacionAux
        End Get
        Set(ByVal value As String)
            CodEstacionAux = value
        End Set
    End Property

    Private ReciboAux As Long
    Public Property Recibo() As Long
        Get
            Return ReciboAux
        End Get
        Set(ByVal value As Long)
            ReciboAux = value
        End Set
    End Property

    Private FechaTurnoAux As String
    Public Property FechaTurno() As String
        Get
            Return FechaTurnoAux
        End Get
        Set(ByVal value As String)
            FechaTurnoAux = value
        End Set
    End Property

    Private FechaAux As String
    Public Property Fecha() As String
        Get
            Return FechaAux
        End Get
        Set(ByVal value As String)
            FechaAux = value
        End Set
    End Property

    Private HoraAux As String
    Public Property Hora() As String
        Get
            Return HoraAux
        End Get
        Set(ByVal value As String)
            HoraAux = value
        End Set
    End Property

    Private IdTurnoAux As Int32
    Public Property IdTurno() As Int32
        Get
            Return IdTurnoAux
        End Get
        Set(ByVal value As Int32)
            IdTurnoAux = value
        End Set
    End Property

    Private HoraInicioAux As String
    Public Property HoraInicio() As String
        Get
            Return HoraInicioAux
        End Get
        Set(ByVal value As String)
            HoraInicioAux = value
        End Set
    End Property

    Private HoraFinAux As String
    Public Property HoraFin() As String
        Get
            Return HoraFinAux
        End Get
        Set(ByVal value As String)
            HoraFinAux = value
        End Set
    End Property

    Private LecturaInicialAux As String
    Public Property LecturaInicial() As String
        Get
            Return LecturaInicialAux
        End Get
        Set(ByVal value As String)
            LecturaInicialAux = value
        End Set
    End Property

    Private LecturaFinalAux As String
    Public Property LecturaFinal() As String
        Get
            Return LecturaFinalAux
        End Get
        Set(ByVal value As String)
            LecturaFinalAux = value
        End Set
    End Property

    Private TotalAux As String
    Public Property Total() As String
        Get
            Return TotalAux
        End Get
        Set(ByVal value As String)
            TotalAux = value
        End Set
    End Property

    Private AbonoCreditoAux As String
    Public Property AbonoCredito() As String
        Get
            Return AbonoCreditoAux
        End Get
        Set(ByVal value As String)
            AbonoCreditoAux = value
        End Set
    End Property

    Private CantidadAux As String
    Public Property Cantidad() As String
        Get
            Return CantidadAux
        End Get
        Set(ByVal value As String)
            CantidadAux = value
        End Set
    End Property

    Private PrecioAux As String
    Public Property Precio() As String
        Get
            Return PrecioAux
        End Get
        Set(ByVal value As String)
            PrecioAux = value
        End Set
    End Property

    Private IslaAux As Short
    Public Property Isla() As Short
        Get
            Return IslaAux
        End Get
        Set(ByVal value As Short)
            IslaAux = value
        End Set
    End Property

    Private MangueraAux As Short
    Public Property Manguera() As Short
        Get
            Return MangueraAux
        End Get
        Set(ByVal value As Short)
            MangueraAux = value
        End Set
    End Property

    Private DescuentoAux As String
    Public Property Descuento() As String
        Get
            Return DescuentoAux
        End Get
        Set(ByVal value As String)
            DescuentoAux = value
        End Set
    End Property

    Private SurtidorAux As Short
    Public Property Surtidor() As Short
        Get
            Return SurtidorAux
        End Get
        Set(ByVal value As Short)
            SurtidorAux = value
        End Set
    End Property

    Private Cedula_ As String
    Public Property Cedula() As String
        Get
            Return Cedula_
        End Get
        Set(ByVal value As String)
            Cedula_ = value
        End Set
    End Property

    Private Recaudo_ As String
    Public Property Recaudo() As String
        Get
            Return Recaudo_
        End Get
        Set(ByVal value As String)
            Recaudo_ = value
        End Set
    End Property

    Private Iva_ As String
    Public Property Iva() As String
        Get
            Return Iva_
        End Get
        Set(ByVal value As String)
            Iva_ = value
        End Set
    End Property

    Private _NroTarjeta As String
    Public Property NroTarjeta() As String
        Get
            Return _NroTarjeta
        End Get
        Set(ByVal value As String)
            _NroTarjeta = value
        End Set
    End Property


    Private _TipoLectura As Integer
    Public Property TipoLectura() As Integer
        Get
            Return _TipoLectura
        End Get
        Set(ByVal value As Integer)
            _TipoLectura = value
        End Set
    End Property


    Private _NroSeguridad As String
    Public Property NroSeguridad() As String
        Get
            Return _NroSeguridad
        End Get
        Set(ByVal value As String)
            _NroSeguridad = value
        End Set
    End Property

    Private _NumeroTurno As Integer
    Public Property NumeroTurno() As Integer
        Get
            Return _NumeroTurno
        End Get
        Set(ByVal value As Integer)
            _NumeroTurno = value
        End Set
    End Property
    Private _FechaProximoMantenimiento As String
    Public Property FechaProximoMantenimiento() As String
        Get
            Return _FechaProximoMantenimiento
        End Get
        Set(ByVal value As String)
            _FechaProximoMantenimiento = value
        End Set
    End Property


    Private _IdUnidadMedida As Int16
    Public Property IdUnidadMedida() As Int16
        Get
            Return _IdUnidadMedida
        End Get
        Set(ByVal value As Int16)
            _IdUnidadMedida = value
        End Set
    End Property


    Private _IdCara As Int32
    Public Property IdCara() As Int32
        Get
            Return _IdCara
        End Get
        Set(ByVal value As Int32)
            _IdCara = value
        End Set
    End Property


    Private _IdHistoricoPrecio As Int32
    Public Property IdHistoricoPrecio() As Int32
        Get
            Return _IdHistoricoPrecio
        End Get
        Set(ByVal value As Int32)
            _IdHistoricoPrecio = value
        End Set
    End Property


    Private _RUTConductor As String
    Public Property RUTConductor() As String
        Get
            Return _RUTConductor
        End Get
        Set(ByVal value As String)
            _RUTConductor = value
        End Set
    End Property


    Private _IdCupon As Nullable(Of Int64)
    Public Property IdCupon() As Nullable(Of Int64)
        Get
            Return _IdCupon
        End Get
        Set(ByVal value As Nullable(Of Int64))
            _IdCupon = value
        End Set
    End Property


    Private _IdVale As Nullable(Of Int32)
    Public Property IdVale() As Nullable(Of Int32)
        Get
            Return _IdVale
        End Get
        Set(ByVal value As Nullable(Of Int32))
            _IdVale = value
        End Set
    End Property

    Property _Factura As String
    Public Property Factura() As String
        Get
            Return _Factura
        End Get
        Set(ByVal value As String)
            _Factura = value
        End Set
    End Property

    Private _ComprobantePrepago As String
    Public Property ComprobantePrepago() As String
        Get
            Return _ComprobantePrepago
        End Get
        Set(ByVal value As String)
            _ComprobantePrepago = value
        End Set
    End Property

    Private ProductoAux As String
    Public Property Producto() As String
        Get
            Return ProductoAux
        End Get
        Set(ByVal value As String)
            ProductoAux = value
        End Set
    End Property

End Class


Public Class InformacionRecaudoChile
    Inherits Disposable
    Private _CodEstacion As String
    Public Property CodEstacion() As String
        Get
            Return _CodEstacion
        End Get
        Set(ByVal value As String)
            _CodEstacion = value
        End Set
    End Property

    Private _IdCredito As Long
    Public Property IdCredito() As Long
        Get
            Return _IdCredito
        End Get
        Set(ByVal value As Long)
            _IdCredito = value
        End Set
    End Property

    Private _Recibo As Long
    Public Property Recibo As Long
        Get
            Return _Recibo
        End Get
        Set(ByVal value As Long)
            _Recibo = value
        End Set
    End Property


    Public _Porcentaje As Decimal
    Public Property Porcentaje As Decimal
        Get
            Return _Porcentaje
        End Get
        Set(ByVal value As Decimal)
            _Porcentaje = value
        End Set
    End Property

    Private _Valor As Decimal
    Public Property Valor() As Decimal
        Get
            Return _Valor
        End Get
        Set(ByVal value As Decimal)
            _Valor = value
        End Set
    End Property


    Public _Recaudo As Decimal
    Public Property Recaudo As Decimal
        Get
            Return _Recaudo
        End Get
        Set(ByVal value As Decimal)
            _Recaudo = value
        End Set
    End Property

    Private _IdTipoRecaudo As Int32
    Public Property IdTipoRecaudo() As Int32
        Get
            Return _IdTipoRecaudo
        End Get
        Set(ByVal value As Int32)
            _IdTipoRecaudo = value
        End Set
    End Property


    Private _ValorTipoRecaudo As Decimal
    Public Property ValorTipoRecaudo() As Decimal
        Get
            Return _ValorTipoRecaudo
        End Get
        Set(ByVal value As Decimal)
            _ValorTipoRecaudo = value
        End Set
    End Property

End Class

Public Class Cupon


    Private _IdCupon As Int64
    Private _IdCliente As Int32
    Private _IdVehiculo As Int32
    Private _NroCupon As String
    Private _CodEstacion As String


    Public Property CodEstacion() As String
        Get
            Return _CodEstacion
        End Get
        Set(ByVal value As String)
            _CodEstacion = value
        End Set
    End Property


    Public Property NroCupon() As String
        Get
            Return _NroCupon
        End Get
        Set(ByVal value As String)
            _NroCupon = value
        End Set
    End Property


    Public Property IdVehiculo() As Int32
        Get
            Return _IdVehiculo
        End Get
        Set(ByVal value As Int32)
            _IdVehiculo = value
        End Set
    End Property



    Public Property IdCliente() As Int32
        Get
            Return _IdCliente
        End Get
        Set(ByVal value As Int32)
            _IdCliente = value
        End Set
    End Property

    Public Property IdCupon() As Int64
        Get
            Return _IdCupon
        End Get
        Set(ByVal value As Int64)
            _IdCupon = value
        End Set
    End Property




End Class



Public Class InformacionPago
    Inherits Disposable

    Private FechaTurnoAux As String
    Private FechaAux As String
    Private IdTurnoAux As Int32
    Private CodigoAux As String
    Private PlacaAux As String
    Private ValorAux As String
    Private CodEstacionAux As String
    Private _IdEmpleado As Int32
    Private _GUIDPago As String
    Private _CedulaEmpleado As String
    Private _EsAnulado As Boolean
    Private _IdCredito As String
    Private _EstadoPagoExtraordiario As Int32
    Private _Movil As Nullable(Of Int32)
    Private _IdConcepto As Nullable(Of Int32)
    Private _Concepto As String
    Private _IdEmpresa As Int32
    Private _NitEmpresa As String
    Private _Empresa As String
    Private _IdPagoEmpresa As Int32
    Private _IdRecaudoCDC As Nullable(Of Int32)
    Private _Recibo As Int64

    Public Property Recibo() As Int64
        Get
            Return _Recibo
        End Get
        Set(ByVal value As Int64)
            _Recibo = value
        End Set
    End Property

    Public Property IdRecaudoCDC() As Nullable(Of Int32)
        Get
            Return _IdRecaudoCDC
        End Get
        Set(ByVal value As Nullable(Of Int32))
            _IdRecaudoCDC = value
        End Set
    End Property
    Private _NroTarjeta As String
    Public Property NroTarjeta() As String
        Get
            Return _NroTarjeta
        End Get
        Set(ByVal value As String)
            _NroTarjeta = value
        End Set
    End Property

    Private _TipoLectura As Integer
    Public Property TipoLectura() As Integer
        Get
            Return _TipoLectura
        End Get
        Set(ByVal value As Integer)
            _TipoLectura = value
        End Set
    End Property

    Private _NroSeguridad As String
    Public Property NroSeguridad() As String
        Get
            Return _NroSeguridad
        End Get
        Set(ByVal value As String)
            _NroSeguridad = value
        End Set
    End Property

    Public Property Empresa() As String
        Get
            Return _Empresa
        End Get
        Set(ByVal value As String)
            _Empresa = value
        End Set
    End Property
    Public Property IdPagoEmpresa() As Int32
        Get
            Return _IdPagoEmpresa
        End Get
        Set(ByVal value As Int32)
            _IdPagoEmpresa = value
        End Set
    End Property
    Public Property NitEmpresa() As String
        Get
            Return _NitEmpresa
        End Get
        Set(ByVal value As String)
            _NitEmpresa = value
        End Set
    End Property
    Public Property IdEmpresa() As Int32
        Get
            Return _IdEmpresa
        End Get
        Set(ByVal value As Int32)
            _IdEmpresa = value
        End Set
    End Property
    Public Property Concepto() As String
        Get
            Return _Concepto
        End Get
        Set(ByVal value As String)
            _Concepto = value
        End Set
    End Property
    Public Property IdConcepto() As Nullable(Of Int32)
        Get
            Return _IdConcepto
        End Get
        Set(ByVal value As Nullable(Of Int32))
            _IdConcepto = value
        End Set
    End Property
    Public Property Movil() As Nullable(Of Int32)
        Get
            Return _Movil
        End Get
        Set(ByVal value As Nullable(Of Int32))
            _Movil = value
        End Set
    End Property
    Public Property EstadoPagoExtraordinario() As Int32
        Get
            Return _EstadoPagoExtraordiario
        End Get
        Set(ByVal value As Int32)
            _EstadoPagoExtraordiario = value
        End Set
    End Property

    Public Property EsAnulado() As Boolean
        Get
            Return _EsAnulado
        End Get
        Set(ByVal value As Boolean)
            _EsAnulado = value
        End Set
    End Property

    Public Property CedulaEmpleado() As String
        Get
            Return _CedulaEmpleado
        End Get
        Set(ByVal value As String)
            _CedulaEmpleado = value
        End Set
    End Property

    Public Property GUIDPago() As String
        Get
            Return _GUIDPago
        End Get
        Set(ByVal value As String)
            _GUIDPago = value
        End Set
    End Property

    Public Property FechaTurno() As String
        Get
            Return FechaTurnoAux
        End Get
        Set(ByVal value As String)
            FechaTurnoAux = value
        End Set
    End Property
    Public Property Fecha() As String
        Get
            Return FechaAux
        End Get
        Set(ByVal value As String)
            FechaAux = value
        End Set
    End Property
    Public Property IdTurno() As Int32
        Get
            Return IdTurnoAux
        End Get
        Set(ByVal value As Int32)
            IdTurnoAux = value
        End Set
    End Property
    Public Property Codigo() As String
        Get
            Return CodigoAux
        End Get
        Set(ByVal value As String)
            CodigoAux = value
        End Set
    End Property
    Public Property Placa() As String
        Get
            Return PlacaAux
        End Get
        Set(ByVal value As String)
            PlacaAux = value
        End Set
    End Property
    Public Property Valor() As String
        Get
            Return (ValorAux)
        End Get
        Set(ByVal value As String)
            ValorAux = value
        End Set
    End Property
    Public Property CodEstacion() As String
        Get
            Return CodEstacionAux
        End Get
        Set(ByVal value As String)
            CodEstacionAux = value
        End Set
    End Property

    Public Property IdEmpleado() As Int32
        Get
            Return _IdEmpleado
        End Get
        Set(ByVal value As Int32)
            _IdEmpleado = value
        End Set
    End Property

    Public Property IdCredito() As String
        Get
            Return _IdCredito
        End Get
        Set(ByVal value As String)
            _IdCredito = value
        End Set
    End Property

End Class

Public Class InformacionReversion
    Inherits Disposable

    Private CodEstacionAux As String
    Private FechaTurnoAux As String
    Private FechaAbonoAux As String
    Private ReciboAux As Int32
    Private IdTurnoAux As Int32
    Private CodigoAux As String
    Private ValorAux As String
    Private GuidVentaAux As String
    Private _CedulaEmpleado As String

    Public Property CedulaEmpleado() As String
        Get
            Return _CedulaEmpleado
        End Get
        Set(ByVal value As String)
            _CedulaEmpleado = value
        End Set
    End Property

    Public Property GuidVenta() As String
        Get
            Return GuidVentaAux
        End Get
        Set(ByVal value As String)
            GuidVentaAux = value
        End Set
    End Property

    Public Property CodEstacion() As String
        Get
            Return CodEstacionAux
        End Get
        Set(ByVal value As String)
            CodEstacionAux = value
        End Set
    End Property
    Public Property FechaTurno() As String
        Get
            Return FechaTurnoAux
        End Get
        Set(ByVal value As String)
            FechaTurnoAux = value
        End Set
    End Property
    Public Property FechaAbono() As String
        Get
            Return FechaAbonoAux
        End Get
        Set(ByVal value As String)
            FechaAbonoAux = value
        End Set
    End Property
    Public Property Recibo() As Int32
        Get
            Return ReciboAux
        End Get
        Set(ByVal value As Int32)
            ReciboAux = value
        End Set
    End Property
    Public Property IdTurno() As Int32
        Get
            Return IdTurnoAux
        End Get
        Set(ByVal value As Int32)
            IdTurnoAux = value
        End Set
    End Property
    Public Property Codigo() As String
        Get
            Return CodigoAux
        End Get
        Set(ByVal value As String)
            CodigoAux = value
        End Set
    End Property

    Public Property Valor() As String
        Get
            Return ValorAux
        End Get
        Set(ByVal value As String)
            ValorAux = value
        End Set
    End Property
End Class

Public Class InformacionLectura
    Inherits Disposable

    Private CodEstacionAux As String
    Private FechaAux As String
    Private NumeroTurnoAux As Short
    Private IdMangueraAux As Short
    Private ValorInicialAux As String
    Private ValorFinalAux As String
    Private MecanicaInicialAux As String
    Private MecanicaFinalAux As String
    Private PrecioAux As String
    Private _CedulaEmpleado As String
    Private _IdTurno As Integer



    Public Property CedulaEmpleado() As String
        Get
            Return _CedulaEmpleado
        End Get
        Set(ByVal value As String)
            _CedulaEmpleado = value
        End Set
    End Property

    Public Property CodEstacion() As String
        Get
            Return CodEstacionAux
        End Get
        Set(ByVal value As String)
            CodEstacionAux = value
        End Set
    End Property
    Public Property Fecha() As String
        Get
            Return FechaAux
        End Get
        Set(ByVal value As String)
            FechaAux = value
        End Set
    End Property

    Public Property IdTurno() As Integer
        Get
            Return _IdTurno
        End Get
        Set(ByVal value As Integer)
            _IdTurno = value
        End Set
    End Property

    Public Property NumeroTurno() As Short
        Get
            Return NumeroTurnoAux
        End Get
        Set(ByVal value As Short)
            NumeroTurnoAux = value
        End Set
    End Property
    Public Property IdManguera() As Short
        Get
            Return IdMangueraAux
        End Get
        Set(ByVal value As Short)
            IdMangueraAux = value
        End Set
    End Property
    Public Property ValorInicial() As String
        Get
            Return ValorInicialAux
        End Get
        Set(ByVal value As String)
            ValorInicialAux = value
        End Set
    End Property
    Public Property ValorFinal() As String
        Get
            Return ValorFinalAux
        End Get
        Set(ByVal value As String)
            ValorFinalAux = value
        End Set
    End Property
    Public Property MecanicaInicial() As String
        Get
            Return MecanicaInicialAux
        End Get
        Set(ByVal value As String)
            MecanicaInicialAux = value
        End Set
    End Property
    Public Property MecanicaFinal() As String
        Get
            Return MecanicaFinalAux
        End Get
        Set(ByVal value As String)
            MecanicaFinalAux = value
        End Set
    End Property
    Public Property Precio() As String
        Get
            Return PrecioAux
        End Get
        Set(ByVal value As String)
            PrecioAux = value
        End Set
    End Property
End Class

Public Class InformacionAnulacion
    Inherits Disposable

    Private Anulado As Int64
    Private Nuevo As Int64

    Public Property DocumentoAnulado() As Int64
        Get
            Return Anulado
        End Get
        Set(ByVal value As Int64)
            Anulado = value
        End Set
    End Property

    Public Property DocumentoNuevo() As Int64
        Get
            Return Nuevo
        End Get
        Set(ByVal value As Int64)
            Nuevo = value
        End Set
    End Property
End Class

Public Class DetalleItem

#Region "   Declaracion de Variables    "
    Private _Codigo As String
    Private _Cantidad As Double
#End Region

    Public Property Codigo() As String
        Get
            Return _Codigo
        End Get
        Set(ByVal value As String)
            _Codigo = value
        End Set
    End Property

    Public Property Cantidad() As Double
        Get
            Return _Cantidad
        End Get
        Set(ByVal value As Double)
            _Cantidad = value
        End Set
    End Property

End Class

Public Class MedioPago
    Inherits Disposable

    Private _Documento As String
    Private _NroConfirmacion As String
    Private _IdMedioPago As Int16
    Private _Valor As Decimal
    Private _TipoLectura As Int32
    Public Property Documento() As String
        Get
            Return _Documento
        End Get
        Set(ByVal value As String)
            _Documento = value
        End Set
    End Property
    Public Property IdMedioPago() As Int16
        Get
            Return _IdMedioPago
        End Get
        Set(ByVal value As Int16)
            _IdMedioPago = value
        End Set
    End Property
    Public Property NroConfirmacion() As String
        Get
            Return _NroConfirmacion
        End Get
        Set(ByVal value As String)
            _NroConfirmacion = value
        End Set
    End Property
    Public Property TipoLectura() As Int32
        Get
            Return _TipoLectura
        End Get
        Set(ByVal value As Int32)
            _TipoLectura = value
        End Set
    End Property
    Public Property Valor() As Decimal
        Get
            Return _Valor
        End Get
        Set(ByVal value As Decimal)
            _Valor = value
        End Set
    End Property

End Class

Public Class VehiculoANH

    Private _FechaActulizacion As DateTime
    Private _Placa As String
    Private _imagen As String
    Private _idLectura As String

    Public Property Lectura() As String
        Get
            Return _idLectura
        End Get
        Set(ByVal value As String)
            _idLectura = value
        End Set
    End Property


    Public Property Imagen() As String
        Get
            Return _imagen
        End Get
        Set(ByVal value As String)
            _imagen = value
        End Set
    End Property


    Public Property Placa() As String
        Get
            Return _Placa
        End Get
        Set(ByVal value As String)
            _Placa = value
        End Set
    End Property


    Public Property FechaActualizacion() As DateTime
        Get
            Return _FechaActulizacion
        End Get
        Set(ByVal value As DateTime)
            _FechaActulizacion = value
        End Set
    End Property

End Class


